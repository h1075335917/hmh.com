<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-java/JAVA-Encryption" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">JAVA-åŠ å¯†æ–¹å¼ | è´ºæ•åçš„å®˜æ–¹ç½‘ç«™</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mhuahe.github.io/mhuahe.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://mhuahe.github.io/mhuahe.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://mhuahe.github.io/mhuahe.com/docs/java/JAVA-Encryption"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="JAVA-åŠ å¯†æ–¹å¼ | è´ºæ•åçš„å®˜æ–¹ç½‘ç«™"><meta data-rh="true" name="description" content="åˆ«ç”¨MD5åŠ å¯†å¯†ç äº†"><meta data-rh="true" property="og:description" content="åˆ«ç”¨MD5åŠ å¯†å¯†ç äº†"><link data-rh="true" rel="icon" href="/mhuahe.com/img/m_two_logo.ico"><link data-rh="true" rel="canonical" href="https://mhuahe.github.io/mhuahe.com/docs/java/JAVA-Encryption"><link data-rh="true" rel="alternate" href="https://mhuahe.github.io/mhuahe.com/docs/java/JAVA-Encryption" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://mhuahe.github.io/mhuahe.com/docs/java/JAVA-Encryption" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/mhuahe.com/blog/rss.xml" title="è´ºæ•åçš„å®˜æ–¹ç½‘ç«™ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/mhuahe.com/blog/atom.xml" title="è´ºæ•åçš„å®˜æ–¹ç½‘ç«™ Atom Feed"><link rel="stylesheet" href="/mhuahe.com/assets/css/styles.f2a4feda.css">
<script src="/mhuahe.com/assets/js/runtime~main.445e9421.js" defer="defer"></script>
<script src="/mhuahe.com/assets/js/main.5e36ef06.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="è·³åˆ°ä¸»è¦å†…å®¹"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">è·³åˆ°ä¸»è¦å†…å®¹</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">ğŸ‰ï¸<b>æœ¬ç½‘ç«™æ­£åœ¨å»ºè®¾ä¸­ï¼Œæ¬¢è¿æå‡ºå®è´µæ„è§ï¼<a target="_blank" href="https://github.com/mhuahe/mhuahe.com">æºç åœ°å€</a></b> ğŸ¥³ï¸</div><button type="button" aria-label="å…³é—­" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="ä¸»å¯¼èˆª" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="åˆ‡æ¢å¯¼èˆªæ " aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mhuahe.com/"><div class="navbar__logo"><img src="/mhuahe.com/img/m_two_logo.svg" alt="mhuahe site logo" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="32"><img src="/mhuahe.com/img/m_two_logo.svg" alt="mhuahe site logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="32"></div><b class="navbar__title text--truncate">è´ºæ•åçš„å®˜æ–¹ç½‘ç«™</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/mhuahe.com/docs/java/">Java</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/web/">å‰ç«¯</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/c/">Cè¯­è¨€</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/linux/">Linux</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/sql/MySQL">SQL</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/python/">Python</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/tool/">å·¥å…·</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/project/">é¡¹ç›®</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/knowledge/ä»€ä¹ˆæ˜¯SaaS">çŸ¥è¯†</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/other/OTHER-Examination">å…¶ä»–</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/mhuahe.com/docs/example/EXAMPLE-Video">ç¤ºä¾‹</a><a class="navbar__item navbar__link" href="/mhuahe.com/blog">Blog</a><a href="https://github.com/mhuahe/mhuahe.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰" aria-label="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="æœç´¢" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="å›åˆ°é¡¶éƒ¨" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="æ–‡æ¡£ä¾§è¾¹æ " class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/"><div> <!-- -->JAVA</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Algorithm"><div> <!-- -->JAVA-ç®—æ³•</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Code-Generation"><div> <!-- -->JAVA-ä»£ç ç”Ÿæˆ</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Data-Structure"><div> <!-- -->JAVA-æ•°æ®ç»“æ„</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Design-Pattern"><div> <!-- -->JAVA-è®¾è®¡æ¨¡å¼</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Elaticsearch"><div> <!-- -->JAVA-ES</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/mhuahe.com/docs/java/JAVA-Encryption"><div> <!-- -->JAVA-åŠ å¯†æ–¹å¼</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Error-Record"><div> <!-- -->JAVA-é”™è¯¯è®°å½•</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Hutool"><div> <!-- -->JAVA-HuToolå·¥å…·</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-JDK-Version"><div> <!-- -->JAVA-JDKç‰ˆæœ¬</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-JVM"><div> <!-- -->JAVA-JVM</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Knowledge-Question"><div> <!-- -->JAVA-çŸ¥è¯†é¢˜</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-MQ"><div> <!-- -->JAVA-æ¶ˆæ¯é˜Ÿåˆ—</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Maven-Dependent"><div> <!-- -->JAVA-Mavenä¾èµ–</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Maven"><div> <!-- -->JAVA-Maven</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-MongoDB"><div> <!-- -->JAVA-MongoDB</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-MybatisPlus"><div> <!-- -->JAVA-MybatisPlus</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-OAuth2-SourceCode"><div> <!-- -->JAVA-oauth2æºç è§£è¯»</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-PDF"><div> <!-- -->JAVA-PDF</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-SQL-Interceptor"><div> <!-- -->JAVA-SQLæ‹¦æˆªå™¨</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Servlet"><div> <!-- -->JAVA-Servlet</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-SpringBoot-Stack"><div> <!-- -->JAVA-SpringBootæŠ€æœ¯æ ˆ</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-SpringBoot-Version"><div> <!-- -->JAVA-SpringBootç‰ˆæœ¬</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-SpringCloud-Stack"><div> <!-- -->JAVA-SpringCloudæŠ€æœ¯æ ˆ</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Thread"><div> <!-- -->JAVA-å¤šçº¿ç¨‹</div></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-WebSocket"><div> <!-- -->JAVA-WebSocket</div></a></li></ul></nav><button type="button" title="æ”¶èµ·ä¾§è¾¹æ " aria-label="æ”¶èµ·ä¾§è¾¹æ " class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="é¡µé¢è·¯å¾„"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ä¸»é¡µé¢" class="breadcrumbs__link" href="/mhuahe.com/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">JAVA-åŠ å¯†æ–¹å¼</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">æœ¬é¡µæ€»è§ˆ</button></div><div class="theme-doc-markdown markdown"><header><h1>JAVA-åŠ å¯†æ–¹å¼</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="åˆ«ç”¨md5åŠ å¯†å¯†ç äº†">åˆ«ç”¨MD5åŠ å¯†å¯†ç äº†<a href="#åˆ«ç”¨md5åŠ å¯†å¯†ç äº†" class="hash-link" aria-label="åˆ«ç”¨MD5åŠ å¯†å¯†ç äº†çš„ç›´æ¥é“¾æ¥" title="åˆ«ç”¨MD5åŠ å¯†å¯†ç äº†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>è§£é‡Š</p>
<blockquote>
<p>MD ç®—æ³•æœ‰å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ MD2ã€MD4ã€MD5 ç­‰ï¼Œå…¶ä¸­ MD5 æ˜¯æœ€å¸¸ç”¨çš„ç‰ˆæœ¬ï¼Œå®ƒå¯ä»¥ç”Ÿæˆä¸€ä¸ª 128 ä½ï¼ˆ16 å­—èŠ‚ï¼‰çš„å“ˆå¸Œå€¼ã€‚ä»å®‰å…¨æ€§ä¸Šè¯´ï¼šMD5 &gt; MD4 &gt; MD2ã€‚é™¤äº†è¿™äº›ç‰ˆæœ¬ï¼Œè¿˜æœ‰ä¸€äº›åŸºäº MD4 æˆ– MD5 æ”¹è¿›çš„ç®—æ³•ï¼Œå¦‚ RIPEMDã€HAVAL ç­‰ã€‚å³ä½¿æ˜¯æœ€å®‰å…¨ MD ç®—æ³• MD5 ä¹Ÿå­˜åœ¨è¢«ç ´è§£çš„é£é™©ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æš´åŠ›ç ´è§£æˆ–å½©è™¹è¡¨æ”»å‡»ç­‰æ–¹å¼ï¼Œæ‰¾åˆ°ä¸åŸå§‹æ•°æ®ç›¸åŒçš„å“ˆå¸Œå€¼ï¼Œä»è€Œç ´è§£æ•°æ®ã€‚</p>
<p>ä¸ºäº†å¢åŠ ç ´è§£éš¾åº¦ï¼Œé€šå¸¸å¯ä»¥é€‰æ‹©åŠ ç›ã€‚ç›ï¼ˆSaltï¼‰åœ¨å¯†ç å­¦ä¸­ï¼Œæ˜¯æŒ‡é€šè¿‡åœ¨å¯†ç ä»»æ„å›ºå®šä½ç½®æ’å…¥ç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œè®©å“ˆå¸Œåçš„ç»“æœå’Œä½¿ç”¨åŸå§‹å¯†ç çš„å“ˆå¸Œç»“æœä¸ç›¸ç¬¦ï¼Œè¿™ç§è¿‡ç¨‹ç§°ä¹‹ä¸ºâ€œåŠ ç›â€ã€‚åŠ ç›ä¹‹åå°±å®‰å…¨äº†å—ï¼Ÿå¹¶ä¸ä¸€å®šï¼Œè¿™åªæ˜¯å¢åŠ äº†ç ´è§£éš¾åº¦ï¼Œä¸ä»£è¡¨æ— æ³•ç ´è§£ã€‚è€Œä¸”ï¼ŒMD5 ç®—æ³•æœ¬èº«å°±å­˜åœ¨å¼±ç¢°æ’ï¼ˆCollisionï¼‰é—®é¢˜ï¼Œå³å¤šä¸ªä¸åŒçš„è¾“å…¥äº§ç”Ÿç›¸åŒçš„ MD5 å€¼ã€‚å› æ­¤ï¼Œä¸å»ºè®®ä½¿ç”¨ MD5 åŠ å¯†å¯†ç ï¼Œå³ä½¿åŠ ç›ä¹Ÿå­˜åœ¨å®‰å…¨é£é™©ã€‚</p>
</blockquote>
<p>æ›¿æ¢æ–¹æ¡ˆ</p>
<blockquote>
<p>  ä¸ºäº†å¢åŠ å®‰å…¨æ€§ï¼Œå¯ä»¥ä½¿ç”¨<strong>å®‰å…¨æ€§è¾ƒé«˜çš„åŠ å¯†å“ˆå¸Œç®—æ³•+ Saltï¼ˆç›ï¼‰</strong>ï¼ˆä¾‹å¦‚ SHA2ã€SHA3ã€SM3ï¼Œæ›´é«˜çš„å®‰å…¨æ€§æ›´å¼ºçš„æŠ—ç¢°æ’æ€§ï¼‰ã€‚å»ºè®®æ¯ä¸ªç”¨æˆ·çš„ Salt å€¼ä¸åŒï¼ˆæœ€å¥½å¯¹ä¸åŒç”¨æˆ·çš„å¯†ç éšæœºç”Ÿæˆä¸åŒçš„ Saltï¼ŒSalt åº“å’Œå¯†ç åº“åˆ†ç¦»å¼€ï¼‰ï¼Œè¿™æ ·å°±æ²¡åŠæ³•ç”¨å½©è™¹è¡¨è¿›è¡Œæ‰¹é‡ç ´è§£ã€‚ä¸è¿‡ï¼Œè¿™ä¸ä»£è¡¨æ²¡æœ‰ç ´è§£é£é™©äº†ï¼ˆåˆ©ç”¨å¯†ç ç ´è§£ç¡¬ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ç§’é’Ÿå†…è¿›è¡Œæ•°åäº¿æ¬¡çš„å“ˆå¸Œè®¡ç®—ï¼‰ã€‚</p>
<p>å®‰å…¨æ€§æ›´é«˜çš„ä¸€ç§æ–¹æ¡ˆæ˜¯ä½¿ç”¨ <strong>å¯†é’¥æ´¾ç”Ÿç®—æ³•ï¼ˆKey Derivation Functionï¼Œç®€ç§° KDFï¼Œä¹Ÿç§°ä¸ºå¯†ç å“ˆå¸Œç®—æ³•ï¼‰</strong>ã€‚ç›¸æ¯”å…¶ä»–åŠ å¯†å“ˆå¸Œç®—æ³•ï¼ŒKDF å…·æœ‰ä¸€ä¸ªç‹¬ç‰¹å±æ€§â€”â€”è®¡ç®—é€Ÿåº¦å¾ˆæ…¢ï¼Œè€Œä¸”ä»è®¾è®¡ä¸Šå°±ä½¿å…¶è®¡ç®—é€Ÿåº¦éš¾ä»¥æå‡ï¼Œæ‰€ä»¥ KDF ä¹Ÿè¢«ç§°ä¸º <strong>æ…¢å“ˆå¸Œç®—æ³•</strong> ã€‚è¿™ä¸ªæ…¢ç›¸æ¯”äºå…¶å¸¦æ¥çš„å®‰å…¨æ€§æ¥è¯´æ˜¯å¯ä»¥æ¥å—çš„ï¼Œæ¯•ç«Ÿä¸»è¦ä¹Ÿæ˜¯åœ¨ç™»å½•æ—¶æ‰§è¡Œä¸€æ¬¡ã€‚</p>
</blockquote>
<p>å¸¸è§çš„ KDF ç®—æ³•ä¸»è¦æœ‰ï¼ˆå®‰å…¨ç¨‹åº¦ä¾æ¬¡é€’å¢ï¼‰ï¼š</p>
<p><a href="https://docs.spring.io/spring-security/reference/features/authentication/password-storage.html" target="_blank" rel="noopener noreferrer">å…·ä½“ä»£ç å®ç°</a></p>
<blockquote>
<ol>
<li>PBKDF2ï¼šå…¶æ ¸å¿ƒæ˜¯å¯¹ HMAC è¿›è¡Œå¤šæ¬¡è¿­ä»£ä»¥å¢åŠ ç ´è§£éš¾åº¦ã€‚PBKDF2 å¯¹å†…å­˜çš„è¦æ±‚è¾ƒä½ï¼Œå¹¶ä¸èƒ½æŠµæŠ—å¯†ç ç ´è§£ç¡¬ä»¶ï¼ˆå¦‚ GPUã€ASICã€FPGAï¼‰æ”»å‡»ã€‚è¿™ä¸ª KDF ç®—æ³•æ¯”è¾ƒè€äº†ï¼Œç›®å‰å·²ç»ä¸æ¨èä½¿ç”¨ã€‚</li>
<li>Bcryptï¼šä¸€ç§åŸºäº Blowfish åŠ å¯†ç®—æ³•çš„å¯†ç å“ˆå¸Œç®—æ³•ï¼Œä¸“é—¨ä¸ºå¯†ç åŠ å¯†è€Œè®¾è®¡ï¼Œå®‰å…¨æ€§é«˜äº PBKDF2ã€‚Bcrypt å¯¹å†…å­˜çš„è¦æ±‚è¾ƒä½ï¼ŒåŒæ ·ä¸èƒ½æŠµæŠ—å¯†ç ç ´è§£ç¡¬ä»¶æ”»å‡»ã€‚</li>
<li>Scryptï¼šç›¸æ¯”äº PBKDF2 å’Œ Bcryptï¼Œå…¶å ç”¨çš„å†…å­˜æ›´å¤šï¼Œå®‰å…¨æ€§ä¹Ÿè¦æ›´é«˜ã€‚å®ƒè¿˜å¯ä»¥é€šè¿‡è°ƒæ•´å†…å­˜å’Œ CPU çš„ä½¿ç”¨é‡æ¥å¢åŠ ç ´è§£çš„éš¾åº¦ã€‚</li>
<li>Argon2ï¼šç›®å‰æœ€å¼ºçš„å¯†ç  Hash ç®—æ³•ï¼Œåœ¨ 2015 å¹´èµ¢å¾—äº†å¯†ç  Hash ç«èµ›ã€‚å’Œ Scrypt ä¸€æ ·ï¼ŒArgon2 åŒæ ·éœ€è¦å¤§é‡çš„å†…å­˜ã€‚äºŒè€…ç»¼åˆä½¿ç”¨åŠ ç›ã€å¤šæ¬¡è¿­ä»£ã€å¤§é‡æ¶ˆè€— CPU æ—¶é—´å’Œå†…å­˜èµ„æºç­‰æ‰‹æ®µï¼Œå¤§å¤§æå‡äº†å¯¹æŠ—å¯†ç ç ´è§£ç¡¬ä»¶çš„èƒ½åŠ›ã€‚</li>
</ol>
</blockquote>
<p>å»ºè®®æ–¹æ¡ˆ</p>
<blockquote>
<p>å¯¹äºç»å¤§éƒ¨åˆ†é¡¹ç›®æ¥è¯´ï¼Œ Bcrypt å°±è¶³å¤Ÿäº†ï¼Œè™½ç„¶å®ƒçš„å®‰å…¨æ€§æ¯”ä¸ä¸Š Scrypt å’Œ Argon2ï¼Œä½†ç»¼åˆèµ·æ¥æ€§ä»·æ¯”è¾ƒé«˜</p>
<p>Bcrypt é‡‡ç”¨äº† saltï¼ˆç›ï¼‰ å’Œ costï¼ˆæˆæœ¬ï¼‰ ä¸¤ç§æœºåˆ¶ï¼Œå®ƒå¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢å½©è™¹è¡¨æ”»å‡»å’Œæš´åŠ›ç ´è§£æ”»å‡»ï¼Œä»è€Œä¿è¯å¯†ç çš„å®‰å…¨æ€§ã€‚åŠ  salt å¯ä»¥é˜²æ­¢å½©è™¹è¡¨æ”»å‡»ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨ Bcrypt åŠ å¯†å¯†ç æ—¶å·²ç»åŒ…å«äº†ä¸€ä¸ªéšæœºåŠ ç›çš„è¿‡ç¨‹ï¼Œä¸éœ€è¦é¢å¤–åŠ ç›äº†ã€‚</p>
<p>cost åˆç§°ä¸ºå·¥ä½œå› å­ï¼Œå®šä¹‰äº†å“ˆå¸Œè®¡ç®—çš„å¤æ‚åº¦ã€‚æˆæœ¬è¶Šé«˜ï¼Œè®¡ç®—æ‰€éœ€çš„æ—¶é—´å’Œèµ„æºå°±è¶Šå¤šï¼Œè¿™ä½¿å¾—æš´åŠ›ç ´è§£æ”»å‡»å˜å¾—æ›´åŠ å›°éš¾ã€‚å®é™…é¡¹ç›®ä¸­ï¼Œå¯ä»¥æ ¹æ®ç³»ç»Ÿçš„æ€§èƒ½å’Œå®‰å…¨éœ€æ±‚è°ƒæ•´ costã€‚</p>
<p>Spring Security æä¾›çš„<code>BCryptPasswordEncoder</code> å·¥ä½œå› å­èŒƒå›´åœ¨ 4-31 ï¼Œé»˜è®¤æ˜¯ 10</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * @param strength the log rounds to use, between 4 and 31</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> public BCryptPasswordEncoder(int strength) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  this(strength, null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="md5">MD5<a href="#md5" class="hash-link" aria-label="MD5çš„ç›´æ¥é“¾æ¥" title="MD5çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><a href="https://blog.csdn.net/yb546822612/article/details/103953034" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/yb546822612/article/details/103953034</a></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1.MD5åŠ å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">åŠ å¯†åçš„ä½æ•°åˆ†ä¸º16ä½å’Œ32ä½</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">16ä½å®é™…ä¸º32ä½ä¸­å–9-24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String md5_16 = md5_32.substring(8, 24);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Java ä¸­ MD5 åŠ å¯†çš„ç»“æœé»˜è®¤æ˜¯32ä½å°å†™ã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<!-- -->
<img src="/mhuahe.com/assets/images/Encryption-MD5-3a6cab52fadaf73d0680d4ad14cc0461.png" alt="Encryption-MD5" width="50%">
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1.MD5åŠ å¯†ç®—æ³•(ç»å¸¸ä½¿ç”¨MD5+saltä½œä¸ºç”¨æˆ·å¯†ç åŠ å¯†æˆ–MD5åŠ å¯†åå†ä½¿ç”¨MD5åŠ å¯†)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MD5çš„å…¨ç§°æ˜¯Message-Digest Algorithm 5ï¼ŒMD5å¯ä»¥å°†ä»»æ„é•¿åº¦çš„â€œå­—èŠ‚ä¸²â€å˜æ¢æˆâ¼€ä¸ª128bitçš„â¼¤æ•´æ•°ï¼Œå¹¶ä¸”å®ƒæ˜¯â¼€ä¸ªä¸å¯é€†çš„å­—ç¬¦ä¸²å˜æ¢ç®—æ³•ï¼Œæ¢å¥è¯è¯´æ˜¯ï¼Œå³ä½¿ä½ çœ‹åˆ°æºç¨‹åºå’Œç®—æ³•æè¿°ï¼Œä¹Ÿâ½†æ³•å°†â¼€ä¸ªMD5çš„å€¼å˜æ¢å›åŸå§‹çš„å­—ç¬¦ä¸²ï¼Œä»æ•°å­¦åŸç†ä¸Šè¯´ï¼Œæ˜¯å› ä¸º</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">åŸå§‹çš„å­—ç¬¦ä¸²æœ‰â½†ç©·å¤šä¸ªï¼Œè¿™æœ‰ç‚¹è±¡ä¸å­˜åœ¨åå‡½æ•°çš„æ•°å­¦å‡½æ•°ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2004å¹´ï¼Œè¯å®MD5ç®—æ³•æ— æ³•é˜²æ­¢ç¢°æ’ï¼ˆcollisionï¼‰(ä¸åŒçš„å€¼åŠ å¯†åç”Ÿæˆç›¸åŒçš„å­—ç¬¦ä¸²)ï¼Œå› æ­¤ä¸é€‚ç”¨äºå®‰å…¨æ€§è®¤è¯ï¼Œå¦‚SSLå…¬å¼€å¯†é’¥è®¤ è¯æˆ–æ˜¯æ•°å­—ç­¾åç­‰ç”¨é€”ã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.math.BigInteger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.MessageDigest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.NoSuchAlgorithmException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.binary.Hex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.digest.DigestUtils;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.digests.MD2Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.digests.MD5Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MDUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * MD5åŠ å¯†ï¼Œæ–¹å¼1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param pwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String commonsCodecMd5(String pwd) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return DigestUtils.md5Hex(pwd.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String commonsCodecMd2(String pwd) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return DigestUtils.md2Hex(pwd.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * MD5åŠ å¯†ï¼Œæ–¹å¼2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param pwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String jdkMd5(String pwd) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] message = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        message = pwd.getBytes();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MessageDigest md = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            md = MessageDigest.getInstance(&quot;MD5&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] encrypwd = md.digest(message);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String md5code = new BigInteger(1, encrypwd).toString(16);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; 32 - md5code.length(); i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            md5code = &quot;0&quot; + md5code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return md5code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String jdkMd2(String pwd) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] message = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        message = pwd.getBytes();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MessageDigest md = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            md = MessageDigest.getInstance(&quot;md2&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] encrypwd = md.digest(message);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String md5code = Hex.encodeHexString(encrypwd);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; 32 - md5code.length(); i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            md5code = &quot;0&quot; + md5code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return md5code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      * Bouncy Castleå®ç°MD4åŠ å¯† </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     public static String bouncyCastleMD4(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         /*é€šè¿‡è¿™ç§æ–¹å¼ç»™JDKåŠ¨æ€æ·»åŠ ä¸€ä¸ªprovider,å°±å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼è·å¾—JDKæœ¬èº«ä¸æ”¯æŒçš„MD4äº†*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         Security.addProvider(new BouncyCastleProvider());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         MessageDigest md = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            md = MessageDigest.getInstance(&quot;md4&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         byte[] md4Bytes = md.digest(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         return new String(org.bouncycastle.util.encoders.Hex.encode(md4Bytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     /** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      * Bouncy Castleå®ç°MD5åŠ å¯† </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     public static String bouncyCastleMD5(String src){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         Digest digest = new MD5Digest();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         digest.update(src.getBytes(), 0, src.getBytes().length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         byte[]md5Bytes = new byte[digest.getDigestSize()];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         digest.doFinal(md5Bytes, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         return new String(org.bouncycastle.util.encoders.Hex.encode(md5Bytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     /** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      * Bouncy Castleå®ç°MD2åŠ å¯† </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     public static String bouncyCastleMD2(String src){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         Digest digest = new MD2Digest();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         digest.update(src.getBytes(), 0, src.getBytes().length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         byte[]md2Bytes = new byte[digest.getDigestSize()];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         digest.doFinal(md2Bytes, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         return new String(org.bouncycastle.util.encoders.Hex.encode(md2Bytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *  å¯é€†çš„åŠ å¯†ç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param inStr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String KL(String inStr) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        char[] a = inStr.toCharArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; a.length; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            a[i] = (char) (a[i] ^ &#x27;t&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s = new String(a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return s;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *  åŠ å¯†åè§£å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param inStr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String JM(String inStr) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        char[] a = inStr.toCharArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; a.length; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            a[i] = (char) (a[i] ^ &#x27;t&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String k = new String(a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return k;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void md5(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String str = &quot;md5&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//JavaåŸç”Ÿ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] digest = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MessageDigest md5 = MessageDigest.getInstance(&quot;md5&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        digest  = md5.digest(str.getBytes(StandardCharsets.UTF_8));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //16æ˜¯è¡¨ç¤ºè½¬æ¢ä¸º16è¿›åˆ¶æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String md5StrJava = new BigInteger(1, digest).toString(16);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(md5StrJava);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	} catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//springè‡ªå¸¦å·¥å…·ç±»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String md5StrSpring = DigestUtils.md5DigestAsHex(str.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(md5StrSpring);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void md() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String inStr = &quot;000000&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;åŸå§‹å­—ç¬¦ä¸²ï¼š&quot;+inStr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD2åŠ å¯†ï¼š&quot; + MDUtil.jdkMd2(inStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD2åŠ å¯†ï¼š&quot; + MDUtil.commonsCodecMd2(inStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD2åŠ å¯†ï¼š&quot; + MDUtil.bouncyCastleMD2(inStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//670b14728ad9902aecba32e22fa4f6bd  32ä½ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD4åŠ å¯†ï¼š&quot; + MDUtil.bouncyCastleMD4(inStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//bf85aaf547303397450fbc8ede0ec3a5  32ä½ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD5åŠ å¯†ï¼š&quot; + MDUtil.jdkMd5(inStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD5åŠ å¯†ï¼š&quot; + MDUtil.commonsCodecMd5(inStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD5åŠ å¯†ï¼š&quot; + MDUtil.bouncyCastleMD5(inStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//670b14728ad9902aecba32e22fa4f6bd  32ä½</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String encrypMode = MDUtil.jdkMd5(inStr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD5åå†åŠ å¯†ï¼š&quot; + MDUtil.KL(encrypMode));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;è§£å¯†ä¸ºMD5åçš„ï¼š&quot; + MDUtil.JM(MDUtil.KL(encrypMode)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="des">DES<a href="#des" class="hash-link" aria-label="DESçš„ç›´æ¥é“¾æ¥" title="DESçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2. DESåŠ å¯†ç®—æ³•--3DES--AES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DESå…¨ç§°ä¸ºData Encryption Standardï¼Œå³æ•°æ®åŠ å¯†æ ‡å‡†ï¼Œæ˜¯â¼€ç§ä½¿â½¤å¯†é’¥åŠ å¯†çš„å—ç®—æ³•ï¼Œ DESç®—æ³•çš„â¼Šâ¼å‚æ•°æœ‰ä¸‰ä¸ªï¼šKeyã€Dataã€Modeã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Keyä¸º7ä¸ªå­—èŠ‚å…±56ä½,æ˜¯DESç®—æ³•çš„â¼¯ä½œå¯†é’¥ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dataä¸º8ä¸ªå­—èŠ‚64ä½ï¼Œæ˜¯è¦è¢«åŠ å¯†æˆ–è¢«è§£å¯†çš„æ•°æ®ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Modeä¸ºDESçš„å·¥ä½œæ–¹å¼,æœ‰ä¸¤ç§:åŠ å¯†æˆ–è§£å¯†ã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.CipherInputStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.CipherOutputStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.SecretKeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.DESKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.IvParameterSpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Base64;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class DESUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * åç§»å˜é‡ï¼Œå›ºå®šå 8ä½å­—èŠ‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final static String IV_PARAMETER = &quot;12345678&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * å¯†é’¥ç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String ALGORITHM = &quot;DES&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * åŠ å¯†/è§£å¯†ç®—æ³•-å·¥ä½œæ¨¡å¼-å¡«å……æ¨¡å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String CIPHER_ALGORITHM = &quot;DES/CBC/PKCS5Padding&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * é»˜è®¤ç¼–ç </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String CHARSET = &quot;utf-8&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * ç”Ÿæˆkey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static Key generateKey(String password) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DESKeySpec dks = new DESKeySpec(password.getBytes(CHARSET));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return keyFactory.generateSecret(dks);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DESåŠ å¯†å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param password åŠ å¯†å¯†ç ï¼Œé•¿åº¦ä¸èƒ½å¤Ÿå°äº8ä½</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data å¾…åŠ å¯†å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return åŠ å¯†åå†…å®¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String encrypt(String password, String data) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (password== null || password.length() &lt; 8) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(&quot;åŠ å¯†å¤±è´¥ï¼Œkeyä¸èƒ½å°äº8ä½&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (data == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Key secretKey = generateKey(password);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(CIPHER_ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            IvParameterSpec iv = new IvParameterSpec(IV_PARAMETER.getBytes(CHARSET));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, secretKey, iv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] bytes = cipher.doFinal(data.getBytes(CHARSET));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //JDK1.8åŠä»¥ä¸Šå¯ç›´æ¥ä½¿ç”¨Base64ï¼ŒJDK1.7åŠä»¥ä¸‹å¯ä»¥ä½¿ç”¨BASE64Encoder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //Androidå¹³å°å¯ä»¥ä½¿ç”¨android.util.Base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return new String(Base64.getEncoder().encode(bytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DESè§£å¯†å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param password è§£å¯†å¯†ç ï¼Œé•¿åº¦ä¸èƒ½å¤Ÿå°äº8ä½</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data å¾…è§£å¯†å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return è§£å¯†åå†…å®¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String decrypt(String password, String data) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (password== null || password.length() &lt; 8) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(&quot;åŠ å¯†å¤±è´¥ï¼Œkeyä¸èƒ½å°äº8ä½&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (data == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Key secretKey = generateKey(password);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(CIPHER_ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            IvParameterSpec iv = new IvParameterSpec(IV_PARAMETER.getBytes(CHARSET));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, secretKey, iv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return new String(cipher.doFinal(Base64.getDecoder().decode(data.getBytes(CHARSET))), CHARSET);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DESåŠ å¯†æ–‡ä»¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param srcFile  å¾…åŠ å¯†çš„æ–‡ä»¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param destFile åŠ å¯†åå­˜æ”¾çš„æ–‡ä»¶è·¯å¾„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return åŠ å¯†åçš„æ–‡ä»¶è·¯å¾„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String encryptFile(String password, String srcFile, String destFile) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (password== null || password.length() &lt; 8) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(&quot;åŠ å¯†å¤±è´¥ï¼Œkeyä¸èƒ½å°äº8ä½&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            IvParameterSpec iv = new IvParameterSpec(IV_PARAMETER.getBytes(CHARSET));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(CIPHER_ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, generateKey(password), iv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            InputStream is = new FileInputStream(srcFile);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            OutputStream out = new FileOutputStream(destFile);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            CipherInputStream cis = new CipherInputStream(is, cipher);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] buffer = new byte[1024];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int r;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while ((r = cis.read(buffer)) &gt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                out.write(buffer, 0, r);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cis.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            is.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return destFile;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DESè§£å¯†æ–‡ä»¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param srcFile  å·²åŠ å¯†çš„æ–‡ä»¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param destFile è§£å¯†åå­˜æ”¾çš„æ–‡ä»¶è·¯å¾„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return è§£å¯†åçš„æ–‡ä»¶è·¯å¾„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String decryptFile(String password, String srcFile, String destFile) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (password== null || password.length() &lt; 8) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(&quot;åŠ å¯†å¤±è´¥ï¼Œkeyä¸èƒ½å°äº8ä½&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            File file = new File(destFile);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (!file.exists()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                file.getParentFile().mkdirs();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                file.createNewFile();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            IvParameterSpec iv = new IvParameterSpec(IV_PARAMETER.getBytes(CHARSET));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(CIPHER_ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, generateKey(password), iv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            InputStream is = new FileInputStream(srcFile);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            OutputStream out = new FileOutputStream(destFile);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            CipherOutputStream cos = new CipherOutputStream(out, cipher);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] buffer = new byte[1024];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int r;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while ((r = is.read(buffer)) &gt;= 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                cos.write(buffer, 0, r);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cos.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            is.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return destFile;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.KeyGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.lang3.StringUtils;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SecurityDES {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String DES_MODE_JDK = &quot;jdk&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String DES_MODE_BC = &quot;bouncyCastle&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Key key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å•ä¾‹æ¨¡å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static SecurityDES securityDES;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static SecurityDES getInstance(String password, String succurityMode) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(securityDES == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            securityDES = new SecurityDES(password, succurityMode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return securityDES;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private SecurityDES(String password, String succurityMode)  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyGenerator generator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecureRandom secureRandom = SecureRandom.getInstance(&quot;SHA1PRNG&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            secureRandom.setSeed(password.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(StringUtils.isNotBlank(succurityMode) &amp;&amp; StringUtils.equals(DES_MODE_BC, succurityMode)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Security.addProvider(new BouncyCastleProvider());//å¢åŠ provider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                generator = KeyGenerator.getInstance(&quot;DES&quot;, &quot;BC&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                generator.init(56, secureRandom);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                generator.getProvider();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                generator = KeyGenerator.getInstance(&quot;DES&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                generator.init(56, secureRandom);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            key = generator.generateKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] encrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;DES/ECB/PKCS5Padding&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] decrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;DES/ECB/PKCS5Padding&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch(Exception e ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void des() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String src = &quot;é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œobject-orientedï¼@#*5&quot;; // éœ€è¦åŠ å¯†çš„åŸå§‹å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String password = &quot;123456&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityDES securityJdkDES = SecurityDES.getInstance(password, SecurityDES.DES_MODE_JDK);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeJdkDES = securityJdkDES.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK DESåŠ å¯†ï¼š&quot; + Base64.getEncoder().encode(encodeJdkDES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeJdkDES = securityJdkDES.decrypt(encodeJdkDES);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK DESè§£å¯†ï¼š&quot; + new String(decodeJdkDES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityDES securityBcDES = SecurityDES.getInstance(password, SecurityDES.DES_MODE_BC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeBcDES = securityBcDES.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle DESåŠ å¯†ï¼š&quot; + Base64.getEncoder().encode(encodeBcDES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeBcDES = securityBcDES.decrypt(encodeBcDES);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle DESè§£å¯†ï¼š&quot; + new String(decodeBcDES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.KeyGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.SecretKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.SecretKeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.DESedeKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.lang3.StringUtils;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SecurityDES3 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String DES3_MODE_JDK = &quot;jdk&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String DES3_MODE_BC = &quot;bouncyCastle&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Key key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å•ä¾‹æ¨¡å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static SecurityDES3 securityDES3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static SecurityDES3 getInstance(String password, String succurityMode) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(securityDES3 == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            securityDES3 = new SecurityDES3(password, succurityMode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return securityDES3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private SecurityDES3(String password, String succurityMode)  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //1.ç”Ÿæˆkey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecureRandom secureRandom = SecureRandom.getInstance(&quot;SHA1PRNG&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            secureRandom.setSeed(password.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyGenerator keyGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(StringUtils.isNotBlank(succurityMode) &amp;&amp; StringUtils.equals(DES3_MODE_BC, succurityMode)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 Security.addProvider(new BouncyCastleProvider());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 keyGenerator = KeyGenerator.getInstance(&quot;desede&quot;, &quot;BC&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                keyGenerator = KeyGenerator.getInstance(&quot;desede&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyGenerator.init(168, secureRandom);//åˆå§‹åŒ–keyçš„é•¿åº¦ï¼Œåªèƒ½æ˜¯128ï¼Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKey secretKey = keyGenerator.generateKey();//ç”Ÿæˆkey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] keyBytes = secretKey.getEncoded();//å¾—åˆ°keyçš„å­—èŠ‚æ•°ç»„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //2.keyçš„è½¬æ¢</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DESedeKeySpec deSedeKeySpec = new DESedeKeySpec(keyBytes);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKeyFactory factory = SecretKeyFactory.getInstance(&quot;desede&quot;);//ç§˜å¯†å¯†é’¥å·¥å‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            key = factory.generateSecret(deSedeKeySpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] encrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;desede/ECB/PKCS5Padding&quot;);//åŠ è§£å¯†æ–¹å¼+å·¥ä½œæ¨¡å¼+å¡«å……æ–¹å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, key);//ä»¥åŠ å¯†æ¨¡å¼åˆå§‹åŒ–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch(Exception e ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] decrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;desede/ECB/PKCS5Padding&quot;);//åŠ è§£å¯†æ–¹å¼+å·¥ä½œæ¨¡å¼+å¡«å……æ–¹å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch(Exception e ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void des3() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String src = &quot;é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œobject-orientedï¼@#*5&quot;; // éœ€è¦åŠ å¯†çš„åŸå§‹å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String password = &quot;123456&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityDES3 securityJdkDES3 = SecurityDES3.getInstance(password, SecurityDES3.DES3_MODE_JDK);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeJdkDES3 = securityJdkDES3.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK DES3åŠ å¯†ï¼š&quot; + Base64.getEncoder().encode(encodeJdkDES3));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeJdkDES3 = securityJdkDES3.decrypt(encodeJdkDES3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK DES3è§£å¯†ï¼š&quot; + new String(decodeJdkDES3));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityDES3 securityBcDES3 = SecurityDES3.getInstance(password, SecurityDES3.DES3_MODE_BC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeBcDES3 = securityBcDES3.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle DES3åŠ å¯†ï¼š&quot; + Base64.getEncoder().encode(encodeBcDES3));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeBcDES3 = securityBcDES3.decrypt(encodeBcDES3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle DES3è§£å¯†ï¼š&quot; + new String(decodeBcDES3));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rsa">RSA<a href="#rsa" class="hash-link" aria-label="RSAçš„ç›´æ¥é“¾æ¥" title="RSAçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">3. RSAåŠ å¯†ç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RSAæ˜¯â½¬å‰æœ€æœ‰å½±å“â¼’çš„å…¬é’¥åŠ å¯†ç®—æ³•ï¼Œå®ƒèƒ½å¤ŸæŠµæŠ—åˆ°â½¬å‰ä¸ºâ½Œå·²çŸ¥çš„ç»â¼¤å¤šæ•°å¯†ç æ”»å‡»ï¼Œå·²è¢«ISOæ¨èä¸ºå…¬é’¥æ•°æ®åŠ å¯†æ ‡å‡†ã€‚RSAæ˜¯è¢«ç ”ç©¶å¾—æœ€â¼´æ³›çš„å…¬é’¥ç®—æ³•ï¼Œä»æå‡ºåˆ°ç°åœ¨ï¼Œç»å†äº†å„ç§æ”»å‡»çš„è€ƒéªŒï¼Œé€æ¸ä¸ºâ¼ˆä»¬æ¥å—ï¼Œæ™®éè®¤ä¸ºæ˜¯â½¬å‰æœ€ä¼˜ç§€çš„å…¬é’¥â½…æ¡ˆä¹‹â¼€ã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import sun.misc.BASE64Decoder;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import sun.misc.BASE64Encoder;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.BadPaddingException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.IllegalBlockSizeException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.NoSuchPaddingException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.IOException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @title: RSAUtil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Author hmh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Date: 2022/7/4 16:06</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Version 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class RSAUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static KeyPair keyPairGenerator(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        KeyPair keyPair = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ä½¿ç”¨RSAç®—æ³•è·å¾—å¯†é’¥å¯¹ç”Ÿæˆå™¨å¯¹è±¡keyPairGenerator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;RSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //è®¾ç½®å¯†é’¥é•¿åº¦ä¸º1024</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPairGenerator.initialize(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ç”Ÿæˆå¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPair = keyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return keyPair;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * å…¬é’¥åŠ å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param password åŠ å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param publicKey å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return åŠ å¯†åæ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String encrypt(String password, PublicKey publicKey){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] secret = new byte[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //è·å–ä¸€ä¸ªåŠ å¯†ç®—æ³•ä¸ºRSAçš„åŠ è§£å¯†å™¨å¯¹è±¡cipherã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;RSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //è®¾ç½®ä¸ºåŠ å¯†æ¨¡å¼,å¹¶å°†å…¬é’¥ç»™cipherã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //è·å¾—å¯†æ–‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            secret = cipher.doFinal(password.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException | NoSuchPaddingException | InvalidKeyException | IllegalBlockSizeException | BadPaddingException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //è¿›è¡ŒBase64ç¼–ç å¹¶è¿”å›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new BASE64Encoder().encode(secret);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * ç§é’¥è§£å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param password è§£å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param privateKey ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return è§£å¯†åçš„æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String decrypt(String password, PrivateKey privateKey){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] b = new byte[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;RSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ä¼ é€’ç§é’¥ï¼Œè®¾ç½®ä¸ºè§£å¯†æ¨¡å¼ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //è§£å¯†å™¨è§£å¯†ç”±Base64è§£ç åçš„å¯†æ–‡,è·å¾—æ˜æ–‡å­—èŠ‚æ•°ç»„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            b = cipher.doFinal(new BASE64Decoder().decodeBuffer(password));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException | NoSuchPaddingException | IllegalBlockSizeException | BadPaddingException | IOException | InvalidKeyException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //è½¬æ¢æˆå­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(b);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void rsa() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	KeyPair keyPair = RSAUtil.keyPairGenerator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	PrivateKey privateKey = keyPair.getPrivate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	PublicKey publicKey = keyPair.getPublic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(RSAUtil.encrypt(&quot;rsa&quot;, publicKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(RSAUtil.decrypt(RSAUtil.encrypt(&quot;rsa&quot;, publicKey), privateKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPair;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPairGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.NoSuchAlgorithmException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Signature;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.interfaces.RSAPrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.interfaces.RSAPublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.PKCS8EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.X509EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class DigitalSignRSA {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PUBLIC_KEY = &quot;RSAPublicKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PRIVATE_KEY = &quot;RSAPrivateKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** åˆå§‹åŒ–å¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Map å¯†é’¥å¯¹Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Map&lt;String, Object&gt; initKey() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å®ä¾‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;RSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // åˆå§‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨ï¼Œå¯†é’¥å¤§å°ä¸º96-1024ä½</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPairGenerator.initialize(512, new SecureRandom());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ç”Ÿæˆå¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RSAPrivateKey privateKey = (RSAPrivateKey) keyPair.getPrivate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å°†å¯†é’¥å¯¹å­˜å‚¨åœ¨Mapä¸­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Map&lt;String, Object&gt; keyMap = new HashMap&lt;String, Object&gt;(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PUBLIC_KEY, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PRIVATE_KEY, privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return keyMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** æ‰§è¡Œæ•°å­—ç­¾åã€ç§é’¥ç­¾åã€‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data å¾…åŠ å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param privKey  ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] åŠ å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] digitalSign(byte[] data, byte[] privKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrivateKey privateKey = (PrivateKey) KeyFactory.getInstance(&quot;RSA&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePrivate(new PKCS8EncodedKeySpec(privKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Signature signature = Signature.getInstance(&quot;MD5WithRSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.initSign(privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.update(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return signature.sign();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** éªŒè¯ç­¾åã€å…¬é’¥éªŒè¯ã€‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data å¾…è§£å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param pubKey  å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] è§£å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static boolean signVerify(byte[] data, byte[] rsaData, byte[] pubKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PublicKey publicKey = (PublicKey) KeyFactory.getInstance(&quot;RSA&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePublic(new X509EncodedKeySpec(pubKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Signature signature = Signature.getInstance(&quot;MD5WithRSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.initVerify(publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.update(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return signature.verify(rsaData);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** å–å¾—ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap å¯†é’¥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPrivateKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PRIVATE_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** å–å¾—å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap å¯†é’¥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPublicKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PUBLIC_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void rsa() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] publicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] privateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//åˆå§‹åŒ–å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ç”Ÿæˆå¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Map&lt;String, Object&gt; keyMap = DigitalSignRSA.initKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	publicKey = DigitalSignRSA.getPublicKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	privateKey = DigitalSignRSA.getPrivateKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;RSAå…¬é’¥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(publicKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;RSAç§é’¥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(privateKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String msgA2B = &quot;What can I do for you?&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//æ‰§è¡Œæ•°å­—ç­¾åã€ç§é’¥ç­¾åã€‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeMsgA2B = DigitalSignRSA.digitalSign(msgA2B.getBytes(), privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK RSAç­¾åï¼š:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(encodeMsgA2B));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//éªŒè¯ç­¾åã€å…¬é’¥éªŒè¯ã€‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	boolean bool = DigitalSignRSA.signVerify(msgA2B.getBytes(), encodeMsgA2B, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;æ•°å­—ç­¾åæ˜¯å¦æœ‰æ•ˆï¼Ÿ:\n&quot; + bool);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶  ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="idea">IDEA<a href="#idea" class="hash-link" aria-label="IDEAçš„ç›´æ¥é“¾æ¥" title="IDEAçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">4.IDEAåŠ å¯†ç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IDEAï¼ˆInternational Data Encryption Algorithmï¼‰å›½é™…æ•°æ®åŠ å¯†ç®—æ³•ï¼šä½¿â½¤ 128 ä½å¯†é’¥æä¾›â¾®å¸¸å¼ºçš„å®‰å…¨æ€§ã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dsa">DSA<a href="#dsa" class="hash-link" aria-label="DSAçš„ç›´ æ¥é“¾æ¥" title="DSAçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">5. DSAåŠ å¯†ç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DSAï¼ˆDigital Signature Algorithmï¼‰ï¼šæ•°å­—ç­¾åç®—æ³•ï¼Œæ˜¯â¼€ç§æ ‡å‡†çš„ DSSï¼ˆæ•°å­—ç­¾åæ ‡å‡†ï¼‰ã€‚åªèƒ½ç”¨äºç­¾åï¼Œä¸èƒ½ç”¨äºåŠ è§£å¯†</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPair;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPairGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.NoSuchAlgorithmException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Signature;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.interfaces.DSAPrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.interfaces.DSAPublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.PKCS8EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.X509EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class DSAUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PUBLIC_KEY = &quot;DSAPublicKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PRIVATE_KEY = &quot;DSAPrivateKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** åˆå§‹åŒ–å¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Map å¯†é’¥å¯¹Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Map&lt;String, Object&gt; initKey() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å®ä¾‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;DSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // åˆå§‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨ï¼Œå¯†é’¥å¤§å°ä¸º96-1024ä½</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPairGenerator.initialize(512, new SecureRandom());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ç”Ÿæˆå¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DSAPublicKey publicKey = (DSAPublicKey) keyPair.getPublic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DSAPrivateKey privateKey = (DSAPrivateKey) keyPair.getPrivate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å°†å¯†é’¥å¯¹å­˜å‚¨åœ¨Mapä¸­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Map&lt;String, Object&gt; keyMap = new HashMap&lt;String, Object&gt;(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PUBLIC_KEY, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PRIVATE_KEY, privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return keyMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** æ‰§è¡Œæ•°å­—ç­¾åã€ç§é’¥ç­¾åã€‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data å¾…åŠ å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param privKey  ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] åŠ å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] digitalSign(byte[] data, byte[] privKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrivateKey privateKey = (PrivateKey) KeyFactory.getInstance(&quot;DSA&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePrivate(new PKCS8EncodedKeySpec(privKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Signature signature = Signature.getInstance(&quot;SHA1WithDSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.initSign(privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.update(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return signature.sign();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** éªŒè¯ç­¾åã€å…¬é’¥éªŒè¯ã€‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data å¾…è§£å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param pubKey  å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] è§£å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static boolean signVerify(byte[] data, byte[] rsaData, byte[] pubKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PublicKey publicKey = (PublicKey) KeyFactory.getInstance(&quot;DSA&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePublic(new X509EncodedKeySpec(pubKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Signature signature = Signature.getInstance(&quot;SHA1WithDSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.initVerify(publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.update(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return signature.verify(rsaData);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** å–å¾—ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap å¯†é’¥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPrivateKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PRIVATE_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** å–å¾—å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap å¯†é’¥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPublicKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PUBLIC_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void dsa() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] publicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] privateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//åˆå§‹åŒ–å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ç”Ÿæˆå¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Map&lt;String, Object&gt; keyMap = DSAUtil.initKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	publicKey = DSAUtil.getPublicKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	privateKey = DSAUtil.getPrivateKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;DSAå…¬é’¥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(publicKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;DSAç§é’¥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(privateKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String msgA2B = &quot;What can I do for you?&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//æ‰§è¡Œæ•°å­—ç­¾åã€ç§é’¥ç­¾åã€‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeMsgA2B = DSAUtil.digitalSign(msgA2B.getBytes(), privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK DSAç­¾åï¼š:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(encodeMsgA2B));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//éªŒè¯ç­¾åã€å…¬é’¥éªŒè¯ã€‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	boolean bool = DSAUtil.signVerify(msgA2B.getBytes(), encodeMsgA2B, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;æ•°å­—ç­¾åæ˜¯å¦æœ‰æ•ˆï¼Ÿ:\n&quot; + bool);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="aes">AES<a href="#aes" class="hash-link" aria-label="AESçš„ç›´æ¥é“¾æ¥" title="AESçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">6.AESåŠ å¯†ç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AESåŠ å¯†ç®—æ³•â¼œç§°RijndaelåŠ å¯†æ³•ï¼Œâ½¬å‰å·²ç»è¢«å¤šâ½…åˆ†æä¸”â¼´ä¸ºå…¨ä¸–ç•Œæ‰€ä½¿â½¤ã€‚ç»è¿‡äº”å¹´å‘å±•ï¼ŒAESåŠ å¯†ç®—æ³•å·²ç„¶æˆä¸ºå¯¹ç§°å¯†é’¥åŠ å¯†ä¸­æœ€æµè¡Œçš„ç®—æ³•ä¹‹â¼€ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">é—®é¢˜ï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(1) Illegal key size or default parametersï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">éœ€è¦æ›´æ”¹jceï¼Œä¸‹è½½åœ°å€</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-429243.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">æ›´æ¢ç›®å½•jarï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#{jdk}\jre\lib\security</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(2)Jurisdiction policy files are not signed by trusted signers!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jceç‰ˆæœ¬ä¸å¯¹ï¼Œå¯¹åº”jdkç‰ˆæœ¬ä¸‹è½½æ­£ç¡®çš„jce</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.IvParameterSpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.SecretKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.binary.Base64;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.binary.Hex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Locale;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author ï¼šsmallkinghjm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @descriptionï¼šTODO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @date ï¼š2022/3/2 11:20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class AESUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * AESåŠ å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param content æ˜æ–‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key     ç§˜é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String encrypt(String content, String key) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // å°†è¿”å›çš„åŠ å¯†è¿‡çš„ byte[] è½¬æ¢æˆBase64ç¼–ç å­—ç¬¦ä¸² ï¼ï¼ï¼ï¼å¾ˆå…³é”®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return base64ToString(AES_ECB_Encrypt(content.getBytes(), key.getBytes()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * AESè§£å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param content Base64ç¼–ç çš„å¯†æ–‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key     ç§˜é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String decrypt(String content, String key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // stringToBase64() å°† Base64ç¼–ç çš„å­—ç¬¦ä¸²è½¬æ¢æˆ byte[] !!!ä¸base64ToString(ï¼‰é…å¥—ä½¿ç”¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] base64 = stringToBase64(content);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] bytes = AES_ECB_Decrypt(base64, key.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String result = new String(bytes);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result.replaceAll(&quot;\&quot;&quot;,&quot;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log.info(&quot;AESè§£å¯†å‡ºé”™ï¼ï¼ï¼&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] AES_ECB_Encrypt(byte[] content, byte[] keyBytes) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKeySpec key = new SecretKeySpec(keyBytes, &quot;AES&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;AES/ECB/PKCS7Padding&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] result = cipher.doFinal(content);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] AES_ECB_Decrypt(byte[] content, byte[] keyBytes) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKeySpec key = new SecretKeySpec(keyBytes, &quot;AES&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;AES/ECB/PKCS7Padding&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] result = cipher.doFinal(content);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * å­—ç¬¦ä¸²è£…æ¢æˆ Base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] stringToBase64(String key) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Base64.decodeBase64(key.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Base64è£…æ¢æˆå­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String base64ToString(byte[] key) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new Base64().encodeToString(key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void aes() throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String key = &quot;5F6B2AK33DZE20A05E74C231B47AC8F6&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String content = &quot;smallkinghjm_2022&quot;;//æ˜æ–‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String encrypt = AESUtil.encrypt(content, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;åŠ å¯†ï¼š&quot; + encrypt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String decrypt = AESUtil.decrypt(encrypt, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;è§£å¯†ï¼š&quot;+decrypt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.KeyGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.SecretKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.SecretKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.lang3.StringUtils;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SecurityAES {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String AES_MODE_JDK = &quot;jdk&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String AES_MODE_BC = &quot;bouncyCastle&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Key key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å•ä¾‹æ¨¡å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static SecurityAES securityAES;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static SecurityAES getInstance(String password, String succurityMode) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(securityAES == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            securityAES = new SecurityAES(password, succurityMode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return securityAES;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private SecurityAES(String password, String succurityMode)  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //1.ç”Ÿæˆkey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecureRandom secureRandom = SecureRandom.getInstance(&quot;SHA1PRNG&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            secureRandom.setSeed(password.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyGenerator keyGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(StringUtils.isNotBlank(succurityMode) &amp;&amp; StringUtils.equals(AES_MODE_BC, succurityMode)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 Security.addProvider(new BouncyCastleProvider());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 keyGenerator = KeyGenerator.getInstance(&quot;aes&quot;, &quot;BC&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                keyGenerator = KeyGenerator.getInstance(&quot;aes&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyGenerator.init(128, secureRandom);//åˆå§‹åŒ–keyçš„é•¿åº¦ï¼Œåªèƒ½æ˜¯128ï¼Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKey secretKey = keyGenerator.generateKey();//ç”Ÿæˆkey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] keyBytes = secretKey.getEncoded();//å¾—åˆ°keyçš„å­—èŠ‚æ•°ç»„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //2.keyçš„è½¬æ¢</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            key = new SecretKeySpec(keyBytes, &quot;aes&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] encrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;AES/ECB/PKCS5Padding&quot;);//åŠ è§£å¯†æ–¹å¼+å·¥ä½œæ¨¡å¼+å¡«å……æ–¹å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, key);//ä»¥åŠ å¯†æ¨¡å¼åˆå§‹åŒ–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch(Exception e ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] decrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;AES/ECB/PKCS5Padding&quot;);//åŠ è§£å¯†æ–¹å¼+å·¥ä½œæ¨¡å¼+å¡«å……æ–¹å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch(Exception e ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void aes() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String src = &quot;é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œobject-orientedï¼@#*5&quot;; // éœ€è¦åŠ å¯†çš„åŸå§‹å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String password = &quot;123456&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityAES securityJdkAES = SecurityAES.getInstance(password, SecurityAES.AES_MODE_JDK);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeJdkAES = securityJdkAES.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK AESåŠ å¯†ï¼š&quot; + Base64.getEncoder().encode(encodeJdkAES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeJdkAES = securityJdkAES.decrypt(encodeJdkAES);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK AESè§£å¯†ï¼š&quot; + new String(decodeJdkAES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityAES securityBcAES = SecurityAES.getInstance(password, SecurityAES.AES_MODE_BC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeBcAES = securityBcAES.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle AESåŠ å¯†ï¼š&quot; + Base64.getEncoder().encode(encodeBcAES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeBcAES = securityBcAES.decrypt(encodeBcAES);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle AESè§£å¯†ï¼š&quot; + new String(decodeBcAES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="elgamal">Elgamal<a href="#elgamal" class="hash-link" aria-label="Elgamalçš„ç›´æ¥é“¾æ¥" title="Elgamalçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">7. ElgamalåŠ å¯†ç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ElGamalç®—æ³•ï¼Œæ˜¯â¼€ç§è¾ƒä¸ºå¸¸è§çš„åŠ å¯†ç®—æ³•ï¼Œå®ƒæ˜¯åŸºäº1984å¹´æå‡ºçš„å…¬é’¥å¯†ç ä½“åˆ¶å’Œæ¤­åœ†æ›²çº¿åŠ å¯†ä½“ç³»ã€‚æ—¢èƒ½â½¤äºæ•°æ®åŠ å¯†ä¹Ÿèƒ½â½¤äºæ•°å­—ç­¾åã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.AlgorithmParameterGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.AlgorithmParameters;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPair;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPairGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.PKCS8EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.X509EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.DHParameterSpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ElgamalUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * éå¯¹ç§°åŠ å¯†ç®—æ³•â€”â€”ELGamalç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * å¯¹äºï¼šâ€œIllegal key size or default parametersâ€å¼‚å¸¸ï¼Œæ˜¯å› ä¸ºç¾å›½çš„å‡ºå£é™åˆ¶ï¼ŒSuné€šè¿‡æƒé™æ–‡ä»¶ï¼ˆlocal_policy.jarã€US_export_policy.jarï¼‰åšäº†ç›¸åº”é™åˆ¶ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Java 7 æ— æ”¿ç­–é™åˆ¶æ–‡ä»¶ï¼šhttp://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * ä¸‹è½½åå¾—åˆ°UnlimitedJCEPolicyJDK7.zipï¼Œè§£å‹æ›¿æ¢%JAVA_HOME%/jre/lib/securityçš„ä¸¤ä¸ªæ–‡ä»¶å³å¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PUBLIC_KEY = &quot;elgamalPublicKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PRIVATE_KEY = &quot;elgamalPrivateKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** åˆå§‹åŒ–å¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Map å¯†é’¥å¯¹Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Map&lt;String, Object&gt; initKey() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Security.addProvider(new BouncyCastleProvider());//åŠ å…¥å¯¹Bouncy Castleçš„æ”¯æŒ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //1.åˆå§‹åŒ–å‘é€æ–¹å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            AlgorithmParameterGenerator algorithmParameterGenerator = AlgorithmParameterGenerator.getInstance(&quot;ELGamal&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            algorithmParameterGenerator.init(256);//åˆå§‹åŒ–å‚æ•°ç”Ÿæˆå™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            AlgorithmParameters algorithmParameters = algorithmParameterGenerator.generateParameters();//ç”Ÿæˆç®—æ³•å‚æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DHParameterSpec dhParameterSpec = algorithmParameters.getParameterSpec(DHParameterSpec.class);//æ„å»ºå‚æ•°ææ–™</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;ELGamal&quot;);//å®ä¾‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //åˆå§‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPairGenerator.initialize(dhParameterSpec, new SecureRandom());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å…¬é’¥å’Œç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PublicKey elGamalPublicKey = keyPair.getPublic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrivateKey elGamalPrivateKey = keyPair.getPrivate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å°†å¯†é’¥å¯¹å­˜å‚¨åœ¨Mapä¸­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Map&lt;String, Object&gt; keyMap = new HashMap&lt;String, Object&gt;(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PUBLIC_KEY, elGamalPublicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PRIVATE_KEY, elGamalPrivateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return keyMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** åŠ å¯†ã€å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†ã€‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data å¾…åŠ å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key  å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] åŠ å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] encrypt(byte[] data, byte[] key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PublicKey pubKey = (PublicKey) KeyFactory.getInstance(&quot;ELGamal&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePublic(new X509EncodedKeySpec(key));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;ELGamal&quot;,&quot;BC&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, pubKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] result = cipher.doFinal(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**  è§£å¯†ã€å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†ã€‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data å¾…è§£å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key  ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] è§£å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] decrypt(byte[] data, byte[] key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrivateKey priKey = (PrivateKey) KeyFactory.getInstance(&quot;ELGamal&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePrivate(new PKCS8EncodedKeySpec(key));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å®ä¾‹åŒ–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;ELGamal&quot;,&quot;BC&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ä½¿ç”¨å¯†é’¥åˆå§‹åŒ–ï¼Œè®¾ç½®ä¸ºè§£å¯†æ¨¡å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, priKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //æ‰§è¡Œæ“ä½œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] result = cipher.doFinal(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** å–å¾—ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap å¯†é’¥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPrivateKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PRIVATE_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** å–å¾—å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap å¯†é’¥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPublicKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PUBLIC_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void elgamal() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] publicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] privateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//åˆå§‹åŒ–å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ç”Ÿæˆç”²æ–¹å¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Map&lt;String, Object&gt; keyMap = ElgamalUtil.initKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	publicKey = ElgamalUtil.getPublicKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	privateKey = ElgamalUtil.getPrivateKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Elgamalå…¬é’¥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(publicKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Elgamalç§é’¥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(privateKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;===ç”²æ–¹å‘ä¹™æ–¹å‘é€åŠ å¯†æ•°æ®===&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String msgA2B = &quot;æ±‚çŸ¥è‹¥é¥¥ï¼Œè™šå¿ƒè‹¥æ„šã€‚&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;åŸæ–‡:\n&quot; + msgA2B);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;---ç”²æ–¹ä½¿ç”¨å…¬é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†---&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ä½¿ç”¨å…¬é’¥å¯¹æ•°æ®åŠ å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeMsgA2B = ElgamalUtil.encrypt(msgA2B.getBytes(), publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;ElgamalåŠ å¯†:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(encodeMsgA2B));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;---ä¹™æ–¹ä½¿ç”¨ç§é’¥å¯¹æ•°æ®åº“è¿›è¡Œè§£å¯†---&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ä½¿ç”¨ç§é’¥å¯¹æ•°æ®è¿›è¡Œè§£å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] msgB2A = ElgamalUtil.decrypt(encodeMsgA2B, privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String output1 = new String(msgB2A);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Elgamalè§£å¯†:\n&quot; + output1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="base64">Base64<a href="#base64" class="hash-link" aria-label="Base64çš„ç›´æ¥é“¾æ¥" title="Base64çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">8. Base64åŠ å¯†ç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Base64åŠ å¯†ç®—æ³•æ˜¯â½¹ç»œä¸Šæœ€å¸¸è§çš„â½¤äºä¼ è¾“8bitå­—èŠ‚ä»£ç çš„ç¼–ç â½…å¼ä¹‹â¼€ï¼ŒBase64ç¼–ç å¯â½¤äºåœ¨HTTPç¯å¢ƒä¸‹ä¼ é€’è¾ƒé•¿çš„æ ‡è¯†ä¿¡æ¯ã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//base64åŠ å¯†è§£å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Base64.getEncoder().encode(String)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Base64.getDecoder().decode(String)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.binary.Base64;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SecurityBASE64 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * base64ç®—æ³•æ˜¯åŸºäº64ä¸ªå­—ç¬¦çš„ä¸€ç§æ›¿æ¢ç®—æ³•ã€‚base64åŠ å¯†çš„äº§ç”Ÿå¼ç”µå­é‚®ä»¶çš„â€œå†å²é—®é¢˜â€â€”â€”é‚®ä»¶åªèƒ½ä¼ è¾“ASCIIç ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * base64åŠ å¯†çš„åº”ç”¨åœºæ™¯ï¼šemailã€å¯†é’¥ã€è¯ä¹¦æ–‡ä»¶ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *  è¯¥ç®—æ³•å¯ä»¥ç”±2ç§æ–¹å¼å®ç°ï¼šBouncy Castleã€Commons Codec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Commons Codecå®ç°base64ç¼–ç  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String encodeCC(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] encode = Base64.encodeBase64(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(encode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String decodeCC(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] decode = Base64.decodeBase64(src);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(decode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Bouncy Castleå®ç°base64ç¼–ç  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String encodeBC(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] encode = org.bouncycastle.util.encoders.Base64.encode(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(encode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String decodeBC(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] decode = org.bouncycastle.util.encoders.Base64.decode(src);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(decode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void base64() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String inStr = &quot;é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œobject-orientedï¼@#*5&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String encodeCC = SecurityBASE64.encodeCC(inStr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Commons Codecå®ç°base64ç¼–ç ï¼š\t&quot; + encodeCC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String decodeCC = SecurityBASE64.decodeCC(encodeCC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Commons Codecå®ç°base64è§£ç ï¼š\t&quot; + decodeCC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String encodeBC = SecurityBASE64.encodeBC(inStr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Bouncy Castleå®ç°base64ç¼–ç ï¼š\t&quot; + encodeBC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String decodeBC = SecurityBASE64.decodeBC(encodeBC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Bouncy Castleå®ç°base64è§£ç ï¼š\t&quot; + decodeBC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sha">SHA<a href="#sha" class="hash-link" aria-label="SHAçš„ç›´æ¥é“¾æ¥" title="SHAçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">9. SHA1åŠ å¯†ç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SHA1æ˜¯å’ŒMD5â¼€æ ·æµâ¾çš„æ¶ˆæ¯æ‘˜è¦ç®—æ³•ã€‚SHAåŠ å¯†ç®—æ³•æ¨¡ä»¿MD4åŠ å¯†ç®—æ³•ã€‚SHA1ä¸»è¦é€‚â½¤äºæ•°å­—ç­¾åæ ‡å‡†â¾¥â¾¯å®šä¹‰çš„æ•°å­—ç­¾åç®—æ³•ã€‚ä¸å¯é€†</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´  æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.MessageDigest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.NoSuchAlgorithmException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.binary.Hex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.digest.DigestUtils;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.digests.SHA1Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.digests.SHA224Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.digests.SHA256Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SHAUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *  å®‰å…¨æ•£åˆ—ç®—æ³•ï¼Œå›ºå®šé•¿åº¦çš„æ‘˜è¦ä¿¡æ¯ã€‚è¢«è®¤ä¸ºæ˜¯MD5çš„ç»§æ‰¿è€…ã€‚æ˜¯ä¸€ä¸ªç³»åˆ—ï¼ŒåŒ…æ‹¬SHA-1ã€SHA-2ï¼ˆSHA-224ã€SHA-256ã€SHA-384ã€SHA-512ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * JDKå®ç°sha-1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String jdkSHA1(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MessageDigest md = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            md = MessageDigest.getInstance(&quot;sha&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }// sha1ç®—æ³•ä¼ å…¥å‚æ•°ä¸ºsha</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] sha1Bytes = md.digest(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Hex.encodeHexString(sha1Bytes);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * JDKå®ç°sha-256 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String jdkSHA256(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MessageDigest md = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            md = MessageDigest.getInstance(&quot;sha-256&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        md.update(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(org.bouncycastle.util.encoders.Hex.encode(md.digest()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Commons Codecå®ç°sha-1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String commonsCodecSAH1(String src){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//        return DigestUtils.sha1Hex(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return DigestUtils.sha1Hex(src);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Bouncy Castleå®ç°sha-1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String bouncyCastleSHA1(String src){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Digest digest = new SHA1Digest();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        digest.update(src.getBytes(), 0, src.getBytes().length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[]sha1Bytes = new byte[digest.getDigestSize()];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        digest.doFinal(sha1Bytes, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(org.bouncycastle.util.encoders.Hex.encode(sha1Bytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Bouncy Castleå®ç°sha-224 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String bouncyCastleSHA224(String src){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Digest digest = new SHA224Digest();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        digest.update(src.getBytes(), 0, src.getBytes().length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[]sha224Bytes = new byte[digest.getDigestSize()];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        digest.doFinal(sha224Bytes, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(org.bouncycastle.util.encoders.Hex.encode(sha224Bytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Bouncy Castleå®ç°sha-256 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String bouncyCastleSHA256(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Digest digest = new SHA256Digest();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        digest.update(src.getBytes(), 0, src.getBytes().length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] sha256Bytes = new byte[digest.getDigestSize()];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        digest.doFinal(sha256Bytes, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(org.bouncycastle.util.encoders.Hex.encode(sha256Bytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void sha() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String src = &quot;object-oriente&quot;; // éœ€è¦åŠ å¯†çš„åŸå§‹å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK SHA-1:\t&quot; + SHAUtil.jdkSHA1(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;cc SHA-1:\t&quot; + SHAUtil.commonsCodecSAH1(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bc SHA-1:\t&quot; + SHAUtil.bouncyCastleSHA1(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bc SHA-224:\t&quot; + SHAUtil.bouncyCastleSHA224(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK SHA-256:\t&quot; + SHAUtil.jdkSHA256(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bc SHA-256:\t&quot; + SHAUtil.bouncyCastleSHA256(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pkcs">PKCS<a href="#pkcs" class="hash-link" aria-label="PKCSçš„ç›´æ¥é“¾æ¥" title="PKCSçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">10. PKCSåŠ å¯†ç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PKCSæ˜¯ç”±ç¾å›½RSAæ•°æ®å®‰å…¨å…¬å¸åŠå…¶åˆä½œä¼™ä¼´åˆ¶å®šçš„â¼€ç»„å…¬é’¥å¯†ç å­¦æ ‡å‡†ï¼Œå…¶ä¸­åŒ…æ‹¬è¯ä¹¦ç”³è¯·ã€è¯ä¹¦æ›´æ–°ã€è¯ä¹¦ä½œåºŸè¡¨å‘å¸ƒã€æ‰©å±•è¯ä¹¦å†…å®¹ä»¥åŠæ•°å­—ç­¾åã€æ•°å­—ä¿¡å°çš„æ ¼å¼ç­‰â½…â¾¯çš„â¼€ç³»åˆ—ç›¸å…³åè®®ã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ecdsa">ECDSA<a href="#ecdsa" class="hash-link" aria-label="ECDSAçš„ç›´æ¥é“¾æ¥" title="ECDSAçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">11.ECDSA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">å¾®è½¯çš„Officeã€Windowsæ“ä½œç³»ç»Ÿçš„éªŒè¯å°±æ˜¯ECDSAç®—æ³•â€”â€”æ¤­åœ†æ›²çº¿æ•°å­—ç­¾åç®—æ³•ï¼ˆElliptic Curve Digital Signature Algorithmï¼‰ï¼Œåœ¨2000å¹´çš„æ—¶å€™ç§°ä¸ºäº†ANSIå’ŒIEEEçš„æ ‡å‡†ã€‚ç‰¹ç‚¹æ˜¯ï¼šé€Ÿåº¦å¿«ã€ç­¾åçŸ­ã€å¼ºåº¦é«˜ã€‚åœ¨JDK1.7update4ä¹‹åæä¾›äº†å¯¹ECDSAçš„æ”¯æŒã€‚è¯¥ç­¾åçš„ç®—æ³•ä¹Ÿå’ŒRSAçš„æ•°å­—ç­¾åç®—æ³•ä¹Ÿæ˜¯å¤§åŒå°å¼‚ã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPair;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPairGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.NoSuchAlgorithmException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Signature;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.interfaces.ECPrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.interfaces.ECPublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.PKCS8EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.X509EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class DigitalSignECDSA {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PUBLIC_KEY = &quot;ECDSAPublicKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PRIVATE_KEY = &quot;ECDSAPrivateKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** åˆå§‹åŒ–å¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Map å¯†é’¥å¯¹Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Map&lt;String, Object&gt; initKey() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å®ä¾‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;EC&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // åˆå§‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨ï¼Œå¯†é’¥å¤§å°ä¸º256ä½</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPairGenerator.initialize(256, new SecureRandom());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ç”Ÿæˆå¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ECPublicKey publicKey = (ECPublicKey) keyPair.getPublic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ECPrivateKey privateKey = (ECPrivateKey) keyPair.getPrivate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å°†å¯†é’¥å¯¹å­˜å‚¨åœ¨Mapä¸­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Map&lt;String, Object&gt; keyMap = new HashMap&lt;String, Object&gt;(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PUBLIC_KEY, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PRIVATE_KEY, privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return keyMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** æ‰§è¡Œæ•°å­—ç­¾åã€ç§é’¥ç­¾åã€‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data å¾…åŠ å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param privKey  ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] åŠ å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] digitalSign(byte[] data, byte[] privKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrivateKey privateKey = (PrivateKey) KeyFactory.getInstance(&quot;EC&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePrivate(new PKCS8EncodedKeySpec(privKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Signature signature = Signature.getInstance(&quot;SHA1WithECDSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.initSign(privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.update(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return signature.sign();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** éªŒè¯ç­¾åã€å…¬é’¥éªŒè¯ã€‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data å¾…è§£å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param pubKey  å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] è§£å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static boolean signVerify(byte[] data, byte[] rsaData, byte[] pubKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PublicKey publicKey = (PublicKey) KeyFactory.getInstance(&quot;EC&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePublic(new X509EncodedKeySpec(pubKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Signature signature = Signature.getInstance(&quot;SHA1WithECDSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.initVerify(publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.update(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return signature.verify(rsaData);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** å–å¾—ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap å¯†é’¥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPrivateKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PRIVATE_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** å–å¾—å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap å¯†é’¥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPublicKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PUBLIC_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void ecdsa() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] publicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] privateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//åˆå§‹åŒ–å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ç”Ÿæˆå¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Map&lt;String, Object&gt; keyMap = DigitalSignECDSA.initKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	publicKey = DigitalSignECDSA.getPublicKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	privateKey = DigitalSignECDSA.getPrivateKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;ECDSAå…¬é’¥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(publicKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;ECDSAç§é’¥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(privateKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String msgA2B = &quot;What can I do for you?&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//æ‰§è¡Œæ•°å­—ç­¾åã€ç§é’¥ç­¾åã€‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeMsgA2B = DigitalSignECDSA.digitalSign(msgA2B.getBytes(), privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK ECDSAç­¾åï¼š:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(encodeMsgA2B));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//éªŒè¯ç­¾åã€å…¬é’¥éªŒè¯ã€‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	boolean bool = DigitalSignECDSA.signVerify(msgA2B.getBytes(), encodeMsgA2B, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;æ•°å­—ç­¾åæ˜¯å¦æœ‰æ•ˆï¼Ÿ:\n&quot; + bool);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dh">DH<a href="#dh" class="hash-link" aria-label="DHçš„ç›´æ¥é“¾æ¥" title="DHçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">éå¯¹ç§°åŠ å¯†ç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">åŠ å¯†å¯†é’¥åˆ†ä¸ºå…¬é’¥å’Œç§é’¥ã€‚å¯ä»¥ä½¿ç”¨å…¬é’¥åŠ å¯†ç§é’¥è§£å¯†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç§é’¥åŠ å¯†å…¬é’¥è§£å¯†ã€‚éå¯¹ç§°åŠ å¯†ç®—æ³•ä¸»è¦æœ‰ï¼šDHï¼ˆDiffie-Hellmanï¼‰å¯†é’¥äº¤æ¢ç®—æ³•ã€RSAï¼ˆåŸºäºå› å­åˆ†è§£ï¼‰ã€Elgamalï¼ˆåŸºäºç¦»æ•£å¯¹æ•°ï¼‰ã€ECCï¼ˆElliptical Curve Cryptographyï¼Œæ¤­åœ†æ›²çº¿åŠ å¯†ï¼‰ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DHï¼ˆå¯†é’¥äº¤æ¢ï¼‰ç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">å¦‚ä½•å®‰å…¨åœ°ä¼ é€å¯†é’¥æ˜¯å¯¹ç§°åŠ å¯†ç®—æ³•çš„ç—‡ç»“æ‰€åœ¨ã€‚å¯†é’¥äº¤æ¢ç®—æ³•æ˜¯é€šè¿‡æ„å»ºæœ¬åœ°å¯†é’¥æ¥è§£å†³å¯¹ç§°åŠ å¯†ç®—æ³•ä¸­çš„å¯†é’¥ä¼ é€’çš„é—®é¢˜çš„ã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPair;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPairGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.NoSuchAlgorithmException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.PKCS8EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.X509EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.KeyAgreement;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.KeyGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.SecretKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.interfaces.DHPrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.interfaces.DHPublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.DHParameterSpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.SecretKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SecurityDH {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** ä½¿ç”¨DHæ–¹å¼åŠ è§£å¯†çš„å‰ææ¡ä»¶ï¼šå¦åˆ™æŠ¥é”™ java.security.NoSuchAlgorithmException: Unsupported secret key algorithm: AES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *     1.å½“å‰å¼€å‘ç¯å¢ƒä¸­çš„è¿è¡Œçš„javaç¨‹åº, åœ¨jreä¸­é…ç½®ç¼ºçœVMå˜é‡ -Djdk.crypto.KeyAgreement.legacyKDF=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *         A.ç‚¹å‡»çª—å£ï¼Œé€‰æ‹©é¦–é€‰é¡¹  B.ç‚¹å‡»installed JREs, é€‰æ‹©JREé…ç½®ï¼Œç„¶åç¼–è¾‘  C.åœ¨ç¼ºçœVMå‚æ•°ï¼š-Djdk.crypto.KeyAgreement.legacyKDF=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *  2.å¯è¿è¡ŒjaråŒ…ï¼Œåˆ™éœ€è¦åœ¨è¿è¡Œæ—¶é‡‡ç”¨å‘½ä»¤æç¤ºç¬¦è¿è¡Œï¼Œåœ¨è¿è¡Œæ—¶æ·»åŠ VMå‚æ•°ï¼Œè¿è¡Œå‘½ä»¤ä¸ºï¼šjava -jar -Djdk.crypto.KeyAgreement.legacyKDF=true jarPackName.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *         A.ç¼–è¾‘å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé…ç½®VMå‚æ•°ï¼š-Djdk.crypto.KeyAgreement.legacyKDF=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** æœ¬åœ°å¯†é’¥ç®—æ³•ï¼Œå³å¯¹ç§°åŠ å¯†å¯†é’¥ç®—æ³•  å¯é€‰DESã€DESedeæˆ–è€…AES*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String SELECT_ALGORITHM = &quot;AES&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** é»˜è®¤çš„åŠ å¯†ç®—æ³• */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String DEFAULT_CIPHER_ALGORITHM = &quot;AES/ECB/PKCS5Padding&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** å¯†é’¥é•¿åº¦ */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final int KEY_SIZE = 512;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PUBLIC_KEY = &quot;DHPublicKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PRIVATE_KEY = &quot;DHPrivateKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**  åˆå§‹åŒ–ç”²æ–¹å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Map ç”²æ–¹å¯†é’¥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Map&lt;String, Object&gt; initKey() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å®ä¾‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;DH&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //åˆå§‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPairGenerator.initialize(KEY_SIZE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ç”Ÿæˆå¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ç”²æ–¹å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DHPublicKey publicKey = (DHPublicKey) keyPair.getPublic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ç”²æ–¹ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DHPrivateKey privateKey = (DHPrivateKey) keyPair.getPrivate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å°†å¯†é’¥å¯¹å­˜å‚¨åœ¨Mapä¸­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Map&lt;String, Object&gt; keyMap = new HashMap&lt;String, Object&gt;(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PUBLIC_KEY, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PRIVATE_KEY, privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return keyMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** åˆå§‹åŒ–ä¹™æ–¹å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key ç”²æ–¹å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Map ä¹™æ–¹å¯†é’¥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Map&lt;String, Object&gt; initKey(byte[] key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //è§£æç”²æ–¹å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //è½¬æ¢å…¬é’¥ææ–™</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            X509EncodedKeySpec x509KeySpec = new X509EncodedKeySpec(key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å®ä¾‹åŒ–å¯†é’¥å·¥å‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyFactory keyFactory = KeyFactory.getInstance(&quot;DH&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //äº§ç”Ÿå…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PublicKey pubKey = keyFactory.generatePublic(x509KeySpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ç”±ç”²æ–¹å…¬é’¥æ„å»ºä¹™æ–¹å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DHParameterSpec dhParameterSpec = ((DHPublicKey) pubKey).getParams();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å®ä¾‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;DH&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //åˆå§‹åŒ–å¯†é’¥å¯¹ç”Ÿæˆå™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPairGenerator.initialize(dhParameterSpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //äº§ç”Ÿå¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ä¹™æ–¹å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DHPublicKey publicKey = (DHPublicKey) keyPair.getPublic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ä¹™æ–¹ç§çº¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DHPrivateKey privateKey = (DHPrivateKey) keyPair.getPrivate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å°†å¯†é’¥å¯¹å­˜å‚¨åœ¨Mapä¸­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Map&lt;String, Object&gt; keyMap = new HashMap&lt;String, Object&gt;(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PUBLIC_KEY, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PRIVATE_KEY, privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return keyMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** ç”ŸæˆåŠ å¯†ç§˜é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static SecretKeySpec getSecretKey(final byte[] key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //è¿”å›ç”ŸæˆæŒ‡å®šç®—æ³•å¯†é’¥ç”Ÿæˆå™¨çš„ KeyGenerator å¯¹è±¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        KeyGenerator kg = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            kg = KeyGenerator.getInstance(SELECT_ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //AES è¦æ±‚å¯†é’¥é•¿åº¦ä¸º 128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            kg.init(128, new SecureRandom(key));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ç”Ÿæˆä¸€ä¸ªå¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKey secretKey = kg.generateKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return new SecretKeySpec(secretKey.getEncoded(), SELECT_ALGORITHM);// è½¬æ¢ä¸ºAESä¸“ç”¨å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** åŠ å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data å¾…åŠ å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key  å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] åŠ å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] encrypt(byte[] data, byte[] key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(DEFAULT_CIPHER_ALGORITHM);// åˆ›å»ºå¯†ç å™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] byteContent = data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, getSecretKey(key));// åˆå§‹åŒ–ä¸ºåŠ å¯†æ¨¡å¼çš„å¯†ç å™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] result = cipher.doFinal(byteContent);// åŠ å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**  è§£å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data å¾…è§£å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key  å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] è§£å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] decrypt(byte[] data, byte[] key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å®ä¾‹åŒ–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(DEFAULT_CIPHER_ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ä½¿ç”¨å¯†é’¥åˆå§‹åŒ–ï¼Œè®¾ç½®ä¸ºè§£å¯†æ¨¡å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, getSecretKey(key));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //æ‰§è¡Œæ“ä½œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] result = cipher.doFinal(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** æ„å»ºå¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param publicKey  å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param privateKey ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] æœ¬åœ°å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getSecretKey(byte[] publicKey, byte[] privateKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å®ä¾‹åŒ–å¯†é’¥å·¥å‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyFactory keyFactory = KeyFactory.getInstance(&quot;DH&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //åˆå§‹åŒ–å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å¯†é’¥ææ–™è½¬æ¢</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            X509EncodedKeySpec x509KeySpec = new X509EncodedKeySpec(publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //äº§ç”Ÿå…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PublicKey pubKey = keyFactory.generatePublic(x509KeySpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //åˆå§‹åŒ–ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å¯†é’¥ææ–™è½¬æ¢</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PKCS8EncodedKeySpec pkcs8KeySpec = new PKCS8EncodedKeySpec(privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //äº§ç”Ÿç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrivateKey priKey = keyFactory.generatePrivate(pkcs8KeySpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //å®ä¾‹åŒ–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyAgreement keyAgree = KeyAgreement.getInstance(keyFactory.getAlgorithm());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //åˆå§‹åŒ–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyAgree.init(priKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyAgree.doPhase(pubKey, true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //ç”Ÿæˆæœ¬åœ°å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKey secretKey = keyAgree.generateSecret(SELECT_ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return secretKey.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** å–å¾—ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap å¯†é’¥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPrivateKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PRIVATE_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** å–å¾—å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap å¯†é’¥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPublicKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PUBLIC_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void dh() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ç”²æ–¹å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] publicKeyA;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ç”²æ–¹ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] privateKeyA;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ç”²æ–¹æœ¬åœ°å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] localKeyA;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ä¹™æ–¹å…¬é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] publicKeyB;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ä¹™æ–¹ç§é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] privateKeyB;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ä¹™æ–¹æœ¬åœ°å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] localKeyB;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//åˆå§‹åŒ–å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ç”Ÿæˆç”²æ–¹å¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Map&lt;String, Object&gt; keyMapA = SecurityDH.initKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	publicKeyA = SecurityDH.getPublicKey(keyMapA);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	privateKeyA = SecurityDH.getPrivateKey(keyMapA);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;ç”²æ–¹å…¬é’¥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(publicKeyA));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;ç”²æ–¹ç§é’¥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(privateKeyA));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ç”±ç”²æ–¹å…¬é’¥äº§ç”Ÿä¹™æ–¹æœ¬åœ°å¯†é’¥å¯¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Map&lt;String, Object&gt; keyMapB = SecurityDH.initKey(publicKeyA);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	publicKeyB = SecurityDH.getPublicKey(keyMapB);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	privateKeyB = SecurityDH.getPrivateKey(keyMapB);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;ä¹™æ–¹å…¬é’¥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(publicKeyB));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;ä¹™æ–¹ç§é’¥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(privateKeyB));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	localKeyA = SecurityDH.getSecretKey(publicKeyB, privateKeyA);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;ç”²æ–¹æœ¬åœ°å¯†é’¥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(localKeyA));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	localKeyB = SecurityDH.getSecretKey(publicKeyA, privateKeyB);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;ä¹™æ–¹æœ¬åœ°å¯†é’¥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(localKeyB));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;===ç”²æ–¹å‘ä¹™æ–¹å‘é€åŠ å¯†æ•°æ®===&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String msgA2B = &quot;æ±‚çŸ¥è‹¥é¥¥ï¼Œè™šå¿ƒè‹¥æ„šã€‚&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;åŸæ–‡:\n&quot; + msgA2B);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;---ä½¿ç”¨ç”²æ–¹æœ¬åœ°å¯†é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†---&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ä½¿ç”¨ç”²æ–¹æœ¬åœ°å¯†é’¥å¯¹æ•°æ®åŠ å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeMsgA2B = SecurityDH.encrypt(msgA2B.getBytes(), localKeyA);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;åŠ å¯†:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(encodeMsgA2B));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;---ä½¿ç”¨ä¹™æ–¹æœ¬åœ°å¯†é’¥å¯¹æ•°æ®åº“è¿›è¡Œè§£å¯†---&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ä½¿ç”¨ä¹™æ–¹æœ¬åœ°å¯†é’¥å¯¹æ•°æ®è¿›è¡Œè§£å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] msgB2A = SecurityDH.decrypt(encodeMsgA2B, localKeyB);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String output1 = new String(msgB2A);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;è§£å¯†:\n&quot; + output1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;/~.~.~.~.~.~.~.~.~.~.~.~.~.~.~.~.~.~..~.~.~.~.~.~.~.~.~.~.~.~.~.~.~.~.~.~/&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;===ä¹™æ–¹å‘ç”²æ–¹å‘é€åŠ å¯†æ•°æ®===&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String input2 = &quot;å¥½å¥½å­¦ä¹ ï¼Œå¤©å¤©å‘ä¸Šã€‚&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;åŸæ–‡:\n&quot; + input2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;---ä½¿ç”¨ä¹™æ–¹æœ¬åœ°å¯†é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†---&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ä½¿ç”¨ä¹™æ–¹æœ¬åœ°å¯†é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encode2 = SecurityDH.encrypt(input2.getBytes(), localKeyB);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;åŠ å¯†:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(encode2));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;---ä½¿ç”¨ç”²æ–¹æœ¬åœ°å¯†é’¥å¯¹æ•°æ®è¿›è¡Œè§£å¯†---&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//ä½¿ç”¨ç”²æ–¹æœ¬åœ°å¯†é’¥å¯¹æ•°æ®è¿›è¡Œè§£å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decode2 = SecurityDH.decrypt(encode2, localKeyA);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String output2 = new String(decode2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;è§£å¯†:\n&quot; + output2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pbe">PBE<a href="#pbe" class="hash-link" aria-label="PBEçš„ç›´æ¥é“¾æ¥" title="PBEçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PBEç®—æ³•ç»“åˆäº†æ¶ˆæ¯æ‘˜è¦ç®—æ³•å’Œå¯¹ç§°åŠ å¯†ç®—æ³•çš„ä¼˜ç‚¹ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯¹ç§°åŠ å¯†ç®—æ³•ã€‚Password Based Encryptionï¼ŒåŸºäºå£ä»¤çš„åŠ å¯†ã€‚å› ä¸ºå£ä»¤æ˜¯æ¯”è¾ƒå¥½è®°çš„ï¼Œå°±å®¹æ˜“é€šè¿‡ç©·ä¸¾ã€çŒœæµ‹çš„æ–¹å¼è·å¾—å£ä»¤â€”â€”é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ–¹å¼æ˜¯åŠ ç›ï¼ˆSaltï¼‰ï¼Œé€šè¿‡åŠ å…¥ä¸€äº›é¢å¤–çš„å†…å®¹ï¼ˆé€šå¸¸æ˜¯éšæœºå­—ç¬¦ï¼‰å»æ‰°ä¹±ã€‚å®ç°çš„æ–¹å¼æœ‰2ç§ï¼šJDKå’ŒBCã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.SecretKeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.PBEKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.PBEParameterSpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.lang3.StringUtils;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SecurityPBE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String PBE_MODE_JDK = &quot;jdk&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String PBE_MODE_BC = &quot;bouncyCastle&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private PBEParameterSpec parameterSpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Key key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //å•ä¾‹æ¨¡å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static SecurityPBE securityPBE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static SecurityPBE getInstance(String password, String succurityMode) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(securityPBE == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            securityPBE = new SecurityPBE(password, succurityMode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return securityPBE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private SecurityPBE(String password, String succurityMode)  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //1.åˆå§‹åŒ–ç›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecureRandom secureRandom = new SecureRandom();//å¼ºåŠ å¯†éšæœºæ•°ç”Ÿæˆå™¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] salt= secureRandom.generateSeed(8);//äº§ç”Ÿç›å¿…é¡»æ˜¯8ä½</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //2.å£ä»¤ä¸å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(StringUtils.isNotBlank(succurityMode) &amp;&amp; StringUtils.equals(PBE_MODE_BC, succurityMode)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Security.addProvider(new BouncyCastleProvider());//æ·»åŠ åˆ°provider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                PBEKeySpec pbeKeySpec = new PBEKeySpec(password.toCharArray());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SecretKeyFactory factory = SecretKeyFactory.getInstance(&quot;PBEWithMD5AndDES&quot;,&quot;BC&quot;);//æŒ‡å®šprovider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                key = factory.generateSecret(pbeKeySpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                parameterSpec = new PBEParameterSpec(salt, 50);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                PBEKeySpec pbeKeySpec = new PBEKeySpec(password.toCharArray());//å¯†é’¥è½¬æ¢çš„å¯¹è±¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SecretKeyFactory factory = SecretKeyFactory.getInstance(&quot;PBEWithMD5AndDES&quot;);//å®ä¾‹åŒ–å¯†é’¥è½¬æ¢å·¥å‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                key = factory.generateSecret(pbeKeySpec);//ç”±å·¥å‚äº§ç”Ÿkey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                parameterSpec = new PBEParameterSpec(salt, 100);//PBEè¾“å…¥å‚æ•°çš„ææ–™ï¼Œç›ï¼Œè¿­ä»£100æ¬¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] encrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;PBEWithMD5AndDES&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, key, parameterSpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] result = cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch(Exception e ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] decrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;PBEWithMD5AndDES&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, key, parameterSpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch(Exception e ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void pbe() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String src = &quot;é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œobject-orientedï¼@#*5&quot;; // éœ€è¦åŠ å¯†çš„åŸå§‹å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String password = &quot;123456&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityPBE securityJdkPBE1 = SecurityPBE.getInstance(password, SecurityPBE.PBE_MODE_JDK);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeJdkPBE = securityJdkPBE1.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK PBEåŠ å¯†ï¼š&quot; + Base64.getEncoder().encode(encodeJdkPBE));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityPBE securityJdkPBE2 = SecurityPBE.getInstance(password, SecurityPBE.PBE_MODE_JDK);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeJdkPBE = securityJdkPBE2.decrypt(encodeJdkPBE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK PBEè§£å¯†ï¼š&quot; + new String(decodeJdkPBE));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityPBE securityBcPBE = SecurityPBE.getInstance(password, SecurityDES3.DES3_MODE_BC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeBcPBE = securityBcPBE.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle PBEåŠ å¯†ï¼š&quot; + Base64.getEncoder().encode(encodeBcPBE));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeBcPBE = securityBcPBE.decrypt(encodeBcPBE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle PBEè§£å¯†ï¼š&quot; + new String(decodeBcPBE));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mac">MAC<a href="#mac" class="hash-link" aria-label="MACçš„ç›´æ¥é“¾æ¥" title="MACçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">æ¶ˆæ¯æ‘˜è¦ç®—æ³•â€”â€”MAC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAC(Message Authentication Code)ï¼Œå…¼å®¹äº†MDå’ŒSHAçš„ç‰¹æ€§ï¼Œå¹¶ä¸”åœ¨å®ƒä»¬çš„åŸºç¡€ä¸ŠåŠ å…¥äº†å¯†é’¥ã€‚å› æ­¤MACä¹Ÿç§°ä¸ºHMACï¼ˆkeyed-Hash Message Authentication Codeï¼‰å«æœ‰å¯†é’¥çš„æ•£åˆ—å‡½æ•°ç®—æ³•ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MDç³»åˆ—ï¼šHmacMD2ã€HmacMD4ã€HmacMD5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SHAç³»åˆ—ï¼šHmacSHA1ã€HmacSHA224ã€HmacSHA256ã€HmacSHA384ã€HmacSHA512</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.InvalidKeyException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.NoSuchAlgorithmException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Mac;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.SecretKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.SecretKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.DecoderException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.binary.Hex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.digests.MD5Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.macs.HMac;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.params.KeyParameter;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SecurityMac {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * MAC(Message Authentication</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Code)ï¼Œå…¼å®¹äº†MDå’ŒSHAçš„ç‰¹æ€§ï¼Œå¹¶ä¸”åœ¨å®ƒä»¬çš„åŸºç¡€ä¸ŠåŠ å…¥äº†å¯†é’¥ã€‚å› æ­¤MACä¹Ÿç§°ä¸ºHMACï¼ˆkeyed-Hash Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Authentication Codeï¼‰å«æœ‰å¯†é’¥çš„æ•£åˆ—å‡½æ•°ç®—æ³•ã€‚ MDç³»åˆ—ï¼šHmacMD2ã€HmacMD4ã€HmacMD5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * SHAç³»åˆ—ï¼šHmacSHA1ã€HmacSHA224ã€HmacSHA256ã€HmacSHA384ã€HmacSHA512</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * ä¾‹å¦‚ï¼šå¸¸ç”¨çš„Linuxå®¢æˆ·ç«¯SecurityCRT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static String privateKey = &quot;aabbccddee&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * HmacMD5åŠ å¯†ç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String jdkHmacMD5(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] hmacMD5Bytes = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 1.å¾—åˆ°å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//            KeyGenerator keyGenerator = KeyGenerator.getInstance(&quot;HmacMD5&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//            SecretKey secretKey = keyGenerator.generateKey();// ç”Ÿæˆå¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//            byte[] key = secretKey.getEncoded();//è·å¾—å¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 2.è¿˜åŸå¯†é’¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] privKey = Hex.decodeHex(privateKey.toCharArray());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKey restoreSecretKey = new SecretKeySpec(privKey, &quot;HmacMD5&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 3.ä¿¡æ¯æ‘˜è¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Mac mac = Mac.getInstance(restoreSecretKey.getAlgorithm());// å®ä¾‹åŒ–mac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mac.init(restoreSecretKey);// åˆå§‹åŒ–mac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            hmacMD5Bytes = mac.doFinal(src.getBytes());// æ‰§è¡Œæ‘˜è¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (DecoderException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (InvalidKeyException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Hex.encodeHexString(hmacMD5Bytes);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * HmacMD5åŠ å¯†ç®—æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String bouncyCastleHmacMD5(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HMac hmac = new HMac(new MD5Digest());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //ç”Ÿæˆå¯†é’¥çš„æ—¶å€™ä»¥aabbccddeeä¸ºåŸºå‡†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hmac.init(new KeyParameter(org.bouncycastle.util.encoders.Hex.decode(privateKey)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hmac.update(src.getBytes(), 0, src.getBytes().length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // æ‰§è¡Œæ‘˜è¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[]hmacMDdBytes = new byte[hmac.getMacSize()];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hmac.doFinal(hmacMDdBytes, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(org.bouncycastle.util.encoders.Hex.encode(hmacMDdBytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void mac() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String src = &quot;object-oriente&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;jdkHmacMD5:\t&quot; + SecurityMac.jdkHmacMD5(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bcHmacMD5:\t&quot;+ SecurityMac.bouncyCastleHmacMD5(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å“ˆå¸Œç®—æ³•">å“ˆå¸Œç®—æ³•<a href="#å“ˆå¸Œç®—æ³•" class="hash-link" aria-label="å“ˆå¸Œç®—æ³•çš„ç›´æ¥é“¾æ¥" title="å“ˆå¸Œç®—æ³•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<blockquote>
<p>å“ˆå¸Œç®—æ³•å¯ä»¥ç®€å•åˆ†ä¸ºä¸¤ç±»</p>
<blockquote>
<ol>
<li>
<p>åŠ å¯†å“ˆå¸Œç®—æ³•</p>
<blockquote>
<p>å®‰å…¨æ€§è¾ƒé«˜çš„å“ˆå¸Œç®—æ³•ï¼Œå®ƒå¯ä»¥æä¾›ä¸€å®šçš„æ•°æ®å®Œæ•´æ€§ä¿æŠ¤å’Œæ•°æ®é˜²ç¯¡æ”¹èƒ½åŠ›ï¼Œèƒ½å¤ŸæŠµå¾¡ä¸€å®šçš„æ”»å‡»æ‰‹æ®µï¼Œå®‰å…¨æ€§ç›¸å¯¹è¾ƒé«˜ï¼Œä½†æ€§èƒ½è¾ƒå·®ï¼Œé€‚ç”¨äºå¯¹å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ã€‚ä¾‹å¦‚ SHA2ã€SHA3ã€SM3ã€RIPEMD-160ã€BLAKE2ã€SipHash ç­‰ç­‰</p>
</blockquote>
</li>
<li>
<p>éåŠ å¯†å“ˆå¸Œç®—æ³•</p>
<blockquote>
<p>å®‰å…¨æ€§ç›¸å¯¹è¾ƒä½çš„å“ˆå¸Œç®—æ³•ï¼Œæ˜“å—åˆ°æš´åŠ›ç ´è§£ã€å†²çªæ”»å‡»ç­‰æ”»å‡»æ‰‹æ®µçš„å½±å“ï¼Œä½† æ€§èƒ½è¾ƒé«˜ï¼Œé€‚ç”¨äºå¯¹å®‰å…¨æ€§æ²¡æœ‰è¦æ±‚çš„ä¸šåŠ¡åœºæ™¯ã€‚ä¾‹å¦‚ CRC32ã€MurMurHash3ã€SipHash ç­‰ç­‰</p>
</blockquote>
</li>
<li>
<p>é™¤äº†è¿™ä¸¤ç§ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›ç‰¹æ®Šçš„å“ˆå¸Œç®—æ³•ï¼Œä¾‹å¦‚å®‰å…¨æ€§æ›´é«˜çš„<strong>æ…¢å“ˆå¸Œç®—æ³•</strong>ã€‚</p>
</li>
</ol>
</blockquote>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ç§é’¥å…¬é’¥ç­¾è¯åŠ å¯†">ç§é’¥å…¬é’¥ç­¾è¯åŠ å¯†<a href="#ç§é’¥å…¬é’¥ç­¾è¯åŠ å¯†" class="hash-link" aria-label="ç§é’¥å…¬é’¥ç­¾è¯åŠ å¯†çš„ç›´æ¥é“¾æ¥" title="ç§é’¥å…¬é’¥ç­¾è¯åŠ å¯†çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//utf-8ç¼–ç /è§£å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String encode = URLEncoder.encode(&quot;æµ‹è¯•&quot;, &quot;UTF-8&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String decode = URLDecoder.decode(&quot;æµ‹è¯•&quot;, &quot;UTF-8&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Privateè½¬æˆString</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Base64.getEncoder().encodeToString(privateKey.getEncoded());</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//è‡ªå®šä¹‰å®ç° -- utf-8ç¼–ç /è§£å¯†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class EncodingUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> public static String decodeURIComponent(String s) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   if (s == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   String result = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result = URLDecoder.decode(s, &quot;UTF-8&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }catch (UnsupportedEncodingException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result = s;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> public static String encodeURIComponent(String s) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   String result = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     result = URLEncoder.encode(s, &quot;UTF-8&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               .replaceAll(&quot;\\+&quot;, &quot;%20&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               .replaceAll(&quot;\\%21&quot;, &quot;!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               .replaceAll(&quot;\\%27&quot;, &quot;&#x27;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               .replaceAll(&quot;\\%28&quot;, &quot;(&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               .replaceAll(&quot;\\%29&quot;, &quot;)&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               .replaceAll(&quot;\\%7E&quot;, &quot;~&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }catch (UnsupportedEncodingException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     result = s;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private EncodingUtil() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   super();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * pfxè·å–ç§é’¥åˆ«åç­‰ä¿¡æ¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static byte[] getPrivateKeyInfo(String content){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String keyAlias = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        KeyStore keyStore = KeyStore.getInstance(&quot;PKCS12&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileInputStream fileInputStream = new FileInputStream(new ClassPathResource(PRIVATE_ADDRESS).getFile());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        char[] nPassword = PRIVATE_PASSWORD.toCharArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        keyStore.load(fileInputStream, nPassword);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fileInputStream.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;keystore type=&quot; + keyStore.getType());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Enumeration&lt;String&gt; enumeration = keyStore.aliases();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (enumeration.hasMoreElements()){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyAlias = enumeration.nextElement();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log.info( &quot;alias=[&quot; + keyAlias + &quot;]&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;is key entry=&quot; + keyStore.isKeyEntry(keyAlias));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PrivateKey privateKey = (PrivateKey) keyStore.getKey(keyAlias, nPassword);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;private: &quot;+Base64.getEncoder().encodeToString(privateKey.getEncoded()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Certificate cert = keyStore.getCertificate(keyAlias);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PublicKey publickey = cert.getPublicKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // å¯¼å‡ºä¸º cer è¯ä¹¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            FileOutputStream fos = new FileOutputStream(&quot;C:\\Users\\chenx\\Desktop\\test&quot; + &quot;.cer&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fos.write(cert.getEncoded());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fos.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;public: &quot;+Base64.getEncoder().encodeToString(publickey.getEncoded()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;cert class = &quot; + cert.getClass().getName());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;cert = &quot; + cert);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;public key = &quot; + publickey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;private key = &quot; + privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //ç§é’¥ç­¾å</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] signOne = sign(content, privateKey) ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info(&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;ç­¾åå&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n&quot; + new String(Base64.getEncoder().encode(signOne)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //å…¬é’¥éªŒç­¾</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        boolean verifySign = verify(content,signOne,publickey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info(&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;éªŒç­¾ç»“æœ&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n&quot; + verifySign);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (verifySign){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return signOne;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (Exception e){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.error(e.getMessage());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new byte[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//ç§é’¥ç­¾å</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static byte[] sign(String content, PrivateKey priKey) throws NoSuchAlgorithmException, InvalidKeyException, SignatureException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //è¿™é‡Œå¯ä»¥ä»è¯ä¹¦ä¸­è§£æå‡ºç­¾åç®—æ³•åç§°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //Signature signature = Signature.getInstance(getSigAlgName(pubCert));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Signature signature = Signature.getInstance(&quot;SHA256withRSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signature.initSign(priKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signature.update(content.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return signature.sign();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//å…¬é’¥éªŒç­¾</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static boolean verify(String content, byte[] sign, PublicKey pubKey) throws NoSuchAlgorithmException, InvalidKeyException, SignatureException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //è¿™é‡Œå¯ä»¥ä»è¯ä¹¦ä¸­è§£æå‡ºç­¾åç®—æ³•åç§°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //Signature signature = Signature.getInstance(getSigAlgName(priCert));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Signature signature = Signature.getInstance(&quot;SHA256withRSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signature.initVerify(pubKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signature.update(content.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return signature.verify(sign);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//å‚æ•°æ’åº -- æŒ‰å­—æ¯é¡ºåº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static String getSordBaseParamsStr(String jose,String nonce,String timestamp) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Map&lt;String,String&gt; params = getHeaderMaps(nonce,timestamp);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    params.put(&quot;jose&quot;, jose);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TreeMap&lt;String, String&gt; sorted = new TreeMap&lt;&gt;(params);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set&lt;String&gt; keys = params.keySet();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (String key : keys) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sorted.put(key, params.get(key));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    StringBuilder builder = new StringBuilder();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (Map.Entry&lt;String, String&gt; entry : sorted.entrySet()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (builder.length() &gt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            builder.append(&quot;&amp;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.append(entry.getKey()).append(&quot;=&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (null != entry.getValue()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            builder.append(entry.getValue());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log.info(&quot;*******sb.tostring:&quot; + builder.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return builder.toString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * è·å–ç§é’¥åˆ«åç­‰ä¿¡æ¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static PrivateKey getPrivateKeyInfo() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String privKeyFileString = SHA256WithRSASignatureUtil.PRIVATE_ADDRESS;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String privKeyPswdString = SHA256WithRSASignatureUtil.PRIVATE_PASSWORD;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String keyAlias = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        KeyStore keyStore = KeyStore.getInstance( &quot;PKCS12&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileInputStream fileInputStream = new FileInputStream(new ClassPathResource(privKeyFileString).getFile());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        char[] nPassword = privKeyPswdString.toCharArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        keyStore.load(fileInputStream, nPassword);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fileInputStream.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;keystore type=&quot; + keyStore.getType());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Enumeration&lt;String&gt; enumeration = keyStore.aliases();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (enumeration.hasMoreElements())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyAlias = enumeration.nextElement();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log.info( &quot;alias=[&quot; + keyAlias + &quot;]&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;is key entry=&quot; + keyStore.isKeyEntry(keyAlias));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return  (PrivateKey) keyStore.getKey(keyAlias, nPassword);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.error(&quot;-------è·å–ç§é’¥å¤±è´¥------&quot;,e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new JeecgBootException(&quot;è·å–ç§é’¥å¤±è´¥&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * è·å–å…¬é’¥åˆ«åç­‰ä¿¡æ¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static PublicKey getPublicKeyInfo()  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String privKeyFileString = SHA256WithRSASignatureUtil.PRIVATE_ADDRESS;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String privKeyPswdString = SHA256WithRSASignatureUtil.PRIVATE_PASSWORD;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String keyAlias = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        KeyStore keyStore = KeyStore.getInstance( &quot;PKCS12&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileInputStream fileInputStream = new FileInputStream(new ClassPathResource(privKeyFileString).getFile());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        char[] nPassword = privKeyPswdString.toCharArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        keyStore.load(fileInputStream, nPassword);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fileInputStream.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;keystore type=&quot; + keyStore.getType());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Enumeration&lt;String&gt; enumeration = keyStore.aliases();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (enumeration.hasMoreElements()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyAlias = enumeration.nextElement();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log.info( &quot;alias=[&quot; + keyAlias + &quot;]&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return keyStore.getCertificate(keyAlias).getPublicKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.error(&quot;------è·å–å…¬é’¥å¤±è´¥-----&quot;,e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new JeecgBootException(&quot;è·å–å…¬é’¥å¤±è´¥&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * åŠ å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param publicKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static String jweEncryption(Key publicKey, String payload)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(&quot;Payload before encryption :: &quot; + payload);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /*Encryption*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JWEHeader header = new JWEHeader.Builder(JWEAlgorithm.RSA_OAEP, EncryptionMethod.A256GCM).build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JWEEncrypter encryptedJWE = new RSAEncrypter((RSAPublicKey) publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JWEObject jweObject = new JWEObject(header, new Payload(getSignedContent(payload)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jweObject.encrypt(encryptedJWE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return jweObject.serialize();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static JWSObject getSignedContent(String content) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Payload contentPayload = new Payload(content);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RSASSASigner rsa = new RSASSASigner(getPrivateKeyInfo());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        JWSHeader header = new JWSHeader(JWSAlgorithm.RS256);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        JWSObject jws = new JWSObject(header, contentPayload);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        jws.sign(rsa);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return jws;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new RuntimeException(e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static String decryptJWE(String data){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JWEObject jweObject;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        jweObject = JWEObject.parse(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Decrypt with shared key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        jweObject.decrypt(new RSADecrypter(getPrivateKeyInfo()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Extract payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SignedJWT signedJWT = jweObject.getPayload().toSignedJWT();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (signedJWT.verify(new RSASSAVerifier((RSAPublicKey) getPublicKeyInfo()))) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //è§£å¯†æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return jweObject.getPayload().toString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (ParseException | JOSEException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.error(String.valueOf(e));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="é›ªèŠ±ç®—æ³•">é›ªèŠ±ç®—æ³•<a href="#é›ªèŠ±ç®—æ³•" class="hash-link" aria-label="é›ªèŠ±ç®—æ³•çš„ç›´æ¥é“¾æ¥" title="é›ªèŠ±ç®—æ³•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<!-- -->
<p>Â© <!-- -->2024<!-- --> mhuahe. <!-- -->å‚è€ƒ<!-- -->ï¼š<a href="https://pdai.tech/md/algorithm/alg-domain-id-snowflake.html" target="_blank" rel="noopener noreferrer">ã€Javaå…¨æ ˆçŸ¥è¯†ä½“ç³»ã€‘åˆ†å¸ƒå¼ç®—æ³•-Snowflakeç®—æ³•</a></p>
<blockquote>
<p>Snowflakeï¼Œé›ªèŠ±ç®—æ³•æ˜¯ç”±Twitterå¼€æºçš„åˆ†å¸ƒå¼IDç”Ÿæˆç®—æ³•ï¼Œä»¥åˆ’åˆ†å‘½åç©ºé—´çš„æ–¹å¼å°† 64-bitä½åˆ†å‰²æˆå¤šä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†ä»£è¡¨ä¸åŒçš„å«ä¹‰ã€‚è¿™ç§å°±æ˜¯å°†64ä½åˆ’åˆ†ä¸ºä¸åŒçš„æ®µï¼Œæ¯æ®µä»£è¡¨ä¸åŒçš„æ¶µä¹‰ï¼ŒåŸºæœ¬å°±æ˜¯æ—¶é—´æˆ³ã€æœºå™¨IDå’Œåºåˆ—æ•°ã€‚ä¸ºä»€ä¹ˆå¦‚æ­¤é‡è¦ï¼Ÿå› ä¸ºå®ƒæä¾›äº†ä¸€ç§IDç”ŸæˆåŠç”Ÿæˆçš„æ€è·¯ï¼Œå½“ç„¶è¿™ç§æ–¹æ¡ˆå°±æ˜¯éœ€è¦è€ƒè™‘æ—¶é’Ÿå›æ‹¨çš„é—®é¢˜ä»¥åŠåšä¸€äº› bufferçš„ç¼“å†²è®¾è®¡æé«˜æ€§èƒ½ã€‚</p>
</blockquote>
<p>Snowflakeï¼Œé›ªèŠ±ç®—æ³•æ˜¯ç”±Twitterå¼€æºçš„åˆ†å¸ƒå¼IDç”Ÿæˆç®—æ³•ï¼Œä»¥åˆ’åˆ†å‘½åç©ºé—´çš„æ–¹å¼å°† 64-bitä½åˆ†å‰²æˆå¤šä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†ä»£è¡¨ä¸åŒçš„å«ä¹‰ã€‚è€Œ Javaä¸­64bitçš„æ•´æ•°æ˜¯Longç±»å‹ï¼Œæ‰€ä»¥åœ¨ Java ä¸­ SnowFlake ç®—æ³•ç”Ÿæˆçš„ ID å°±æ˜¯ long æ¥å­˜å‚¨çš„ã€‚</p>
<ul>
<li><code>ç¬¬1ä½å ç”¨1bit</code>ï¼Œå…¶å€¼å§‹ç»ˆæ˜¯0ï¼Œå¯çœ‹åšæ˜¯ç¬¦å·ä½ä¸ä½¿ç”¨ã€‚</li>
<li><code>ç¬¬2ä½å¼€å§‹çš„41ä½æ˜¯æ—¶é—´æˆ³</code>ï¼Œ41-bitä½å¯è¡¨ç¤º2^41ä¸ªæ•°ï¼Œæ¯ä¸ªæ•°ä»£è¡¨æ¯«ç§’ï¼Œé‚£ä¹ˆé›ªèŠ±ç®—æ³•å¯ç”¨çš„æ—¶é—´å¹´é™æ˜¯<code>(1L&lt;&lt;41)/(1000L360024*365)\=69</code> å¹´çš„æ—¶é—´ã€‚</li>
<li><code>ä¸­é—´çš„10-bitä½å¯è¡¨ç¤ºæœºå™¨æ•°</code>ï¼Œå³2^10 = 1024å°æœºå™¨ï¼Œä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä¸ä¼šéƒ¨ç½²è¿™ä¹ˆå°æœºå™¨ã€‚å¦‚æœæˆ‘ä»¬å¯¹IDCï¼ˆäº’è”ç½‘æ•°æ®ä¸­å¿ƒï¼‰æœ‰éœ€æ±‚ï¼Œè¿˜å¯ä»¥å°† 10-bit åˆ† 5-bit ç»™ IDCï¼Œåˆ†5-bitç»™å·¥ä½œæœºå™¨ã€‚è¿™æ ·å°±å¯  ä»¥è¡¨ç¤º32ä¸ªIDCï¼Œæ¯ä¸ªIDCä¸‹å¯ä»¥æœ‰32å°æœºå™¨ï¼Œå…·ä½“çš„åˆ’åˆ†å¯ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚å®šä¹‰ã€‚</li>
<li><code>æœ€å12-bitä½æ˜¯è‡ªå¢åºåˆ—</code>ï¼Œå¯è¡¨ç¤º2^12 = 4096ä¸ªæ•°ã€‚</li>
</ul>
<p>è¿™æ ·çš„åˆ’åˆ†ä¹‹åç›¸å½“äºåœ¨ä¸€æ¯«ç§’ä¸€ä¸ªæ•°æ®ä¸­å¿ƒçš„ä¸€å°æœºå™¨ä¸Šå¯äº§ç”Ÿ4096ä¸ªæœ‰åºçš„ä¸é‡å¤çš„IDã€‚ä½†æ˜¯æˆ‘ä»¬ IDC å’Œæœºå™¨æ•°è‚¯å®šä¸æ­¢ä¸€ä¸ªï¼Œæ‰€ä»¥æ¯«ç§’å†…èƒ½ç”Ÿæˆçš„æœ‰åºIDæ•°æ˜¯ç¿»å€çš„ã€‚</p>
<!-- -->
<img src="/mhuahe.com/assets/images/Encryption-Snowflake-712f4526780ec25e3095a819fa880eae.png" alt="Snowflake" width="50%">
<p>Snowflake çš„Twitterå®˜æ–¹åŸç‰ˆæ˜¯ç”¨Scalaå†™çš„ï¼Œå¯¹Scalaè¯­è¨€æœ‰ç ”ç©¶çš„åŒå­¦å¯ä»¥å»é˜…è¯»ä¸‹ï¼Œä»¥ä¸‹æ˜¯ Java ç‰ˆæœ¬çš„å†™æ³•ã€‚</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.jajian.demo.distribute;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Twitter_Snowflake&lt;br&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * SnowFlakeçš„ç»“æ„å¦‚ä¸‹(æ¯éƒ¨åˆ†ç”¨-åˆ†å¼€):&lt;br&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 0 - 0000000000 0000000000 0000000000 0000000000 0 - 00000 - 00000 - 000000000000 &lt;br&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 1ä½æ ‡è¯†ï¼Œç”±äºlongåŸºæœ¬ç±»å‹åœ¨Javaä¸­æ˜¯å¸¦ç¬¦å·çš„ï¼Œæœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼Œæ­£æ•°æ˜¯0ï¼Œè´Ÿæ•°æ˜¯1ï¼Œæ‰€ä»¥idä¸€èˆ¬æ˜¯ æ­£æ•°ï¼Œæœ€é«˜ä½æ˜¯0&lt;br&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 41ä½æ—¶é—´æˆª(æ¯«ç§’çº§)ï¼Œæ³¨æ„ï¼Œ41ä½æ—¶é—´æˆªä¸æ˜¯å­˜å‚¨å½“å‰æ—¶é—´çš„æ—¶é—´æˆªï¼Œè€Œæ˜¯å­˜å‚¨æ—¶é—´æˆªçš„å·®å€¼ï¼ˆå½“å‰æ—¶é—´æˆª - å¼€å§‹æ—¶é—´æˆª)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * å¾—åˆ°çš„å€¼ï¼‰ï¼Œè¿™é‡Œçš„çš„å¼€å§‹æ—¶é—´æˆªï¼Œä¸€èˆ¬æ˜¯æˆ‘ä»¬çš„idç”Ÿæˆå™¨å¼€å§‹ä½¿ç”¨çš„æ—¶é—´ï¼Œç”±æˆ‘ä»¬ç¨‹åºæ¥æŒ‡å®šçš„ï¼ˆå¦‚ä¸‹ä¸‹é¢ç¨‹åºIdWorkerç±»çš„startTimeå±æ€§ï¼‰ã€‚41ä½çš„æ—¶é—´æˆªï¼Œå¯ä»¥ä½¿ç”¨69å¹´ï¼Œå¹´T = (1L &lt;&lt; 41) / (1000L * 60 * 60 * 24 * 365) = 69&lt;br&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 10ä½çš„æ•°æ®æœºå™¨ä½ï¼Œå¯ä»¥éƒ¨ç½²åœ¨1024ä¸ªèŠ‚ç‚¹ï¼ŒåŒ…æ‹¬5ä½datacenterIdå’Œ5ä½workerId&lt;br&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 12ä½åºåˆ—ï¼Œæ¯«ç§’å†…çš„è®¡æ•°ï¼Œ12ä½çš„è®¡æ•°é¡ºåºå·æ”¯æŒæ¯ä¸ªèŠ‚ç‚¹æ¯æ¯«ç§’(åŒä¸€æœºå™¨ï¼ŒåŒä¸€æ—¶é—´æˆª)äº§ç”Ÿ4096ä¸ªIDåºå·&lt;br&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * åŠ èµ·æ¥åˆšå¥½64ä½ï¼Œä¸ºä¸€ä¸ªLongå‹ã€‚&lt;br&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * SnowFlakeçš„ä¼˜ç‚¹æ˜¯ï¼Œæ•´ä½“ä¸ŠæŒ‰ç…§æ—¶é—´è‡ªå¢æ’åºï¼Œå¹¶ä¸”æ•´ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿå†…ä¸ä¼šäº§ç”ŸIDç¢°æ’(ç”±æ•°æ®ä¸­å¿ƒIDå’Œæœºå™¨IDä½œåŒºåˆ†)ï¼Œå¹¶ä¸”æ•ˆç‡è¾ƒé«˜ï¼Œç»æµ‹è¯•ï¼ŒSnowFlakeæ¯ç§’èƒ½å¤Ÿäº§ç”Ÿ26ä¸‡IDå·¦å³ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SnowflakeDistributeId {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ==============================Fields===========================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * å¼€å§‹æ—¶é—´æˆª (2015-01-01)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final long twepoch = 1420041600000L;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * æœºå™¨idæ‰€å çš„ä½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final long workerIdBits = 5L;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * æ•°æ®æ ‡è¯†idæ‰€å çš„ä½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final long datacenterIdBits = 5L;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * æ”¯æŒçš„æœ€å¤§æœºå™¨idï¼Œç»“æœæ˜¯31 (è¿™ä¸ªç§»ä½ç®—æ³•å¯ä»¥å¾ˆå¿«çš„è®¡ç®—å‡ºå‡ ä½äºŒè¿›åˆ¶æ•°æ‰€èƒ½è¡¨ç¤ºçš„æœ€å¤§åè¿›åˆ¶æ•°)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final long maxWorkerId = -1L ^ (-1L &lt;&lt; workerIdBits);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * æ”¯æŒçš„æœ€å¤§æ•°æ®æ ‡è¯†idï¼Œç»“æœæ˜¯31</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final long maxDatacenterId = -1L ^ (-1L &lt;&lt; datacenterIdBits);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * åºåˆ—åœ¨idä¸­å çš„ä½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final long sequenceBits = 12L;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * æœºå™¨IDå‘å·¦ç§»12ä½</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final long workerIdShift = sequenceBits;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * æ•°æ®æ ‡è¯†idå‘å·¦ç§»17ä½(12+5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final long datacenterIdShift = sequenceBits + workerIdBits;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * æ—¶é—´æˆªå‘å·¦ç§»22ä½(5+5+12)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final long timestampLeftShift = sequenceBits + workerIdBits + datacenterIdBits;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * ç”Ÿæˆåºåˆ—çš„æ©ç ï¼Œè¿™é‡Œä¸º4095 (0b111111111111=0xfff=4095)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final long sequenceMask = -1L ^ (-1L &lt;&lt; sequenceBits);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * å·¥ä½œæœºå™¨ID(0~31)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private long workerId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * æ•°æ®ä¸­å¿ƒID(0~31)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private long datacenterId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * æ¯«ç§’å†…åºåˆ—(0~4095)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private long sequence = 0L;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * ä¸Šæ¬¡ç”ŸæˆIDçš„æ—¶é—´æˆª</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private long lastTimestamp = -1L;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //==============================Constructors=====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * æ„é€ å‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param workerId     å·¥ä½œID (0~31)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param datacenterId æ•°æ®ä¸­å¿ƒID (0~31)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public SnowflakeDistributeId(long workerId, long datacenterId) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (workerId &gt; maxWorkerId || workerId &lt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new IllegalArgumentException(String.format(&quot;worker Id can&#x27;t be greater than %d or less than 0&quot;, maxWorkerId));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (datacenterId &gt; maxDatacenterId || datacenterId &lt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new IllegalArgumentException(String.format(&quot;datacenter Id can&#x27;t be greater than %d or less than 0&quot;, maxDatacenterId));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.workerId = workerId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.datacenterId = datacenterId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ==============================Methods==========================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * è·å¾—ä¸‹ä¸€ä¸ªID (è¯¥æ–¹æ³•æ˜¯çº¿ç¨‹å®‰å…¨çš„)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return SnowflakeId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public synchronized long nextId() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        long timestamp = timeGen();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //å¦‚æœå½“å‰æ—¶é—´å°äºä¸Šä¸€æ¬¡IDç”Ÿæˆçš„æ—¶é—´æˆ³ï¼Œè¯´æ˜ç³»ç»Ÿæ—¶é’Ÿå›é€€è¿‡è¿™ä¸ªæ—¶å€™åº”å½“æŠ›å‡ºå¼‚å¸¸</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (timestamp &lt; lastTimestamp) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    String.format(&quot;Clock moved backwards.  Refusing to generate id for %d milliseconds&quot;, lastTimestamp - timestamp));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //å¦‚æœæ˜¯åŒä¸€æ—¶é—´ç”Ÿæˆçš„ï¼Œåˆ™è¿›è¡Œæ¯«ç§’å†…åºåˆ—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (lastTimestamp == timestamp) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sequence = (sequence + 1) &amp; sequenceMask;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //æ¯«ç§’å†…åºåˆ—æº¢å‡º</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (sequence == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                //é˜»å¡åˆ°ä¸‹ä¸€ä¸ªæ¯«ç§’,è·å¾—æ–°çš„æ—¶é—´æˆ³</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                timestamp = tilNextMillis(lastTimestamp);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //æ—¶é—´æˆ³æ”¹å˜ï¼Œæ¯«ç§’å†…åºåˆ—é‡ç½®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sequence = 0L;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //ä¸Šæ¬¡ç”ŸæˆIDçš„æ—¶é—´æˆª</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lastTimestamp = timestamp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //ç§»ä½å¹¶é€šè¿‡æˆ–è¿ç®—æ‹¼åˆ°ä¸€èµ·ç»„æˆ64ä½çš„ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ((timestamp - twepoch) &lt;&lt; timestampLeftShift) //</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                | (datacenterId &lt;&lt; datacenterIdShift) //</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                | (workerId &lt;&lt; workerIdShift) //</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                | sequence;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * é˜»å¡åˆ°ä¸‹ä¸€ä¸ªæ¯«ç§’ï¼Œç›´åˆ°è·å¾—æ–°çš„æ—¶é—´æˆ³</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param lastTimestamp ä¸Šæ¬¡ç”ŸæˆIDçš„æ—¶é—´æˆª</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return å½“å‰æ—¶é—´æˆ³</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected long tilNextMillis(long lastTimestamp) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        long timestamp = timeGen();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (timestamp &lt;= lastTimestamp) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            timestamp = timeGen();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return timestamp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * è¿”å›ä»¥æ¯«ç§’ä¸ºå•ä½çš„å½“å‰æ—¶é—´</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return å½“å‰æ—¶é—´(æ¯«ç§’)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected long timeGen() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return System.currentTimeMillis();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æµ‹è¯•çš„ä»£ç å¦‚ä¸‹</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SnowflakeDistributeId idWorker = new SnowflakeDistributeId(0, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (int i = 0; i &lt; 1000; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        long id = idWorker.nextId();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//      System.out.println(Long.toBinaryString(id));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é›ªèŠ±ç®—æ³•æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„è®¾è®¡æ€æƒ³ï¼Œé›ªèŠ±ç®—æ³•ç”Ÿæˆçš„IDæ˜¯è¶‹åŠ¿é€’å¢ï¼Œä¸ä¾èµ–æ•°æ®åº“ç­‰ç¬¬ä¸‰æ–¹ç³»ç»Ÿï¼Œä»¥æœåŠ¡çš„æ–¹å¼éƒ¨ç½²ï¼Œç¨³å®šæ€§æ›´é«˜ï¼Œç”ŸæˆIDçš„æ€§èƒ½ä¹Ÿæ˜¯éå¸¸é«˜çš„ï¼Œè€Œä¸”å¯ä»¥æ ¹æ®è‡ªèº«ä¸šåŠ¡ç‰¹æ€§åˆ†é…bitä½ï¼Œéå¸¸çµæ´»ã€‚</p>
<p>ä½†æ˜¯é›ªèŠ±ç®—æ³•å¼ºä¾èµ–æœºå™¨æ—¶é’Ÿï¼Œå¦‚æœæœºå™¨ä¸Šæ—¶é’Ÿå›æ‹¨ï¼Œä¼šå¯¼è‡´å‘å·é‡å¤æˆ–è€…æœåŠ¡ä¼šå¤„äºä¸å¯ç”¨çŠ¶æ€ã€‚å¦‚æœæ°å·§å›é€€å‰ç”Ÿæˆè¿‡ä¸€äº›IDï¼Œè€Œæ—¶é—´å›é€€åï¼Œç”Ÿæˆçš„IDå°±æœ‰å¯èƒ½é‡å¤ã€‚å®˜æ–¹å¯¹äºæ­¤å¹¶æ²¡æœ‰ç»™å‡ºè§£å†³æ–¹æ¡ˆï¼Œè€Œæ˜¯ç®€å•çš„æŠ›é”™å¤„ç†ï¼Œè¿™æ ·ä¼šé€ æˆåœ¨æ—¶é—´è¢«è¿½å›ä¹‹å‰çš„è¿™æ®µæ—¶é—´æœåŠ¡ä¸å¯ç”¨ã€‚</p>
<p>å¾ˆå¤šå…¶ä»–ç±»é›ªèŠ±ç®—æ³•ä¹Ÿæ˜¯åœ¨æ­¤æ€æƒ³ä¸Šçš„è®¾è®¡ç„¶åæ”¹è¿›è§„é¿å®ƒçš„ç¼ºé™·ï¼Œ<code>ç™¾åº¦ UidGenerator</code> å’Œ <code>ç¾å›¢åˆ†å¸ƒå¼IDç”Ÿæˆç³»ç»Ÿ Leaf</code>ç­‰ç®—æ³•ä¸­snowflakeæ¨¡å¼éƒ½æ˜¯åœ¨ snowflake çš„åŸºç¡€ä¸Šæ¼”è¿›å‡ºæ¥çš„ã€‚</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.dev/mhuahe/mhuahe.com/blob/master-ts/docs/java/JAVA-Encryption.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>ç¼–è¾‘æ­¤é¡µ</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">æœ€å<!-- -->ç”± <b>mhuahe</b> <!-- -->äº <b><time datetime="2024-10-22T01:31:54.000Z" itemprop="dateModified">2024å¹´10æœˆ22æ—¥</time></b> <!-- -->æ›´æ–°</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="æ–‡ä»¶é€‰é¡¹å¡"><a class="pagination-nav__link pagination-nav__link--prev" href="/mhuahe.com/docs/java/JAVA-Elaticsearch"><div class="pagination-nav__sublabel">ä¸Šä¸€é¡µ</div><div class="pagination-nav__label">JAVA-ES</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/mhuahe.com/docs/java/JAVA-Error-Record"><div class="pagination-nav__sublabel">ä¸‹ä¸€é¡µ</div><div class="pagination-nav__label">JAVA-é”™è¯¯è®°å½•</div></a></nav><div id="disqus_thread"></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#åˆ«ç”¨md5åŠ å¯†å¯†ç äº†" class="table-of-contents__link toc-highlight">åˆ«ç”¨MD5åŠ å¯†å¯†ç äº†</a></li><li><a href="#md5" class="table-of-contents__link toc-highlight">MD5</a></li><li><a href="#des" class="table-of-contents__link toc-highlight">DES</a></li><li><a href="#rsa" class="table-of-contents__link toc-highlight">RSA</a></li><li><a href="#idea" class="table-of-contents__link toc-highlight">IDEA</a></li><li><a href="#dsa" class="table-of-contents__link toc-highlight">DSA</a></li><li><a href="#aes" class="table-of-contents__link toc-highlight">AES</a></li><li><a href="#elgamal" class="table-of-contents__link toc-highlight">Elgamal</a></li><li><a href="#base64" class="table-of-contents__link toc-highlight">Base64</a></li><li><a href="#sha" class="table-of-contents__link toc-highlight">SHA</a></li><li><a href="#pkcs" class="table-of-contents__link toc-highlight">PKCS</a></li><li><a href="#ecdsa" class="table-of-contents__link toc-highlight">ECDSA</a></li><li><a href="#dh" class="table-of-contents__link toc-highlight">DH</a></li><li><a href="#pbe" class="table-of-contents__link toc-highlight">PBE</a></li><li><a href="#mac" class="table-of-contents__link toc-highlight">MAC</a></li><li><a href="#å“ˆå¸Œç®—æ³•" class="table-of-contents__link toc-highlight">å“ˆå¸Œç®—æ³•</a></li><li><a href="#ç§é’¥å…¬é’¥ç­¾è¯åŠ å¯†" class="table-of-contents__link toc-highlight">ç§é’¥å…¬é’¥ç­¾è¯åŠ å¯†</a></li><li><a href="#é›ªèŠ±ç®—æ³•" class="table-of-contents__link toc-highlight">é›ªèŠ±ç®—æ³•</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Â© 2024 mhuahe. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>
<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-java/JAVA" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">JAVA | 贺敏华的官方网站</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mhuahe.github.io/mhuahe.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://mhuahe.github.io/mhuahe.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://mhuahe.github.io/mhuahe.com/docs/java/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="JAVA | 贺敏华的官方网站"><meta data-rh="true" name="description" content="新闻"><meta data-rh="true" property="og:description" content="新闻"><link data-rh="true" rel="icon" href="/mhuahe.com/img/mhuahe.ico"><link data-rh="true" rel="canonical" href="https://mhuahe.github.io/mhuahe.com/docs/java/"><link data-rh="true" rel="alternate" href="https://mhuahe.github.io/mhuahe.com/docs/java/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://mhuahe.github.io/mhuahe.com/docs/java/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/mhuahe.com/blog/rss.xml" title="贺敏华的官方网站 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/mhuahe.com/blog/atom.xml" title="贺敏华的官方网站 Atom Feed"><link rel="stylesheet" href="/mhuahe.com/assets/css/styles.4f8735f7.css">
<script src="/mhuahe.com/assets/js/runtime~main.94461117.js" defer="defer"></script>
<script src="/mhuahe.com/assets/js/main.f01eb177.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mhuahe.com/"><div class="navbar__logo"><img src="/mhuahe.com/img/mhuahe.svg" alt="mhuahe site logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/mhuahe.com/img/mhuahe.svg" alt="mhuahe site logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">贺敏华的官方网站</b></a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/example/EXAMPLE-Video">示例</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/mhuahe.com/docs/java/">Java</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/web/">前端</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/c/">C语言</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/linux/">Linux</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/mysql/">MySQL</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/python/">Python</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/tool/">工具</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/project/">项目</a><a class="navbar__item navbar__link" href="/mhuahe.com/docs/other/OTHER-Examination">其他</a><a class="navbar__item navbar__link" href="/mhuahe.com/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mhuahe/mhuahe.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/mhuahe.com/docs/java/">JAVA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Algorithm">JAVA-算法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Code-Generation">JAVA-代码生成</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Data-Structure">JAVA-数据结构</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Design-Pattern">JAVA-设计模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Elaticsearch">JAVA-ES</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Encryption">JAVA-加密方式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Error-Record">JAVA-错误记录</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Hutool">JAVA-HuTool工具</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-JDK-Version">JAVA-JDK版本</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-JVM">JAVA-JVM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Knowledge-Question">JAVA-知识题</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-MQ">JAVA-消息队列</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Maven-Dependent">JAVA-Maven依赖</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Maven">JAVA-Maven</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-MongoDB">JAVA-MongoDB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-MybatisPlus">JAVA-MybatisPlus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-OAuth2-SourceCode">JAVA-oauth2源码解读</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-SQL-Interceptor">JAVA-SQL拦截器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Servlet">JAVA-Servlet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-SpringBoot-Stack">JAVA-SpringBoot技术栈</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-SpringBoot-Version">JAVA-SpringBoot版本</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-SpringCloud-Stack">JAVA-SpringCloud技术栈</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-Thread">JAVA-多线程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/java/JAVA-WebSocket">JAVA-WebSocket</a></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/mhuahe.com/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">JAVA</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>JAVA</h1></header>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="新闻">新闻<a href="#新闻" class="hash-link" aria-label="新闻的直接链接" title="新闻的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="移除netflix">移除Netflix<a href="#移除netflix" class="hash-link" aria-label="移除Netflix的直接链接" title="移除Netflix的直接链接">​</a></h4>
<p>Netflix的产品组件链</p>
<blockquote>
<p>Netflix公司是目前微服务落地中最成功的公司。它开源了诸如Eureka、Hystrix、Zuul、Feign、Ribbon等等广大开发者所知微服务套件，统称为Netflix OSS</p>
</blockquote>
<p>移除的原因</p>
<blockquote>
<p>2018 年前后Netflix公司宣布其核心组件Hystrix、Ribbon、Zuul、Eureka等进入维护状态，不再进行新特性开发，只修 BUG
这直接影响了Spring Cloud项目的发展路线，在 2019 年的在 SpringOne 2019 大会中，Spring Cloud宣布 Spring Cloud Netflix 项目进入维护模式，并在 2020 年移除相关的Netflix OSS组件</p>
</blockquote>
<p>被移除的组件</p>
<blockquote>
<p>ribbon、hystrix 和 zuul从Spring Cloud 2020.0正式版发布后将不再被Spring Cloud支持。
在目前最新的Spring Cloud 2020.0中仅仅剩下了Eureka。但是留给Eureka的时间也不多了。
Feign虽然是Netflix公司开源的，但从 9.x 版本开始就移交给OpenFeign组织管理，不从属于Netflix OSS范畴。</p>
</blockquote>
<p>替换方案</p>
<ul>
<li>微软的Spring Cloud Azure</li>
<li>阿里的Spring Cloud Alibaba</li>
<li>亚马逊的Spring Cloud for Amazon Web Services</li>
<li>谷歌云平台的 Spring Cloud GCP</li>
</ul>
<p>springcloud服务</p>
<ul>
<li>nacos阿里注册中心：官方eureka停止更新，目前比较好的取代者。</li>
<li>zipkin跟踪服务：分布式跟踪日志,基于内存存储记录。</li>
<li>gateway网关路由服务：分发请求，统一管理过滤，结合LoadBalancer负载均衡、feign服务调用。</li>
<li>springboot-admin监控中心服务：统一界面管理，查看各个服务运行状态actuator健康检查。</li>
<li>sentinel高可 用流量管理框架： 以流量为切入点，限流、流量整形、熔断降级、系统负载保护、热点防护。</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="移除oauth2">移除oauth2<a href="#移除oauth2" class="hash-link" aria-label="移除oauth2的直接链接" title="移除oauth2的直接链接">​</a></h4>
<p>停止版本</p>
<blockquote>
<p>旧的Spring Security OAuth项目终止到2.5.2.RELEASE版本</p>
</blockquote>
<p>暂时的迁移方案</p>
<ul>
<li>
<p>迁移Security 5.7.x</p>
<blockquote>
<p>Spring Security 5中集成了OAuth2 Client和Resource Server两个模块</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>集成OAuth2 Client依赖(OAuth2 Client依赖于Spring Security)</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;artifactId&gt;spring-boot-starter-oauth2-client&lt;/artifactId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>集成Resource Server依赖(Resource Server依赖于Spring Security)</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;artifactId&gt;spring-boot-starter-oauth2-resource-server&lt;/artifactId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>集成OAuth2授权服务器依赖</p>
<blockquote>
<p>目前Spring生态中的OAuth2授权服务器是Spring Authorization Server，目前已具备生产就绪能力。最新的0.3.0版本中，官方文档正式在spring.io上线，它必须在Java 11及以上版本才能使用。它也作为一个Spring Security子模块，不能单独使用</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;artifactId&gt;spring-security-oauth2-authorization-server&lt;/artifactId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;version&gt;0.3.0&lt;/version&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependency&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="servlet">servlet<a href="#servlet" class="hash-link" aria-label="servlet的直接链接" title="servlet的直接链接">​</a></h4>
<p>在 Servlet 3.1 规范之前的版本，请求是只能被 Servlet 同步阻塞处理完成，返回结果给前端。</p>
<p>在 Servlet 3.1 规范开始的版本，请求是允许被 Servlet 丢到线程池中处执行，等到执行完毕，异步回调结果给 Servlet ，最后返回给前端。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="glib">GLIB<a href="#glib" class="hash-link" aria-label="GLIB的直接链接" title="GLIB的直接链接">​</a></h4>
<p>CGLIB已经不维护了，建议使用ByteBuddy。</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="基础知识点">基础知识点<a href="#基础知识点" class="hash-link" aria-label="基础知识点的直接链接" title="基础知识点的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="多态">多态<a href="#多态" class="hash-link" aria-label="多态的直接链接" title="多态的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 强转</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">只有我们的父类对象本身就是用子类new出来的时候</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> 才可以在将来被强制转换为子类对象。也就是说父类类型对象引用实际上指向的是子类对象，这种情况下才能将父类类型对象的引用强转为子类类型对象的引用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Animal animal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> new Dog</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dog dog </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Dog</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> animal</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">animal instanof Dog</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dog dog </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Dog</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> animal</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><span class="token keyword" style="color:#00009f">else</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Animal animal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> animal</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="时间">时间<a href="#时间" class="hash-link" aria-label="时间的直接链接" title="时间的直接链接">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 将2021-08-29T09:02:25.000Z --&gt; 2021-08-29 17:02:25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @param timeStr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static String interceptTime(String timeStr) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!StringUtils.isEmpty(timeStr)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (timeStr.contains(&quot;T&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SimpleDateFormat simpleDateFormat = new SimpleDateFormat(&quot;yyyy-MM-dd&#x27;T&#x27;HH:mm:ss.SSSXXX&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;).format(simpleDateFormat.parse(timeStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } catch (ParseException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return timeStr;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//ISO 8601 &quot;yyyy-MM-dd&#x27;T&#x27;HH:mm:ss.SSSXXX&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- LocalDateTime 转 LocalDate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDateTime localDateTime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> LocalDateTime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate localDate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> localDateTime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toLocalDate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- LocalDate 转 Date</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate localDate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> LocalDate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ZoneId zoneId </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ZoneId</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">systemDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">Date</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">date</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Date</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">localDate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">atStartOfDay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">atZone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">zoneId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toInstant</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 获取当前日期</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate today </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> LocalDate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 获取今年的天数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> daysInYear </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> today</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lengthOfYear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 判断今年是不是闰年</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> isLeapYear </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> today</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isLeapYear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 计算相差天数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ChronoUnit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DAYS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">between</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buyDate</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> settlementDateEndDay</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 大于小于</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isAfter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LocalDate localDate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isBefore</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LocalDate localDate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 时间计算</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalDate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">minus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="集合">集合<a href="#集合" class="hash-link" aria-label="集合的直接链接" title="集合的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="list">List<a href="#list" class="hash-link" aria-label="List的直接链接" title="List的直接链接">​</a></h5>
<blockquote>
<p>List实现类</p>
</blockquote>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">1.</span><span class="token plain">ArrayList 底层数组，插入是什么顺序，取出就是什么顺序，注意如果按索引插入，如插入</span><span class="token number" style="color:#36acaa">3</span><span class="token plain">处，则本来的</span><span class="token number" style="color:#36acaa">3</span><span class="token plain">及后面的都会后移一位索引</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2.</span><span class="token plain">Vector 同ArrayList，是ArrayList的安全集合</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3.</span><span class="token plain">LinkedList 底层链表</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="set">Set<a href="#set" class="hash-link" aria-label="Set的直接链接" title="Set的直接链接">​</a></h5>
<blockquote>
<p>Set实现类</p>
</blockquote>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1.HashSet 底层哈希表，先判断hashCode()值是否相等，不相等则直接添加，若相等则再判断equals()是否相等，结果为TRUE说明元素重复不添加，FALSE则添加</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2.LinkedHashSet 底层链表和哈希表，链表保证有序，哈希表保证唯一</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3.TreeSet 底层红黑树，唯一，有序。可实现Comparable进行元素自然排序。集合接收Comparator实现类对象进行集合比较器排序</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="map">Map<a href="#map" class="hash-link" aria-label="Map的直接链接" title="Map的直接链接">​</a></h5>
<blockquote>
<p>[!tip]</p>
<p>在需要获取value情况下，<code>entrySet</code>遍历比<code>keySet</code>更高效。减少了查找的次数并提高了代码的整体效率</p>
</blockquote>
<blockquote>
<p>Map实现类</p>
</blockquote>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">1.</span><span class="token plain">HashMap 底层哈希表</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2.</span><span class="token plain">LinkedHashMap 底层链表和哈希表，链表保证有序，哈希表保证元素唯一</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3.</span><span class="token plain">Hashtable 底层哈希表，线程安全</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4.</span><span class="token plain">TreeMap 底层红黑树，唯一，有序。可实现Comparable进行元素自然排序。集合接收Comparator实现类对象进行集合比较器排序</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Map，key倒序</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;String, IndustryBondHeadVO.StockStatisticalChartVO&gt; map = new TreeMap&lt;&gt;(Comparator.reverseOrder());</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>在迭代一个集合（如 Map）时，如果尝试修改该集合，可能会抛出 ConcurrentModificationException 异常。要避免这种情况，可以使用 Iterator 的 remove 方法，而不是直接修改集合。</p>
<p>确保所有修改操作都在迭代器内部进行，而不是在迭代器外部直接修改 Map</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;String, String&gt; map = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">map.put(&quot;key1&quot;, &quot;value1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">map.put(&quot;key2&quot;, &quot;value2&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Iterator&lt;Map.Entry&lt;String, String&gt;&gt; iterator = map.entrySet().iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">while (iterator.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Map.Entry&lt;String, String&gt; entry = iterator.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (entry.getKey().equals(&quot;key1&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        iterator.remove(); // 正确的移除方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>如果需要在多线程环境下并发修改 Map，可以使用 <code>ConcurrentHashMap</code>，它允许并发的修改和迭代。</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;String, String&gt; map = new ConcurrentHashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">map.put(&quot;key1&quot;, &quot;value1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">map.put(&quot;key2&quot;, &quot;value2&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for (Map.Entry&lt;String, String&gt; entry : map.entrySet()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (entry.getKey().equals(&quot;key1&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        map.remove(entry.getKey()); // 并发安全的移除方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>在增强 for 循环中修改 Map 会导致 <code>ConcurrentModificationException</code>。应使用显式迭代器来避免这个问题。</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;String, String&gt; map = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">map.put(&quot;key1&quot;, &quot;value1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">map.put(&quot;key2&quot;, &quot;value2&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for (Iterator&lt;Map.Entry&lt;String, String&gt;&gt; it = map.entrySet().iterator(); it.hasNext(); ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Map.Entry&lt;String, String&gt; entry = it.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (entry.getKey().equals(&quot;key1&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        it.remove(); // 正确的移除方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="集合api">集合API<a href="#集合api" class="hash-link" aria-label="集合API的直接链接" title="集合API的直接链接">​</a></h5>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 数组排序</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">?</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 从整个数组中查询指定值的索引(需要排序)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">binarySearch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Object</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">Object </span><span class="token keyword" style="color:#00009f">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 数组</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a数组赋值给b数组</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">a数组后续改变</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">b数组也会改变</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 数组转成字符串输出</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 获取集合的最大值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Collections</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">List</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 判断是否在数组中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> strList </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> {</span><span class="token string" style="color:#e3116c">&quot;AB&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AC&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AD&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AE&quot;</span><span class="token plain">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">contains</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">asList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">strList</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">contains</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;A&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- String[] --&gt; Integer[]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> intArray </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Convert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toIntArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">new String</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> intArray </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ConvertUtils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">convert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">customerId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Integer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 将逗号分隔的字符串转换为List</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">asList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">asList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">StringUtils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 将list转化为逗号分割的字符串</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> list</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> StringUtils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">list</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- int数组转集合(steam的装箱boxed()方法)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">Integer</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> collect </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">boxed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">collect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Collectors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="bigdecimal">BigDecimal<a href="#bigdecimal" class="hash-link" aria-label="BigDecimal的直接链接" title="BigDecimal的直接链接">​</a></h4>
<table><thead><tr><th style="text-align:left">字段</th><th style="text-align:left">字段详情</th></tr></thead><tbody><tr><td style="text-align:left">ROUND_UP</td><td style="text-align:left">截断的小数&gt;0时进一位</td></tr><tr><td style="text-align:left">ROUND_DOWN</td><td style="text-align:left">直接舍弃截断的小数,不在小数位上 进一位,不管舍弃的数值有多大</td></tr><tr><td style="text-align:left">ROUND_HALF_UP</td><td style="text-align:left">四舍五入</td></tr><tr><td style="text-align:left">ROUND_HALF_DOWN</td><td style="text-align:left">当截取掉的小数位的值&gt;=5,且5后面还有&gt;0的值,就会进一位</td></tr><tr><td style="text-align:left">ROUND_CEILING</td><td style="text-align:left">向正无限大方向舍入</td></tr><tr><td style="text-align:left">ROUND_FLOOR</td><td style="text-align:left">向负无限大方向舍入</td></tr><tr><td style="text-align:left">ROUND_HALF_EVEN</td><td style="text-align:left">如果舍弃部分左边的数字为奇数，则舍入行为同 HALF_UP；如果为偶数，则舍入行为同HALF_DOWN</td></tr><tr><td style="text-align:left">ROUND_UNNECESSARY</td><td style="text-align:left">计算结果是精确的，不需要舍入，否则抛出 ArithmeticException。</td></tr></tbody></table>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="函数式接口">函数式接口<a href="#函数式接口" class="hash-link" aria-label="函数式接口的直接链接" title="函数式接口的直接链接">​</a></h4>
<blockquote>
<p>使用注解 <code>@FunctionalInterface</code> 标识，并且只包含一个抽象方法的接口是函数式接口。</p>
</blockquote>
<ul>
<li>Supplier：供给型函数，无参有返回。</li>
<li>Consumer：消费型函数，接收一个参数，无返回。</li>
<li>Runnable：无参无返回。</li>
<li>Function：接收一个参数，并返回一个值。</li>
</ul>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="lambda">lambda<a href="#lambda" class="hash-link" aria-label="lambda的直接链接" title="lambda的直接链接">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//无参</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Supplier&lt;ElfWeapon&gt; elfWeaponSupplier = ElfWeapon::new;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//等价于</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Supplier&lt;ElfWeapon&gt; elfWeaponSupplier = () -&gt; new ElfWeapon();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//等价于</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Supplier&lt;ElfWeapon&gt; elfWeaponSupplier = new Supplier&lt;Weapon&gt;() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Weapon get() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new ElfWeapon();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//有参</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function&lt;String, ElfWeapon&gt; elfWeaponFunction = ElfWeapon::new;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//等价于</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function&lt;String, ElfWeapon&gt; elfWeaponFunction = type -&gt; new ElfWeapon(type);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//等价于</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function&lt;String, Weapon&gt; elfWeaponFunction = new Function&lt;String, Weapon&gt;() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Weapon apply(String type) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new ElfWeapon(type);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="代码规范">代码规范<a href="#代码规范" class="hash-link" aria-label="代码规范的直接链接" title="代码规范的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- MVC分层可以分四层</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">controller 层</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service 层</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">manager 层</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dao 层</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">--  @Transactional 事务注解</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1.</span><span class="token variable" style="color:#36acaa">@Transactional</span><span class="token plain"> 注解内的 rollbackFor 值必须使用异常 Exception</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">class</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2.</span><span class="token plain">spring 遇到该注解时，会自动从数据库连接池中获取 connection，并开启事务然后绑定到 ThreadLocal 上，如果业务并没有进入到最终的操作数据库环节，那么就没有必要获取连接并开启事务，应该直接将 connection 返回给数据库连接池，供其他使用。即将增删改操作的业务代码提取到mananger进行注解。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">注：</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">注解 </span><span class="token variable" style="color:#36acaa">@Transactional</span><span class="token plain"> 事务在类的内部方法调用是不会生效的</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Spring 采用动态代理</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AOP</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">实现对 bean 的管理和切片，它为我们的每个 class 生成一个代理对象。只有在代理对象之间进行调用时，可以触发切面逻辑。而在同一个 class 中，方法 A 调用方法 B，调用的是原对象的方法，而不通过代理对象。所以 Spring 无法拦截到这次调用，也就无法通过注解保证事务了。简单来说，在同一个类中的方法调用，不会被方法拦截器拦截到，因此事务不会起作用。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解决方案：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">、可以将方法放入另一个类，如新增 manager层，通过 spring 注入，这样符合了在对象之间调用的条件。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2</span><span class="token plain">、启动类添加</span><span class="token variable" style="color:#36acaa">@EnableAspectJAutoProxy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exposeProxy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">，方法内使用AopContext</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">currentProxy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">获得代理类，使用事务。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- controller 每个方法要保持简洁</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">controller 在mvc中负责协同和委派业务，充当路由的角色，所以要保持代码少量和清晰，要做到如下要求：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">不做任何的业务逻辑操作</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 不做任何的参数、业务校验，参数校验只允许使用</span><span class="token variable" style="color:#36acaa">@Valid</span><span class="token plain"> 注解做简单的校验</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">不做任何的数据组合、拼装、赋值等操作</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 只能在controller层获取当前请求用户</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">只能在controller层获取当前请求用户，并传递给service层。因为获取当前请求用户是从ThreadLocal里获取取的，在service、manager、dao层极有可能是其他非request线程调用，会出现</span><span class="token boolean" style="color:#36acaa">null</span><span class="token plain">的情况，尽量避免</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 使用mybatis-plus的要求</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">、所有 Dao 继承自 BaseMapper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2</span><span class="token plain">、禁止使用 Mybatis</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">plus 的 Wrapper 条件构建器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3</span><span class="token plain">、禁止直接在 mybatis xml 中写死常量，应从 dao 中传入到 xml 中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4</span><span class="token plain">、建议在xml中的 </span><span class="token keyword" style="color:#00009f">join</span><span class="token plain"> 关联写法使用表名的全称，而不是用别名，对于关联表太多的话，在xml格式中，其实很难记住别名是什么意思</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- javabean 名字划分</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XxxEntity 数据库持久对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XxxVO 返回前端对象 （一些大厂用 Resp结尾，比如 XxxxResp）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XxxForm 前端请求对象 （一些大厂用 Req结尾，比如 XxxxReq）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XxxDTO 数据传输对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XxxBO 内部处理对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">都不可以继承自 Entity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- boolean 类型的属性命名规范</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">类中布尔类型的变量，都不要加 </span><span class="token operator" style="color:#393A34">is</span><span class="token plain">，否则部分框架解析会引起序列化错误。反例：定义为基本数据类型 </span><span class="token keyword" style="color:#00009f">Boolean</span><span class="token plain"> isDeleted；的属性，它的方法也是 isDeleted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">，RPC 在反向解析的时候，“以为”对应的属性名称是 deleted，导致属性获取不到，进而抛出异常。</span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> 类型的类属性和数据表字段都统一使用 flag 结尾。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 建表规范</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">表必备三字段：id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> create_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> update_time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">id 字段 Long 类型，单表自增，自增长度为 </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create_time 字段 </span><span class="token keyword" style="color:#00009f">datetime</span><span class="token plain"> 类型，默认值 </span><span class="token keyword" style="color:#00009f">CURRENT_TIMESTAMP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update_time 字段 </span><span class="token keyword" style="color:#00009f">datetime</span><span class="token plain"> 类型，默认值 </span><span class="token keyword" style="color:#00009f">CURRENT_TIMESTAMP</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">On</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">update</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CURRENT_TIMESTAMP</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="active配置">active配置<a href="#active配置" class="hash-link" aria-label="active配置的直接链接" title="active配置的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 可查看类Environment加载的配置详情</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- spring.profiles.active属性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">profiles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">active</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dev：启用application</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">dev</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">properties</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">profiles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">active</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">test：启用application</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">properties</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">profiles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">active</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">prod：启用application</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">prod</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">properties</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 启动时指定(优先级最高)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">jar xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">jar </span><span class="token comment" style="color:#999988;font-style:italic">--spring.profiles.active=prod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- spring.profiles.include属性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 配置方法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">若是properties文件：spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">profiles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">include</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dev1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">dev2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">若是yaml文件中，</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">profiles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">include:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">dev1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">dev2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">或者：spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">profiles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">include:dev1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">dev2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 配置位置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">方式一：application</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">properties中，配置spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">profiles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">active</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dev的同时指定spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">profiles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">include</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dev1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">dev2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">方式二：application</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">properties中，配置spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">profiles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">active</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dev，application</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">dev</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">properties中，配置spring</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">profiles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">include</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dev1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">dev2。使用application</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">dev</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">properties时自动就激活了dev1、dev2两个文件，不用再次指定。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 区别</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">第一种方式启动时，控制台打印The </span><span class="token keyword" style="color:#00009f">following</span><span class="token plain"> profiles are active:dev1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">dev2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">第二种方式启动时，控制台打印The </span><span class="token keyword" style="color:#00009f">following</span><span class="token plain"> profiles are active:dev</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dev1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">dev2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">按照顺序，后面的覆盖前面的。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="jsqlparser">JSqlParser<a href="#jsqlparser" class="hash-link" aria-label="JSqlParser的直接链接" title="JSqlParser的直接链接">​</a></h3>
<blockquote>
<p>依赖了JSqlParser</p>
<ul>
<li>mybatis-plus-boot-starter</li>
<li>pagehelper</li>
</ul>
</blockquote>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.github.jsqlparser</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">jsqlparser</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">4.6</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- JSqlParser是一个与RDBMS（关系数据库管理系统）无关的SQL语句解析器。它将SQL语句转换为可遍历的Java类次结构</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 原SQL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> dual </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 转换</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statement statement </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> CCJSqlParserUtil</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sqlStr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 转换后结构</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SQL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Text</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  └─Statements: net</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">jsqlparser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">statement</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">select</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">Select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     └─selectBody: net</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">jsqlparser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">statement</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">select</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PlainSelect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ├─selectItems </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Collection</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">SelectExpressionItem</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        │  └─selectItems: net</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">jsqlparser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">statement</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">select</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SelectExpressionItem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        │     └─LongValue: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ├─</span><span class="token keyword" style="color:#00009f">Table</span><span class="token plain">: dual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        └─</span><span class="token keyword" style="color:#00009f">where</span><span class="token plain">: net</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">jsqlparser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">expression</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">operators</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">relational</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EqualsTo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ├─</span><span class="token keyword" style="color:#00009f">Column</span><span class="token plain">: a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           └─</span><span class="token keyword" style="color:#00009f">Column</span><span class="token plain">: b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 转换后简单使用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statement statement </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> CCJSqlParserUtil</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sqlStr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">statement instanceof </span><span class="token keyword" style="color:#00009f">Select</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">Select</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">Select</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> statement</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PlainSelect plainSelect </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PlainSelect</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">select</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getSelectBody</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SelectExpressionItem selectExpressionItem </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SelectExpressionItem</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> plainSelect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getSelectItems</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">Table</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">Table</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> plainSelect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getFromItem</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    EqualsTo equalsTo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">EqualsTo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> plainSelect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getWhere</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">Column</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">Column</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> equalsTo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getLeftExpression</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">Column</span><span class="token plain"> b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">Column</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> equalsTo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getRightExpression</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="io">IO<a href="#io" class="hash-link" aria-label="IO的直接链接" title="IO的直接链接">​</a></h3>
<blockquote>
<p>[!tip]</p>
<p>Windows平台使用<code>\</code>作为路径分隔符，在Java字符串中需要用<code>\\</code>  表示一个<code>\</code>。Linux平台使用<code>/</code>作为路径分隔符：</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="file">File<a href="#file" class="hash-link" aria-label="File的直接链接" title="File的直接链接">​</a></h4>
<blockquote>
<p><code>File</code>对象既可以表示文件，也可以表示目录。特别要注意的是，构造一个<code>File</code>对象，即使传入的文件或目录不存在，代码也不会出错，因为构造一个<code>File</code>对象，并不会导致任何磁盘操作。只有当我们调用<code>File</code>对象的某些方法的时候，才真正进行磁盘操作。</p>
</blockquote>
<p>文件和目录</p>
<ul>
<li>isFile()：判断该<code>File</code>对象是否是一个已存在的文件；</li>
<li>isDirectory()：判断该<code>File</code>对象是否是一个已存在的目录；</li>
<li>boolean canRead()：是否可读；</li>
<li>boolean canWrite()：是否可写；</li>
<li>boolean canExecute()：是否可执行；对目录，表示能否列出它包含的文件和子目录。</li>
<li>long length()：文件字节大小；</li>
</ul>
<p>创建和删除文件</p>
<ul>
<li>createNewFile()：如果不存在，则创建一个新文件；</li>
<li>delete()：删除该文件；</li>
<li>createTempFile()：静态方法，创建一个临时文件；</li>
<li>deleteOnExit()：JVM退出时自动删除该文件；</li>
</ul>
<p>遍历文件和目录</p>
<ul>
<li>list() ：列出目录下的文件名和子目录名;</li>
<li>listFiles()：列出目录下的文件和目录，提供了一系列重载方法，可以过滤不想要的文件和目录；</li>
<li>boolean mkdir()：创建当前File对象表示的目录；</li>
<li>boolean mkdirs()：创建当前File对象表示的目录，并在必要时将不存在的父目录也创建出来；</li>
<li>boolean delete()：删除当前File对象表示的目录，当前目录必须为空才能删除成功；</li>
</ul>
<p>Path</p>
<blockquote>
<p>Java标准库还提供了一个<code>Path</code>对象，它位于<code>java.nio.file</code>包。<code>Path</code>对象和<code>File</code>对象类似，但操作更加简单：</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public static void main(String[] args) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 构造一个Path对象，即拼接路径./project/study</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Path p1 = Paths.get(&quot;D:\\hayes\\db-code&quot;, &quot;sdzx&quot;, &quot;sdzx-240611&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(p1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Path p2 = p1.toAbsolutePath(); // 转换为绝对路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(p2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Path p3 = p2.normalize(); // 转换为规范路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(p3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    File f = p3.toFile(); // 转换为File对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(f);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (Path p : p1.toAbsolutePath()) { // 可以直接遍历Path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;  &quot; + p);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="inputstream">InputStream<a href="#inputstream" class="hash-link" aria-label="InputStream的直接链接" title="InputStream的直接链接">​</a></h4>
<blockquote>
<p><code>InputStream</code>并不是一个接口，而是一个抽象类，它是所有输入流的超类。</p>
</blockquote>
<ul>
<li>read()：这个方法会读取输入流的下一个字节，并返回字节表示的<code>int</code>值（0~255）。如果已读到末尾，返回<code>-1</code>表示不能继续读取了。</li>
</ul>
<p>关闭流</p>
<blockquote>
<p>用<code>try ... finally</code>来编写会感觉比较复杂，更好的写法是利用Java 7引入的新的<code>try(resource)</code>的语法，只需要编写<code>try</code>语句，让编译器自动为我们关闭资源。</p>
<p>实际编译器并不会特别地为<code>InputStream</code>加上自动关闭。编译器只看<code>try(resource = ...)</code>中的对象是否实现了<code>java.lang.AutoCloseable</code>接口，如果实现了，就自动加上<code>finally</code>语句并调用<code>close()</code>方法。<code>InputStream</code>和<code>OutputStream</code>都实现了这个接口，因此，都可以用在<code>try(resource)</code>中。</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void readFile() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try (InputStream input = new FileInputStream(&quot;src/readme.txt&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int n;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while ((n = input.read()) != -1) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(n);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } // 编译器在此自动为我们写入finally并调用close()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>缓冲</p>
<blockquote>
<p>在读取流的时候，一次读取一个字节并不是最高效的方法。很多流支持一次性读取多个字节到缓冲区，对于文件和网络流来说，利用缓冲区一次性读取多个字节效率往往要高很多。</p>
</blockquote>
<ul>
<li><code>int read(byte[] b)</code>：读取若干字节并填充到<code>byte[]</code>数组，返回读取的字节数</li>
<li><code>int read(byte[] b, int off, int len)</code>：指定<code>byte[]</code>数组的偏移量和最大填充数</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void readFile() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try (InputStream input = new FileInputStream(&quot;src/readme.txt&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 定义1000个字节大小的缓冲区:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] buffer = new byte[2048];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int n;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while ((n = input.read(buffer)) != -1) { // 读取到缓冲区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;read &quot; + n + &quot; bytes.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="outputstream">OutputStream<a href="#outputstream" class="hash-link" aria-label="OutputStream的直接链接" title="OutputStream的直接链接">​</a></h4>
<blockquote>
<p>和<code>InputStream</code>类似，<code>OutputStream</code>也是抽象类，它是所有输出流的超类。</p>
</blockquote>
<ul>
<li>write()：这个方法会写入一个字节到输出流。虽然传入的是<code>int</code>参数，但只会写入一个字节，即只写入<code>int</code>最低8位表示字节的部分（相当于<code>b &amp; 0xff</code>）。</li>
</ul>
<p>关闭流</p>
<blockquote>
<p>和<code>InputStream</code>类似，<code>OutputStream</code>也提供了<code>close()</code>方法关闭输出流，以便释放系统资源。</p>
<p>注意：<code>OutputStream</code>还提供了一个<code>flush()</code>方法，它的目的是将缓冲区的内容真正输出到目的地。对于很多IO设备来说，一次写一个字节和一次写1000个字节，花费的时间几乎是完全一样的，所以有个<code>flush()</code>方法，能强制把缓冲区（byte[]）内容输出。</p>
<p>通常情况下，我们不需要调用这个<code>flush()</code>方法，因为缓冲区写满了<code>OutputStream</code>会自动调用它，并且，在调用<code>close()</code>方法关闭<code>OutputStream</code>之前，也会自动调用<code>flush()</code>方法。</p>
</blockquote>
<p>缓冲</p>
<ul>
<li><code>void write(byte[])</code>：一次性写入若干字节</li>
<li><code>void write(buffer, 0, bytesRead)</code>：将缓冲区中的数据写入目标文件。<code>write</code> 方法的第一个参数是缓冲区数组，第二个参数是起始位置，第三个参数是写入的字节数。</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void writeFile() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try (OutputStream output = new FileOutputStream(&quot;out/readme.txt&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        output.write(&quot;Hello&quot;.getBytes(&quot;UTF-8&quot;)); // Hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } // 编译器在此自动为我们写入finally并调用close()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="filter模式">Filter模式<a href="#filter模式" class="hash-link" aria-label="Filter模式的直接链接" title="Filter模式的直接链接">​</a></h4>
<blockquote>
<p>通过一个“基础”组件再叠加各种“附加”功能组件的模式，称之为Filter模式（或者装饰器模式：Decorator）</p>
</blockquote>
<p>Java的IO标准库使用Filter模式为<code>InputStream</code>和<code>OutputStream</code>增加功能：</p>
<ul>
<li>可以把一个<code>InputStream</code>和任意个<code>FilterInputStream</code>组合；</li>
<li>可以把一个<code>OutputStream</code>和任意个<code>FilterOutputStream</code>组合。</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="zip">Zip<a href="#zip" class="hash-link" aria-label="Zip的直接链接" title="Zip的直接链接">​</a></h4>
<p>读取zip包</p>
<blockquote>
<p>我们要创建一个<code>ZipInputStream</code>，通常是传入一个<code>FileInputStream</code>作为数据源，然后，循环调用<code>getNextEntry()</code>，直到返回<code>null</code>，表示zip流结束。</p>
<p>一个<code>ZipEntry</code>表示一个压缩文件或目录，如果是压缩文件，我们就用<code>read()</code>方法不断读取，直到返回<code>-1</code>：</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">try (ZipInputStream zip = new ZipInputStream(new FileInputStream(...))) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ZipEntry entry = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while ((entry = zip.getNextEntry()) != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String name = entry.getName();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (!entry.isDirectory()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int n;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while ((n = zip.read()) != -1) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>写入zip包</p>
<blockquote>
<p><code>ZipOutputStream</code>是一种<code>FilterOutputStream</code>，它可以直接写入内容到zip包。我们要先创建一个<code>ZipOutputStream</code>，通常是包装一个<code>FileOutputStream</code>，然后，每写入一个文件前，先调用<code>putNextEntry()</code>，然后用<code>write()</code>写入<code>byte[]</code>数据，写入完毕后调用<code>closeEntry()</code>结束这个文件的打包。</p>
<p>下面的代码没有考虑文件的目录结构。如果要实现目录层次结构，<code>new ZipEntry(name)</code>传入的<code>name</code>要用相对路径。</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">try (ZipOutputStream zip = new ZipOutputStream(new FileOutputStream(...))) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    File[] files = ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (File file : files) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        zip.putNextEntry(new ZipEntry(file.getName()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        zip.write(Files.readAllBytes(file.toPath()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        zip.closeEntry();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<img src="https://hayes-typora.oss-cn-shenzhen.aliyuncs.com/image-20240731171256874.png" alt="image-20240731171256874" width="50%">
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="读取classpath">读取classpath<a href="#读取classpath" class="hash-link" aria-label="读取classpath的直接链接" title="读取classpath的直接链接">​</a></h4>
<blockquote>
<p>从classpath读取文件就可以避免不同环境下文件路径不一致的问题：如果我们把<code>default.properties</code>文件放到classpath中，就不用关心它的实际存放路径。</p>
<p>在classpath中的资源文件，路径总是以<code>／</code>开头，我们先获取当前的<code>Class</code>对象，然后调用<code>getResourceAsStream()</code>就可以直接从classpath读取任意的资源文件：</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">try (InputStream input = getClass().getResourceAsStream(&quot;/default.properties&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (input != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // TODO:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>如果我们把默认的配置放到jar包中，再从外部文件系统读取一个可选的配置文件，就可以做到既有默认的配置文件，又可以让用户自己修改配置：</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Properties props = new Properties();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">props.load(Files.newInputStream(Paths.get(&quot;/default.properties&quot;)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">props.load(Files.newInputStream(Paths.get(&quot;./conf.properties&quot;)));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="序列化">序列化<a href="#序列化" class="hash-link" aria-label="序列化的直接链接" title="序列化的直接链接">​</a></h4>
<blockquote>
<p>序列化是指把一个Java对象变成二进制内容，本质上就是一个<code>byte[]</code>数组。</p>
<p>为什么要把Java对象序列化呢？因为序列化后可以把<code>byte[]</code>保存到文件中，或者把<code>byte[]</code>通过网络传输到远程，这样，就相当于把Java对象存储到文件或者通过网络传输出去了。</p>
<p>有序列化，就有反序列化，即把一个二进制内容（也就是<code>byte[]</code>数组）变回Java对象。有了反序列化，保存到文件中的<code>byte[]</code>数组又可以“变回”Java对象，或者从网络上读取<code>byte[]</code>并把它“变回”Java对象。</p>
<p>一个Java对象要能序列化，必须实现一个特殊的<code>java.io.Serializable</code>接口。</p>
</blockquote>
<p>序列化</p>
<blockquote>
<p>把一个Java对象变为<code>byte[]</code>数组，需要使用<code>ObjectOutputStream</code>。它负责把一个Java对象写入一个字节流：</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ByteArrayOutputStream buffer = new ByteArrayOutputStream();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try (ObjectOutputStream output = new ObjectOutputStream(buffer)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 写入int:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    output.writeInt(12345);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 写入String:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    output.writeUTF(&quot;Hello&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 写入Object:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    output.writeObject(Double.valueOf(123.456));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(Arrays.toString(buffer.toByteArray()));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>反序列化</p>
<blockquote>
<p>和<code>ObjectOutputStream</code>相反，<code>ObjectInputStream</code>负责从一个字节流读取Java对象：</p>
<p>反序列化时，由JVM直接构造出Java对象，不调用构造方法。</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">try (ObjectInputStream input = new ObjectInputStream(...)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int n = input.readInt();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String s = input.readUTF();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Double d = (Double) input.readObject();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Java的序列化允许class定义一个特殊的<code>serialVersionUID</code>静态变量，用于标识Java类的序列化“版本”，通常可以由IDE自动生成。如果增加或修改了字段，可以改变<code>serialVersionUID</code>的值，这样就能自动阻止不匹配的class版本：</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class Person implements Serializable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final long serialVersionUID = 2709425275741743919L;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注意</p>
<ul>
<li>在 Java 中，序列化对象通常保存为 <code>.ser</code> 扩展名的文件。</li>
<li>因为Java的序列化机制可以导致一个实例能直接从<code>byte[]</code>数组创建，而不经过构造方法，因此，它存在一定的安全隐患。一个精心构造的<code>byte[]</code>数组被反序列化后可以执行特定的Java代码，从而导致严重的安全漏洞。</li>
<li>实际上，Java本身提供的基于对象的序列化和反序列化机制既存在安全性问题，也存在兼容性问题。更好的序列化方法是通过JSON这样的通用数据结构来实现，只输出基本类型（包括String）的内容，而不存储任何与代码相关的信息。</li>
<li>Java的序列化机制仅适用于Java，如果需要与其它语言交换数据，必须使用通用的序列化方法，例如JSON。</li>
<li>在序列化过程中，构造函数不会被调用。序列化是直接将对象的字段状态写入字节流，而不需要通过构造函数来创建对象。这意味着对象的构造逻辑不会参与序列  化。</li>
<li>在反序列化过程中，对象的构造函数同样不会被调用。Java 的反序列化机制通过反射创建对象实例，并直接从字节流中恢复对象的字段状态，而不经过构造函数。</li>
<li><strong>继承层次中的非可序列化父类</strong>：如果一个类实现了 <code>Serializable</code> 接口，但它的父类没有实现 <code>Serializable</code> 接口，那么在反序列化过程中，会调用该非可序列化父类的无参构造函数。如果该父类没有无参构造函数，则会抛出 <code>InvalidClassException</code>。</li>
<li><strong>自定义反序列化</strong>：如果一个类定义了 <code>private void readObject(ObjectInputStream ois) throws IOException, ClassNotFoundException</code> 方法，则可以在反序列化过程中执行自定义逻辑，包括调用构造函数或者初始化对象状态。</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="reader">Reader<a href="#reader" class="hash-link" aria-label="Reader的直接链接" title="Reader的直接链接">​</a></h4>
<blockquote>
<p><code>Reader</code>是Java的IO库提供的另一个输入流接口。和<code>InputStream</code>的区别是，<code>InputStream</code>是一个字节流，即以<code>byte</code>为单位读取，而<code>Reader</code>是一个字符流，即以<code>char</code>为单位读取。</p>
<p>如果我们读取一个纯ASCII编码的文本文件，上述代码工作是没有问题的。但如果文件中包含中文，就会出现乱码，因为<code>FileReader</code>默认的编码与系统相关。要避免乱码问题，我们需要在创建<code>FileReader</code>时指定编码。</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">try (Reader reader = new FileReader(&quot;src/readme.txt&quot;, StandardCharsets.UTF_8)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // TODO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>InputStreamReader</p>
<ul>
<li>
<p>除了特殊的<code>CharArrayReader</code>和<code>StringReader</code>，普通的<code>Reader</code>实际上是基于<code>InputStream</code>构造的，因为<code>Reader</code>需要从<code>InputStream</code>中读入字节流（<code>byte</code>），然后，根据编码设置，再转换为<code>char</code>就可以实现字符流。如果我们查看<code>FileReader</code>的源码，它在内部实际上持有一个<code>FileInputStream</code>。</p>
</li>
<li>
<p>既然<code>Reader</code>本质上是一个基于<code>InputStream</code>的<code>byte</code>到<code>char</code>的转换器，那么，如果我们已经有一个<code>InputStream</code>，想把它转换为<code>Reader</code>，是完全可行的。<code>InputStreamReader</code>就是这样一个转换器，它可以把任何<code>InputStream</code>转换为<code>Reader</code>。示例代码如下：</p>
</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 持有InputStream:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InputStream input = new FileInputStream(&quot;src/readme.txt&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 变换为Reader:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Reader reader = new InputStreamReader(input, &quot;UTF-8&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try (Reader reader = new InputStreamReader(new FileInputStream(&quot;src/readme.txt&quot;), &quot;UTF-8&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // TODO:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="writer">Writer<a href="#writer" class="hash-link" aria-label="Writer的直接链接" title="Writer的直接链接">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">try (Writer writer = new FileWriter(&quot;readme.txt&quot;, StandardCharsets.UTF_8)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    writer.write(&#x27;H&#x27;); // 写入单个字符</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    writer.write(&quot;Hello&quot;.toCharArray()); // 写入char[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    writer.write(&quot;Hello&quot;); // 写入String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>OutputStreamWriter</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">try (Writer writer = new OutputStreamWriter(new FileOutputStream(&quot;readme.txt&quot;), &quot;UTF-8&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // TODO:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p>如果你读取的是字节流文件，如pdf，图片等，使用InputStream和OutputStream；</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="printstream和printwriter">PrintStream和PrintWriter<a href="#printstream和printwriter" class="hash-link" aria-label="PrintStream和PrintWriter的直接链接" title="PrintStream和PrintWriter的  直接链接">​</a></h4>
<blockquote>
<p><code>PrintStream</code>是一种<code>FilterOutputStream</code>，它在<code>OutputStream</code>的接口上，额外提供了一些写入各种数据类型的方法：</p>
</blockquote>
<ul>
<li>写入<code>int</code>：<code>print(int)</code></li>
<li>写入<code>boolean</code>：<code>print(boolean)</code></li>
<li>写入<code>String</code>：<code>print(String)</code></li>
<li>写入<code>Object</code>：<code>print(Object)</code>，实际上相当于<code>print(object.toString())</code></li>
<li>以及对应的一组<code>println()</code>方法，它会自动加上换行符。</li>
</ul>
<p>我们经常使用的<code>System.out.println()</code>实际上就是使用<code>PrintStream</code>打印各种数据。其中，<code>System.out</code>是系统默认提供的<code>PrintStream</code>，表示标准输出：</p>
<p><code>System.err</code>是系统默认提供的标准错误输出。</p>
<p><code>PrintStream</code>和<code>OutputStream</code>相比，除了添加了一组<code>print()</code>/<code>println()</code>方法，可以打印各种数据类型，比较方便外，它还有一个额外的优点，就是不会抛出<code>IOException</code>，这样我们在编写代码的时候，就不必捕获<code>IOException</code>。</p>
<p>PrintWriter</p>
<blockquote>
<p><code>PrintStream</code>最终输出的总是byte数据，而<code>PrintWriter</code>则是扩展了<code>Writer</code>接口，它的<code>print()</code>/<code>println()</code>方法最终输出的是<code>char</code>数据。两者的使用方法几乎是一模一样的：</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">StringWriter buffer = new StringWriter();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try (PrintWriter pw = new PrintWriter(buffer)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pw.println(&quot;Hello&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pw.println(12345);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pw.println(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(buffer.toString());</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="files">Files<a href="#files" class="hash-link" aria-label="Files的直接链接" title="Files的直接链接">​</a></h4>
<p>Java 7开始，提供了<code>Files</code>这个工具类，能极大地方便我们读写文件。</p>
<p>虽然<code>Files</code>是<code>java.nio</code>包里面的类，但他俩封装了很多读写文件的简单方法，例如，我们要把一个文件的全部内容读取为一个<code>byte[]</code>，可以这么写：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">byte[] data = Files.readAllBytes(Path.of(&quot;/path/to/file.txt&quot;));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果是文本文件，可以把一个文件的全部内容读取为<code>String</code>：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 默认使用UTF-8编码读取:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String content1 = Files.readString(Path.of(&quot;/path/to/file.txt&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 可指定编码:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String content2 = Files.readString(Path.of(&quot;/path&quot;, &quot;to&quot;, &quot;file.txt&quot;), StandardCharsets.ISO_8859_1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 按行读取并返回每行内容:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List&lt;String&gt; lines = Files.readAllLines(Path.of(&quot;/path/to/file.txt&quot;));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>写入文件也非常方便：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 写入二进制文件:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">byte[] data = ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Files.write(Path.of(&quot;/path/to/file.txt&quot;), data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 写入文本并指定编码:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Files.writeString(Path.of(&quot;/path/to/file.txt&quot;), &quot;文本内容...&quot;, StandardCharsets.ISO_8859_1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 按行写入文本:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List&lt;String&gt; lines = ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Files.write(Path.of(&quot;/path/to/file.txt&quot;), lines);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此外，<code>Files</code>工具类还有<code>copy()</code>、<code>delete()</code>、<code>exists()</code>、<code>move()</code>等快捷方法操作文件和目录。</p>
<p>最后需要特别注意的是，<code>Files</code>提供的读写方法，受内存限制，只能读写小文件，例如配置文件等，不可一次读入几个G的大文件。读写大型文件仍然要使用文件流，每次只读写一部分文件内容。</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="stream">stream<a href="#stream" class="hash-link" aria-label="stream的直接链接" title="stream的直接链接">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- Stream（流）是一个来自数据源的元素队列，它可以支持聚合操作。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">数据源：流的数据来源，构造Stream对象的数据源，比如通过一个List来构造Stream对象，这个List就是数据源；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">聚合操作：对Stream对象进行处理后使得Stream对象返回指定规则数据的操作称之为聚合操作，比如filter、map、</span><span class="token keyword" style="color:#00009f">limit</span><span class="token plain">、sorted等都是聚合操作</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="stream对象的创建">Stream对象的创建<a href="#stream对象的创建" class="hash-link" aria-label="Stream对象的创建的直接链接" title="Stream对象的创建的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- Stream对象分为两种，一种串行的流对象(顺序单线程)，一种并行的流对象（多线程）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 为集合创建串行流对象</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stream</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">UmsPermission</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> stream </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> permissionList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 为集合创建并行流对象</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tream</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">UmsPermission</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> parallelStream </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> permissionList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parallelStream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="filter">filter<a href="#filter" class="hash-link" aria-label="filter的直接链接" title="filter的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 对Stream中的元素进行过滤操作，当设置条件返回true时返回相应元素</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 获取权限类型为目录的权限</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">UmsPermission</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> dirList </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> permissionList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">permission </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> permission</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">collect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Collectors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="map-1">map<a href="#map-1" class="hash-link" aria-label="map的直接链接" title="map的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 对Stream中的元素进行转换处理后获取。比如可以将UmsPermission对象转换成Long对象。 我们经常会有这样的需求：需要把某些对象的id提取出来，然后根据这些id去查询其他对象，这时可以使用此方法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 获取所有权限的id组成的集合</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Long</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> idList </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> permissionList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">permission </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> permission</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">collect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Collectors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="flatmap">flatMap<a href="#flatmap" class="hash-link" aria-label="flatMap的直接链接" title="flatMap的直接链接">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="limit">limit<a href="#limit" class="hash-link" aria-label="limit的直接链接" title="limit的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 从Stream中获取指定数量的元素</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 获取前5个权限对象组成的集合</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">UmsPermission</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> firstFiveList </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> permissionList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">limit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">collect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Collectors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="count">count<a href="#count" class="hash-link" aria-label="count的直接链接" title="count的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 仅获取Stream中元素的个数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- count操作：获取所有目录权限的个数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">long dirPermissionCount </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> permissionList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">permission </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> permission</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sorted">sorted<a href="#sorted" class="hash-link" aria-label="sorted的直接链接" title="sorted的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 对Stream中元素按指定规则进行排序</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 将所有权限按先目录后菜单再按钮的顺序排序</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">UmsPermission</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> sortedList </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> permissionList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sorted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">permission1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">permission2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">{</span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> permission1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">compareTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">permission2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">collect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Collectors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="skip">skip<a href="#skip" class="hash-link" aria-label="skip的直接链接" title="skip的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 跳过指定个数的Stream中元素，获取后面的元素</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 跳过前5个元素，返回后面的</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">UmsPermission</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> skipList </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> permissionList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">skip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">collect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Collectors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="list转成map">List转成map<a href="#list转成map" class="hash-link" aria-label="List转成map的直接链接" title="List转成map的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 有时候我们需要反复对List中的对象根据id进行查询，我们可以先把该List转换为以id为key的map结构，然后再通过map.get(id)来获取对象，这样比较方便</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 将权限列表以id为key，以权限对象为值转换成map</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Map</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> UmsPermission</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> permissionMap </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> permissionList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">collect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Collectors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toMap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">permission </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> permission</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> permission </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> permission</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Map</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> UmsPermission</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> permissionMap </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> permissionList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">collect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Collectors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toMap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">permission </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> permission</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Function</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">identity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> BinaryOperator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">maxBy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List&lt;ClientProjectUserTypeVo&gt; userTypeList = projectUserType.getResult();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List&lt;ClientProjectUserTypeResponse&gt; userTypeList = userTypeList.stream().map(item -&gt;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ClientProjectUserTypeResponse response = new ClientProjectUserTypeResponse();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BeanUtils.copyProperties(item,response);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return response;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}).collect(Collectors.toList())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. List&lt;String&gt; roomNameList = machineRooms.stream().map(SvMachineRoomEntity::getRoomName).collect(Collectors.toList());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3.将对象集成转成以对象某字段为key的map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;String, List&lt;Device&gt;&gt; groupByTime = list.stream()             .collect(Collectors.groupingBy(Device::getDeviceName));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//list流</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="parallelstream">parallelStream<a href="#parallelstream" class="hash-link" aria-label="parallelStream的直接链接" title="parallelStream的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 与stream流区别</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stream是顺序流，由主线程按顺序对流执行操作，而parallelStream是并行流，内部以多线程并行执行的方式对流进行操作，但前提是流中的数据处理没有顺序要求。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="泛型">泛型<a href="#泛型" class="hash-link" aria-label="泛型的直接链接" title="泛型的直接链接">​</a></h3>
<blockquote>
<p>[!tip]</p>
<ul>
<li>
<p>类的泛型类型<code>&lt;T&gt;</code>不能用于静态方法。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class Pair&lt;T&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 编译错误</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Pair&lt;T&gt; create(T first, T last) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new Pair&lt;T&gt;(first, last);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//对于静态方法，我们可以单独改写为“泛  型”方法，只需要使用另一个类型即可</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Pair&lt;T&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static &lt;K&gt; Pair&lt;K&gt; create(K first, K last) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new Pair&lt;K&gt;(first, last);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="擦拭法">擦拭法<a href="#擦拭法" class="hash-link" aria-label="擦拭法的直接链接" title="擦拭法的直接链接">​</a></h4>
<blockquote>
<p>泛型是一种类似”模板代码“的技术，不同语言的泛型实现方式不一定相同。Java语言的泛型实现方式是擦拭法（Type Erasure）。所谓擦拭法是指，虚拟机对泛型其实一无所知，所有的工作都是编译器做的。</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//这是编译器看到的代码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Pair&lt;T&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private T first;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private T last;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//而虚拟机根本不知道泛型。这是虚拟机执行的代码：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Pair {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Object first;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Object last;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>因此，Java使用擦拭法实现泛型，导致了：</p>
<ul>
<li>编译器把类型<code>&lt;T&gt;</code>视为<code>Object</code>。</li>
<li>编译器根据<code>&lt;T&gt;</code>实现安全的强制转型。</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//使用泛型的时候，我们编写的代码也是编译器看到的代码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pair&lt;String&gt; p = new Pair&lt;&gt;(&quot;Hello&quot;, &quot;world&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String first = p.getFirst();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String last = p.getLast();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//而虚拟机执行的代码并没有泛型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pair p = new Pair(&quot;Hello&quot;, &quot;world&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String first = (String) p.getFirst();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String last = (String) p.getLast();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>所以，Java的泛型是由编译器在编译时实行的，编译器内部永远把所有类型<code>T</code>视为<code>Object</code>处理，但是，在需要转型的时候，编译器会根据<code>T</code>的类型自动为我们实行安全地强制转型。</p>
<p>了解了Java泛型的实现方式——擦拭法，我们就知道了Java泛型的局限：</p>
<blockquote>
<ul>
<li>
<p>局限一：<code>&lt;T&gt;</code>不能是基本类型，例如<code>int</code>，因为实际类型是<code>Object</code>，<code>Object</code>类型无法持有基本类型</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Pair&lt;int&gt; p = new Pair&lt;&gt;(1, 2); // compile error!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>局限二：无法取得带泛型的<code>Class</code>。观察以下代码：</p>
<blockquote>
<p>因为 <code>T</code> 是 <code>Object</code>，我们对 <code>Pair&lt;String&gt;</code>和 <code>Pair&lt;Integer&gt;</code>类型获取的都是 <code>Pair</code>类的 <code>Class</code>。</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Pair&lt;String&gt; p1 = new Pair&lt;&gt;(&quot;Hello&quot;, &quot;world&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pair&lt;Integer&gt; p2 = new Pair&lt;&gt;(123, 456);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class c1 = p1.getClass();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class c2 = p2.getClass();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(c1==c2); // true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(c1==Pair.class); // true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>局限三：无法判断带泛型的类型：</p>
<blockquote>
<p>原因和前面一样，并不存在<code>Pair&lt;String&gt;.class</code>，而是只有唯一的<code>Pair.class</code>。</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Pair&lt;Integer&gt; p = new Pair&lt;&gt;(123, 456);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Compile error:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (p instanceof Pair&lt;String&gt;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>局限四：不能实例化<code>T</code>类型：</p>
<blockquote>
<p>这样一来，创建<code>new Pair&lt;String&gt;()</code> 和创建 <code>new Pair&lt;Integer&gt;()</code>就全部成了<code>Object</code>，显然编译器要阻止这种类型不对的代码。</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">first = new T();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">last = new T();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//擦拭后实际上变成了：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">first = new Object();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">last = new Object();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>要实例化<code>T</code>类型，我们必须借助额外的<code>Class&lt;T&gt;</code>参数并通过反射来实例化<code>T</code>类型：</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class Pair&lt;T&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Pair(Class&lt;T&gt; clazz) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        first = clazz.newInstance();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        last = clazz.newInstance();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</blockquote>
<p>泛型继承：一个类可以继承自一个泛型类。例如：父类的类型是<code>Pair&lt;Integer&gt;</code>，子类的类型是<code>IntPair</code>，可以这么继承</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class IntPair extends Pair&lt;Integer&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>在继承了泛型类型的情况下，子类可以获取父类的泛型类型。例如：<code>IntPair</code>可以获取到父类的泛型类型<code>Integer</code>：</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import java.lang.reflect.ParameterizedType;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.lang.reflect.Type;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Main {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Class&lt;IntPair&gt; clazz = IntPair.class;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Type t = clazz.getGenericSuperclass();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (t instanceof ParameterizedType) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ParameterizedType pt = (ParameterizedType) t;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Type[] types = pt.getActualTypeArguments(); // 可能有多个泛型类型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Type firstType = types[0]; // 取第一个泛型类型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Class&lt;?&gt; typeClass = (Class&lt;?&gt;) firstType;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(typeClass); // Integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>因为Java引入了泛型，所以，只用<code>Class</code>来标识类型已经不够了。实际上，Java的类型系统结构如下：</p>
</blockquote>
<img src="https://hayes-typora.oss-cn-shenzhen.aliyuncs.com/image-20240725153106645.png" alt="image-20240725153106645" width="50%">
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="上界通配符-extends-t">上界通配符（? extends T）<a href="#上界通配符-extends-t" class="hash-link" aria-label="上界通配符（? extends T）的直接链接" title="上界通配符（? extends T）的直接链接">​</a></h4>
<blockquote>
<p>[!important]</p>
<p><code>&lt;? extends Number&gt;</code> 通配符的限制：方法 <code>setFirst(? extends Number)</code> 无法传递任何 <code>Number</code> 的子类型给<code>setFirst(? extends Number)</code>。因为编译器不知道具体类型，无法确保类型安全。</p>
<p><strong>总结：使用extends通配符表示可以读，不能写。</strong></p>
</blockquote>
<blockquote>
<p><code>? extends T</code> 表示一个未知的具体类型，但它一定是 <code>T</code> 或 <code>T</code> 的某个子类型。这允许你处理一个不确定具体类型的集合，但你知道该集合中的元素至少实现了 <code>T</code> 接口或继承自 <code>T</code> 类。</p>
</blockquote>
<blockquote>
<p>使用<code>&lt;? extends Integer&gt;</code>通配符表示：</p>
<ul>
<li>允许调用<code>get()</code>方法获取<code>Integer</code>的引用；</li>
<li>不允许调用<code>set(? extends Integer)</code>方法并传入任何<code>Integer</code>的引用（<code>null</code>除外）。</li>
</ul>
</blockquote>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="下界通配符-super-t">下界通配符（? super T）<a href="#下界通配符-super-t" class="hash-link" aria-label="下界通配符（? super T）的直接链接" title="下界通配符（? super T）的直接链接">​</a></h5>
<blockquote>
<p>[!important]</p>
<p><code>&lt;? super Integer&gt;</code>通配符的限制：方法参数签名<code>? super Integer getFirst()</code>无法传递任何<code>Integer</code>的父类型给<code>? super Integer getFirst()</code>。因为如果传入的实际类型是<code>Pair&lt;Number&gt;</code>，编译器无法将<code>Number</code>类型转型为<code>Integer</code>。唯一可以接收<code>getFirst()</code>方法返回值的是<code>Object</code>类型。</p>
<p><strong>总结：使用super通配符表示可以写，不能读。</strong></p>
</blockquote>
<blockquote>
<p><code>? super T</code> 则表示一个未知的具体类型，但它一定是 <code>T</code> 或 <code>T</code> 的某个父类型。这意味着你可以在方法中向一个类型未知但至少是 <code>T</code> 的父类型的集合添加 <code>T</code> 类型的元素。</p>
<p>使用<code>&lt;? super Integer&gt;</code>通配符表示：</p>
<ul>
<li>允许调用<code>set(? super Integer)</code>方法传入<code>Integer</code>的引用；</li>
<li>不允许调用<code>get()</code>方法获得<code>Integer</code>的引用。</li>
</ul>
</blockquote>
<blockquote>
<p>[!note]</p>
<p>对比extends和super通配符：</p>
<ul>
<li><code>&lt;? extends T&gt;</code>允许调用读方法<code>T get()</code>获取<code>T</code>的引用，但不允许调用写方法<code>set(T)</code>传入<code>T</code>的引用（传入<code>null</code>除外）；</li>
<li><code>&lt;? super T&gt;</code>允许调用写方法<code>set(T)</code>传入<code>T</code>的引用，但不允许调用读方法<code>T get()</code>获取<code>T</code>的引用（获取<code>Object</code>除外）。</li>
</ul>
<p>例子，Java标准库的<code>Collections</code>类定义的<code>copy()</code>方法：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class Collections {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 把src的每个元素复制到dest中:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static &lt;T&gt; void copy(List&lt;? super T&gt; dest, List&lt;? extends T&gt; src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i=0; i&lt;src.size(); i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            T t = src.get(i);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            dest.add(t);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="无限定通配符">无限定通配符<a href="#无限定通配符" class="hash-link" aria-label="无限定通配符的直接链接" title="无限定通配符的直接链接">​</a></h4>
<p>Java的泛型还允许使用无限定通配符（Unbounded Wildcard Type），即只定义一个<code>?</code>：<code>void sample(Pair&lt;?&gt; p);</code>。</p>
<p>因为<code>&lt;?&gt;</code>通配符既没有<code>extends</code>，也没有<code>super</code>，因此：</p>
<ul>
<li>不允许调用<code>set(T)</code>方法并传入引用（<code>null</code>除外）；</li>
<li>不允许调用<code>T get()</code>方法并获取<code>T</code>引用（只能获取<code>Object</code>引用）。</li>
</ul>
<p>换句话说，既不能读，也不能写，那只能做一些<code>null</code>判断：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">static boolean isNull(Pair&lt;?&gt; p) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return p.getFirst() == null || p.getLast() == null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>大多数情况下，可以引入泛型参数<code>&lt;T&gt;</code>消除<code>&lt;?&gt;</code>通配符：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">static &lt;T&gt; boolean isNull(Pair&lt;T&gt; p) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return p.getFirst() == null || p.getLast() == null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>&lt;?&gt;</code>通配符有一个独特的特点，就是：<code>Pair&lt;?&gt;</code>是所有<code>Pair&lt;T&gt;</code>的超类：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//可以正常编译运行的，因为Pair&lt;Integer&gt;是Pair&lt;?&gt;的子类，可以安全地向上转型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Pair&lt;Integer&gt; p = new Pair&lt;&gt;(123, 456);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Pair&lt;?&gt; p2 = p; // 安全地向上转型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(p2.getFirst() + &quot;, &quot; + p2.getLast());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例">示例<a href="#示例" class="hash-link" aria-label="示例的直接链接" title="示例的直接链接">​</a></h4>
<blockquote>
<p>如果类本身不能使用泛型（例如，如果你正在使用一个不允许泛型的旧Java版本，或者是出于设计上的考虑），但是你仍然希望 <code>calculateYoy</code> 方法能够灵活地处理不同类型的列表，你可以将泛型放在方法级别。</p>
<p>这意味着方法将成为泛型方法，而类本身保持非泛型。</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">private &lt;T&gt; void calculateYoy(List&lt;? extends T&gt; list, Function&lt;? super T, String&gt; valueGetter, BiConsumer&lt;? super T, String&gt; yoySetter) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (int i = 1; i &lt; list.size(); i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        T previousYearVO = list.get(i);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        T currentYearVO = list.get(i - 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (ObjectUtil.isAllNotEmpty(valueGetter.apply(previousYearVO), valueGetter.apply(currentYearVO))) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            BigDecimal currentYearValue = Convert.toBigDecimal(valueGetter.apply(currentYearVO), BigDecimal.ZERO);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (currentYearValue.compareTo(BigDecimal.ZERO) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                BigDecimal previousYearValue = Convert.toBigDecimal(valueGetter.apply(previousYearVO), BigDecimal.ZERO);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                BigDecimal yoyChange = (currentYearValue.subtract(previousYearValue)).divide(previousYearValue, 4, RoundingMode.HALF_UP);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                yoySetter.accept(currentYearVO, yoyChange.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="泛型和反射">泛型和反射<a href="#泛型和反射" class="hash-link" aria-label="泛型和反射的直接链接" title="泛型和反射的直接链接">​</a></h4>
<p>Java的部分反射API也是泛型。例如：<code>Class&lt;T&gt;</code>就是泛型：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// compile warning:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class clazz = String.class;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String str = (String) clazz.newInstance();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// no warning:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class&lt;String&gt; clazz = String.class;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String str = clazz.newInstance();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>调用<code>Class</code>的<code>getSuperclass()</code>方法返回的<code>Class</code>类型是<code>Class&lt;? super T&gt;</code>：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Class&lt;? super String&gt; sup = String.class.getSuperclass();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>构造方法<code>Constructor&lt;T&gt;</code>也是泛型：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Class&lt;Integer&gt; clazz = Integer.class;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Constructor&lt;Integer&gt; cons = clazz.getConstructor(int.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Integer i = cons.newInstance(123);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>我们可以声明带泛型的数组，但不能用<code>new</code>操作符创建带泛型的数组，必须通过强制转型实现带泛型的数组：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Pair&lt;String&gt;[] ps = null; // ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pair&lt;String&gt;[] ps = new Pair&lt;String&gt;[2]; // compile error!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@SuppressWarnings(&quot;unchecked&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pair&lt;String&gt;[] ps = (Pair&lt;String&gt;[]) new Pair[2]; //compile success</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>带泛型的数组实际上是编译器的类型擦除：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Pair[] arr = new Pair[2];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pair&lt;String&gt;[] ps = (Pair&lt;String&gt;[]) arr;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(ps.getClass() == Pair[].class); // true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String s1 = (String) arr[0].getFirst();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String s2 = ps[0].getFirst();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>不能直接创建泛型数组<code>T[]</code>，因为擦拭后代 码变为<code>Object[]</code>。必须借助<code>Class&lt;T&gt;</code>来创建泛型数组或利用可变参数创建泛型数组：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// compile error:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Abc&lt;T&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    T[] createArray() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new T[5];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// compile success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">T[] createArray(Class&lt;T&gt; cls) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return (T[]) Array.newInstance(cls, 5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// compile success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ArrayHelper {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @SafeVarargs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static &lt;T&gt; T[] asArray(T... objs) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return objs;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String[] ss = ArrayHelper.asArray(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Integer[] ns = ArrayHelper.asArray(1, 2, 3);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>似乎可以安全地创建一个泛型数组。但实际上，这种方法非常危险。原因还是因为擦拭法，在<code>pickTwo()</code>方法内部，编译器无法检测<code>K[]</code>的正确类型，因此返回了<code>Object[]</code>。以下代码来自《Effective Java》的示例：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class Main {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String[] arr = asArray(&quot;one&quot;, &quot;two&quot;, &quot;three&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(Arrays.toString(arr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ClassCastException:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String[] firstTwo = pickTwo(&quot;one&quot;, &quot;two&quot;, &quot;three&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(Arrays.toString(firstTwo));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static &lt;K&gt; K[] pickTwo(K k1, K k2, K k3) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return asArray(k1, k2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //编译器对所有可变泛型参数都会发出警告，可以用`@SafeVarargs`消除警告。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static &lt;T&gt; T[] asArray(T... objs) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return objs;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="注解">注解<a href="#注解" class="hash-link" aria-label="注解的直接链接" title="注解的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="inherited">@Inherited<a href="#inherited" class="hash-link" aria-label="@Inherited的直接链接" title="@Inherited的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 元注解</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">类A继承类B，类B有一个自定义注解，如果想要A继承B的注解，则需要在B自定义注解上加上</span><span class="token variable" style="color:#36acaa">@Inherited</span><span class="token plain">表示元注解，用于指示注解是否应该被子类继承。默认情况下，自定义注解是不继承给子类的</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- @Retention</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUNTIME：确保它可以在运行时被反射访问</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="intercepts-signature">@Intercepts @Signature<a href="#intercepts-signature" class="hash-link" aria-label="@Intercepts @Signature的直接链接" title="@Intercepts @Signature的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- mybatis拦截器可以拦截如下4中类型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Executor：</span><span class="token keyword" style="color:#00009f">sql</span><span class="token plain">的内部执行器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ParameterHandler：拦截参数的处理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">StatementHandler：拦截</span><span class="token keyword" style="color:#00009f">sql</span><span class="token plain">的构建</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ResultSetHandler：拦截结果的处理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- @Signature 注解参数说明</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain">：就是指定拦截器类型（ParameterHandler ，StatementHandler，ResultSetHandler ）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">method：是拦截器类型中的方法，不是自己写的方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">args：是method中方法的入参</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- eg</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@Intercepts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">value</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@Signature</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ResultSetHandler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">class</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> method </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;handleResultSets&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> args </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Statement</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> class MybatisResultSetHandler implements Interceptor {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> Object intercept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Invocation invocation</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> throws Throwable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//这里不管几个结果都是返回一个list，强转成list即可</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object proceed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> invocation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">proceed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">proceed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> proceed</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- type就是拦截结果的处理（ResultSetHandler ）的拦截器，method是ResultSetHandler接口的某一个方法,args就是这个方法中的参数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> interface ResultSetHandler {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">E</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> List</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">E</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> handleResultSets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Statement var1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> throws SQLException</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">E</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Cursor</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">E</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> handleCursorResultSets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Statement var1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> throws SQLException</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void handleOutputParameters</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CallableStatement var1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> throws SQLException</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- Interceptor 接口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">intercept方法：interceptor能够拦截的四种类型对象，此处入参invocation便是指拦截到的对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plugin方法：让mybatis判断，是否要进行拦截，然后做出决定是否生成一个代理（</span><span class="token variable" style="color:#36acaa">@Intercepts</span><span class="token plain">注解来决定是否进行拦截处理）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setProperties方法：拦截器需要一些变量对象，而且这个对象是支持可配置的</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="conditional">@Conditional<a href="#conditional" class="hash-link" aria-label="@Conditional的直接链接" title="@Conditional的直接链接">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//简单使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">在java中这种情况，调用系统的cmd命令，但是在window和linux下命令有些有些时候是不一样的</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class LinuxCondition implements Condition {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return context.getEnvironment().getProperty(&quot;os.name&quot;).contains(&quot;Linux&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class WindowsCondition implements Condition {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	 * ConditionContext context: spring容器上下文环境</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	 * AnnotatedTypeMetadata metadata ：@Conditional修饰类型信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return context.getEnvironment().getProperty(&quot;os.name&quot;).contains(&quot;Windows&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public interface CmdService {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void print();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class WindowCmdService implements CmdService{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void print() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;Window cmd...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class LinuxCmdService implements CmdService{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void print() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;Linux cmd...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CmdServiceConditionConfig {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 当WindowCondition方法中的matches返回true的时候，</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * WindowCmdService会被注入，否则不注入。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean(&quot;cmdService&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Conditional(WindowCondition.class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public CmdService windowCmdService(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new WindowCmdService();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 当LinuxCondition方法中的matches返回true的时候，</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * LinuxCmdService会被注入，否则不注入。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean(&quot;cmdService&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Conditional(LinuxCondition.class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public CmdService LinuxCmdService(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new LinuxCmdService();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 衍生注解</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- @ConditionalOnBean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">仅仅在当前上下文中存在某个对象时，才会实例化一个Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- @ConditionalOnClass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">某个class位于类路径上，才会实例化一个Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- @ConditionalOnExpression</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">当表达式为</span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain">的时候，才会实例化一个Bean。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">比如：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@ConditionalOnExpression</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@ConditionalOnExpression</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;${my.controller.enabled:false}&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- @ConditionalOnMissingBean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">仅仅在当前上下文中不存在某个对象时，才会实例化一个Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- @ConditionalOnMissingClass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">某个class类路径上不存在的时候，才会实例化一个Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- @ConditionalOnNotWebApplication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">不是web应用</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="requestmapping">@RequestMapping<a href="#requestmapping" class="hash-link" aria-label="@RequestMapping的直接链接" title="@RequestMapping的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- produces 指定Accept标头（指定返回类型）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@RequestMapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">value</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/ex/foos&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  method </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GET</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  produces </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> { </span><span class="token string" style="color:#e3116c">&quot;application/json&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;application/xml&quot;</span><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- consumes（指定处理请求的提交内容类型（Content-Type））</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@RequestMapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">value</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/pets&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    method </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> RequestMethod</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">POST</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    consumes</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;application/json&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="dependson">@DependsOn<a href="#dependson" class="hash-link" aria-label="@DependsOn的直接链接" title="@DependsOn的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">可以定义在类和方法上，意思是我这个组件要依赖于另一个组件，也就是说被依赖的组件会比该组件先注册到IOC容器中</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="postconstruct">@PostConstruct<a href="#postconstruct" class="hash-link" aria-label="@PostConstruct的直接链接" title="@PostConstruct的直接链接">​</a></h4>
<div class="language-mysql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mysql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">服务启动时执行该注解方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@PostConstruct注解的⽅法在加载类的构造函数之后执⾏，也就是在加载了构造函数之后</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="async">@Async<a href="#async" class="hash-link" aria-label="@Async的直接链接" title="@Async的直接链接">​</a></h4>
<div class="language-mysql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mysql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1.异步线程</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2.@Async与@Transactional一起使用，子线程不影响主线程，线程间事务相互隔离</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3.启动类使用@EnableAsync启用异步</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">源码入口：@EnableAsync --&gt; 重要类AsyncConfigurationSelector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@EnableAsync最终是向容器内注入了ProxyAsyncConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">注意：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">在Spring里面，不论是事务注解还是异步注解，通通都是依靠AOP注入逻辑的，而内部方法调用是走不了代理的，所以这里的@Async压根就没生效，所以说这叫假想异步（同个类不生效）</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="value">@Value<a href="#value" class="hash-link" aria-label="@Value的直接链接" title="@Value的直接链接">​</a></h4>
<div class="language-mysql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mysql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">private static String appKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Value(&quot;${third.hikvision.appKey}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static void setAppKey(String appKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HKApiUtil.appKey = appKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="preauthorize">@PreAuthorize<a href="#preauthorize" class="hash-link" aria-label="@PreAuthorize的直接链接" title="@PreAuthorize的直接链接">​</a></h4>
<div class="language-mysql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mysql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@PreAuthorize 注解，顾名思义是进入方法前的权限验证，@PreAuthorize 声明这个方法所需要的权限表达式，例如：@PreAuthorize(&quot;hasAuthority(&#x27;sys:dept:delete&#x27;)&quot;)，</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">根据这个注解所需要的权限，再和当前登录的用户角色所拥有的权限对比，如果用户的角色权限集Set中有这个权限，则放行；没有，拒绝</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="builder">@Builder<a href="#builder" class="hash-link" aria-label="@Builder的直接链接" title="@Builder的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">@Builder</span><span class="token plain"> 注解为类生成相对略微复杂的构建器 API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">它作用于类，将其变成建造者模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">可以以链的形式调用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">初始化实例对象生成的对象是不可以变的，可以在创建对象的时候进行赋值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">如果需  要在原来的基础上修改可以加 </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> 方法，final 字段可以不需要初始化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">它会生成一个全参的构造函数</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="within-target">@within @target<a href="#within-target" class="hash-link" aria-label="@within @target的直接链接" title="@within @target的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">@within</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> 和 </span><span class="token variable" style="color:#36acaa">@target</span><span class="token plain">的“作用域”有点像清朝的爵位和官位的“有效期”：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@within</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ，类似于爵位，是可以世袭的</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@target</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">，类似于官位，是不能世袭的</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- ================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@Before</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;@target(com.javatpoint.jjk.A1)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> void execute2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;@target --- A1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">上述代码可以形象地理解为，谁的官位是A1，就在他的所有方法执行前进行增强，即打印</span><span class="token variable" style="color:#36acaa">@target</span><span class="token plain"> — A1，显然，只有Human被封了官。这种官位是不能世袭的，所以，对Man和Boy无效。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- ================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@Before</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;@within(com.javatpoint.jjk.A2)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> void execute3</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;@within --- A2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">上述代码可以形象地理解为，谁是A2爵位的受益者，就在他自己的方法，或者继承的方法执行前增强，即打印</span><span class="token variable" style="color:#36acaa">@within</span><span class="token plain"> — A2，显然，Man、Boy都收益。Boy重写的方法不会增强，这不是世袭的，也好理解！</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="https://hayes-typora.oss-cn-shenzhen.aliyuncs.com/withinAndtarget.png" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="validated-valid">@Validated @Valid<a href="#validated-valid" class="hash-link" aria-label="@Validated @Valid的直接链接" title="@Validated @Valid的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 说明</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">springboot2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">3</span><span class="token plain">版本后，web中不包含Validated校验依赖，需要手动添加依赖</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">dependency</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">groupId</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">org</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">springframework</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">boot</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">groupId</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">artifactId</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">spring</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">boot</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">starter</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">validation</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">artifactId</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">dependency</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 属性校验注解</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@NotBlank</span><span class="token plain">：只用在String上，表示传进来的值不能为</span><span class="token boolean" style="color:#36acaa">null</span><span class="token plain">，而且调用trim</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">后，长度必须大于</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@NotNull</span><span class="token plain">：不能为</span><span class="token boolean" style="color:#36acaa">null</span><span class="token plain">，但可以为empty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">分配了内存空间，但值为空</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@NotEmpty</span><span class="token plain">：不能为</span><span class="token boolean" style="color:#36acaa">null</span><span class="token plain">，而且长度必须大于</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 注解位置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@Validated</span><span class="token plain">：用在类型、方法和方法参数上。但不能用于成员属性</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@Valid</span><span class="token plain">：可以用在方法、构造函数、方法参数和成员属性上</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">所以可以用</span><span class="token variable" style="color:#36acaa">@Valid</span><span class="token plain">实现嵌套验证</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 异常</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">如果校验失败，会抛出MethodArgumentNotValidException或者ConstraintViolationException异常</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="分组校验">分组校验<a href="#分组校验" class="hash-link" aria-label="分组校验的直接链接" title="分组校验的直接链接">​</a></h5>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-- 分组校验</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- 在分组EditUser时，验证id不能为空，其他情况下不做验证</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@NotNull(groups={EditUser.class})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private Long id;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- 此处不填分组消息表示所有分组都需要校验</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@NotNull(groups = {AddUser.class, EditUser.class})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private UserIdCardVo userIdCardVo;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@RequestBody @Validated({EditUser.class})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- @Valid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">不支持分组，所以对于所有校验标签里面添加了groups字段的都不会校验会跳过</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="嵌套校验">嵌套校验<a href="#嵌套校验" class="hash-link" aria-label="嵌套校验的直接链接" title="嵌套校验的直接链接">​</a></h5>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DTO类里面的字段都是基本数据类型和String类型。但是实际场景中，有可能某个字段也是一个对象，这种情况先，可以使用嵌套校验。比如，上面保存User信息的时候同时还带有Job信息。需要注意的是，此时DTO类的对应字段必须标记@Valid注解</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@NotNull(groups = {Save.class, Update.class})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Valid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private Job job;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static class Job {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   @Min(value = 1, groups = Update.class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   private Long jobId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   @NotNull(groups = {Save.class, Update.class})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   @Length(min = 2, max = 10, groups = {Save.class, Update.class})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   private String jobName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="集合校验">集合校验<a href="#集合校验" class="hash-link" aria-label="集合校验的直接链接" title="集合校验的直接链接">​</a></h5>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">如果请求体直接传递了json数组给后台，并希望对数组中的每一项都进行参数校验。此时，如果我们直接使用java.util.Collection下的list或者set来接收数据，参数校验并不会生效！我们可以使用自定义list集合来接收参数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ValidationList&lt;E&gt; implements List&lt;E&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Delegate // @Delegate是lombok注解</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Valid // 一定要加@Valid注解</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public List&lt;E&gt; list = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 一定要记得重写toString方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String toString() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return list.toString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@RequestBody @Validated(UserDTO.Save.class) ValidationList&lt;UserDTO&gt; userList</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="自定义校验">自定义校验<a href="#自定义校验" class="hash-link" aria-label="自定义校验的直接链接" title="自定义校验的直接链接">​</a></h5>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/* </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">业务需求总是比框架提供的这些简单校验要复杂的多，我们可以自定义校验来满足我们的需求。自定义spring validation非常简单，假设我们自定义加密id（由数字或者a-f的字母组成，32-256长度）校验，主要分为两步</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Target({METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Retention(RUNTIME)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Documented</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Constraint(validatedBy = {EncryptIdValidator.class})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public @interface EncryptId {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 默认错误消息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String message() default &quot;加密id格式错误&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 分组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Class&lt;?&gt;[] groups() default {};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 负载</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Class&lt;? extends Payload&gt;[] payload() default {};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class EncryptIdValidator implements ConstraintValidator&lt;EncryptId, String&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final Pattern PATTERN = Pattern.compile(&quot;^[a-f\d]{32,256}$&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public boolean isValid(String value, ConstraintValidatorContext context) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 不为null才进行校验</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (value != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Matcher matcher = PATTERN.matcher(value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return matcher.find();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//这样我们就可以使用@EncryptId进行参数校验了</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="编程式校验">编程式校验<a href="#编程式校验" class="hash-link" aria-label="编程式校验的直接链接" title="编程式校验的直接链接">​</a></h5>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">@Autowired</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private javax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">validation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Validator globalValidator</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 编程式校验</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">@PostMapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/saveWithCodingValidate&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> Result saveWithCodingValidate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">@RequestBody</span><span class="token plain"> UserDTO userDTO</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">Set</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ConstraintViolation</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">UserDTO</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> validate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> globalValidator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">validate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">userDTO</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> UserDTO</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">Save</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    	</span><span class="token comment" style="color:#999988;font-style:italic">// 如果校验通过，validate为空；否则，validate包含未校验通过项</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">validate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isEmpty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 校验通过，才会执行业务逻辑处理</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ConstraintViolation</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">UserDTO</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> userDTOConstraintViolation : validate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// 校验失败，做其它逻辑</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">userDTOConstraintViolation</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> Result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="快速失败">快速失败<a href="#快速失败" class="hash-link" aria-label="快速失败的直接链接" title="快速失败的直接链接">​</a></h5>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Spring Validation默认会校验完所有字段，然后才抛出异常。可以通过一些简单的配置，开启Fali Fast模式，一旦校验失败就立即返回</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public Validator validator() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ValidatorFactory validatorFactory = Validation.byProvider(HibernateValidator.class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .configure()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 快速失败模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .failFast(true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .buildValidatorFactory();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return validatorFactory.getValidator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="敏感词脱敏">敏感词脱敏<a href="#敏感词脱敏" class="hash-link" aria-label="敏感词脱敏的直接链接" title="敏感词脱敏的直接链接">​</a></h3>
<p><a href="https://mp.weixin.qq.com/s/vVhB8uJBz4WMlOZHJ2Zbog" target="_blank" rel="noopener noreferrer">https://mp.weixin.qq.com/s/vVhB8uJBz4WMlOZHJ2Zbog</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="jenkins自动化部署">Jenkins自动化部署<a href="#jenkins自动化部署" class="hash-link" aria-label="Jenkins自动化部署的直接链接" title="Jenkins自动化部署的直接链接">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 部署后端</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https:</span><span class="token comment" style="color:#999988;font-style:italic">//www.macrozheng.com/mall/reference/jenkins.html</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 部署前端</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https:</span><span class="token comment" style="color:#999988;font-style:italic">//www.macrozheng.com/mall/reference/jenkins_vue.html</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spi机制">SPI机制<a href="#spi机制" class="hash-link" aria-label="SPI机制的直接链接" title="SPI机制的直接链接">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//SPI ，全称为 Service Provider Interface，是一种服务发现机制。它通过在ClassPath路径下的META-INF/services文件夹查找文件，自动加载文件里所定义的类。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//1.首先，我们需要定义一个接口，SPIService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface SPIService {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void execute();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//2.然后，定义两个实现类</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SpiImpl1 implements SPIService{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void execute() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;SpiImpl1.execute()&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SpiImpl2 implements SPIService{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void execute() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;SpiImpl2.execute()&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//3.最后呢，要在ClassPath路径下配置添加一个文件。文件名字是接口的全限定类名，内容是实现类的全限定类名，多个实现类用换行符分隔。com.viewscenes.netsupervisor.spi.SPIService。内容：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">com.viewscenes.netsupervisor.spi.SpiImpl1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">com.viewscenes.netsupervisor.spi.SpiImpl2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//4.然后我们就可以通过ServiceLoader.load或者Service.providers方法拿到实现类的实例。其中，Service.providers包位于sun.misc.Service，而ServiceLoader.load包位于java.util.ServiceLoader。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Test {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Iterator&lt;SPIService&gt; providers = Service.providers(SPIService.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ServiceLoader&lt;SPIService&gt; load = ServiceLoader.load(SPIService.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while(providers.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SPIService ser = providers.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ser.execute();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;--------------------------------&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Iterator&lt;SPIService&gt; iterator = load.iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while(iterator.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SPIService ser = iterator.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ser.execute();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//5.输出结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SpiImpl1.execute()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SpiImpl2.execute()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SpiImpl1.execute()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SpiImpl2.execute()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">总结：Java中的SPI提供了一种比较特别的服务发现和调用机制，通过接口灵活的将服务调用与服务提供者分离，用于提供给第三方实现扩展时还是很方便的。但是也有缺点，比方说一旦加载一个接口，就会把所有实现类都加载进来，可能会加载到不需要的冗余服务。不过站在整体角度上，还是给我们提供了一种非常不错的框架扩展、集成的思路。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="jna-jni">JNA JNI<a href="#jna-jni" class="hash-link" aria-label="JNA JNI的直接链接" title="JNA JNI的直接链接">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- JNA(Java Native Access &quot;JNA(Java Native Access)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">一个开源的 Java 框架，是 Sun 公司推出的一种调用本地方法的技术，是建立在经典的 JNI 基础之上的一个框架。之所以说它是 JNI 的替代者，是因为 JNA 大大简化了调用本地方法的过程，使用很方便，基本上不需要脱离 Java 环境就可以完成。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- JNI （Java Native Interface）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">即 Java 本地接口，它建立了 Java 与其他编程语言的桥梁，允许 Java 程序调用其他语言（尤其是 C</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">C</span><span class="token operator" style="color:#393A34">+</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> ）编写的程序或者代码库。并且， JDK 本身的实现也大量用到 JNI 技术来调用本地 C 程序库。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="aop">AOP<a href="#aop" class="hash-link" aria-label="AOP的直接链接" title="AOP的直接链接">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- AOP为Aspect Oriented Programming的缩写</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 意为：面向切面编程</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 通过预编译方式和运行期动态代理实现程序功能的统一维护的一种技术</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高了开发的效率</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="相关术语">相关术语<a href="#相关术语" class="hash-link" aria-label="相关术语的直接链接" title="相关术语的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="通知advice">通知（Advice）<a href="#通知advice" class="hash-link" aria-label="通知（Advice）的直接链接" title="通知（Advice）的直接链接">​</a></h5>
<p>通知描述了切面要完成的工作以及何时执行。比如我们的日志切面需要记录每个接口调用时长，就需要在接口调用前后分别记录当前时间，再取差值</p>
<ul>
<li>前置通知（Before）：在目标方法调用前调用通知功能。</li>
<li>后置通知（After）：在目标方法调用之后调用通知 功能，不关心方法的返回结果；原操作异常也会执行。</li>
<li>返回通知（AfterReturning）：在目标方法成功执行之后调用通知功能；原操作异常，不会执行。</li>
<li>异常通知（AfterThrowing）：在目标方法抛出异常后调用通知功能。</li>
<li>环绕通知（Around）：通知包裹了目标方法，在目标方法调用之前和之后执行自定义的行为；
需要对原操作调用Object result = proceedingJoinPoint.proceed()；
如果有返回值，需要return result。</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="连接点joinpoint">连接点（JoinPoint）<a href="#连接点joinpoint" class="hash-link" aria-label="连接点（JoinPoint）的直接链接" title="连接点（JoinPoint）的直接链接">​</a></h5>
<p>通知功能被应用的时机。比如接口方法被调用的时候就是日志切面的连接点</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="切点pointcut">切点（Pointcut）<a href="#切点pointcut" class="hash-link" aria-label="切点（Pointcut）的直接链接" title="切点（Pointcut）的直接链接">​</a></h5>
<p>切点定义了通知功能被应用的范围。比如日志切面的应用范围就是所有接口，即所有controller层的接口方法</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="切面aspect">切面（Aspect）<a href="#切面aspect" class="hash-link" aria-label="切面（Aspect）的直接链接" title="切面（Aspect）的直接链接">​</a></h5>
<p>切面是通知和切点的结合，定义了何时、何地应用通知功能</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="引入introduction">引入（Introduction）<a href="#引入introduction" class="hash-link" aria-label="引入（Introduction）的直接链接" title="引入（Introduction）的直接链接">​</a></h5>
<p>在无需修改现有类的情况下，向现有的类添加新方法或属性</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="织入weaving">织入（Weaving  ）<a href="#织入weaving" class="hash-link" aria-label="织入（Weaving）的直接链接" title="织入（Weaving）的直接链接">​</a></h5>
<p>把切面应用到目标对象并创建新的代理对象的过程</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="相关注解">相关注解<a href="#相关注解" class="hash-link" aria-label="相关注解的直接链接" title="相关注解的直接链接">​</a></h4>
<ul>
<li>@Aspect：用于定义切面</li>
<li>@Before：通知方法会在目标方法调用之前执行</li>
<li>@After：通知方法会在目标方法返回或抛出异常后执行</li>
<li>@AfterReturning：通知方法会在目标方法返回后执行</li>
<li>@AfterThrowing：通知方法会在目标方法抛出异常后执行</li>
<li>@Around：通知方法会将目标方法封装起来</li>
<li>@Pointcut：定义切点表达式</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="切点表达式">切点表达式<a href="#切点表达式" class="hash-link" aria-label="切点表达式的直接链接" title="切点表达式的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 指定了通知被应用的范围，表达式格式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">execution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">方法修饰符 返回类型 方法所属的包</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">类名</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">方法名称</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">方法参数</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- com.macro.mall.tiny.controller包中所有类的public方法都应用切面里的通知</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">execution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> com</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">macro</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mall</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tiny</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">controller</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- com.macro.mall.tiny.service包及其子包下所有类中的所有方法都应用切面里的通知</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">execution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> com</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">macro</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mall</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tiny</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">service</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- com.macro.mall.tiny.service.PmsBrandService类中的所有方法都应用切面里的通知</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">execution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> com</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">macro</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mall</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tiny</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">service</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PmsBrandService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="接口文档">接口文档<a href="#接口文档" class="hash-link" aria-label="接口文档的直接链接" title="接口文档的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="springfox">springfox<a href="#springfox" class="hash-link" aria-label="springfox的直接链接" title="springfox的直接链接">​</a></h4>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">io.springfox</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">springfox-swagger2</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">2.2.2</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">io.springfox</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">springfox-swagger-ui</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">2.2.2</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">1.</span><span class="token plain"> Springfox是一个通过扫描代码提取代码中的信息，生成API文档的工具</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2.</span><span class="token plain"> API文档的格式不止Swagger的OpenAPI Specification，还有RAML，jsonapi，Springfox的目标同样包括支持这些格式。这就能解释那个swagger2的后缀了，这只是Springfox对Swagger的支持</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3.</span><span class="token plain"> 在Swagger的教程中，都会提到</span><span class="token variable" style="color:#36acaa">@Api</span><span class="token plain">、</span><span class="token variable" style="color:#36acaa">@ApiModel</span><span class="token plain">、</span><span class="token variable" style="color:#36acaa">@ApiOperation</span><span class="token plain">这些注解，这些注解其实不是Springfox的，而是Swagger的。springfox</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">swagger2这个包依赖了swagger</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">core这个包，而这些注解正是在这里面</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4.</span><span class="token plain"> swagger</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">core这个包是只支持JAX</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">RS2的，并不支持常用的Spring MVC。这就是springfox</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">swagger的作用了，它将上面那些用于JAX</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">RS2的注解适配到了Spring MVC上</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5.</span><span class="token plain"> 除了Spring MVC外，Springfox还支持Spring </span><span class="token keyword" style="color:#00009f">Data</span><span class="token plain"> REST、JSR </span><span class="token number" style="color:#36acaa">303</span><span class="token plain">，这项标准的参考实现是Hibernate Validator</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="swagger">swagger<a href="#swagger" class="hash-link" aria-label="swagger的直接链接" title="swagger的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 接口地址：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//localhost:8080/swagger-ui.html</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 注释说明</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@Api</span><span class="token plain">：用于修饰Controller类，生成Controller相关文档信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@ApiOperation</span><span class="token plain">：用于修饰Controller类中的方法，生成接口方法相关文档信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@ApiParam</span><span class="token plain">：用于修饰接口中的参数，生成接口参数相关文档信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@ApiModelProperty</span><span class="token plain">：用于修饰实体类的属性，当实体类是请求参数或返回结果时，直接生成相关文档信息</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!--Swagger-UI API文档生产工具--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">io.springfox</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">springfox-swagger2</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">2.7.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">io.springfox</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">springfox-swagger-ui</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">2.7.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.heminhua.system.config;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.context.annotation.Bean;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.context.annotation.Configuration;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import springfox.documentation.builders.ApiInfoBuilder;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import springfox.documentation.builders.PathSelectors;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import springfox.documentation.builders.RequestHandlerSelectors;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import springfox.documentation.service.ApiInfo;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import springfox.documentation.spi.DocumentationType;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import springfox.documentation.spring.web.plugins.Docket;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import springfox.documentation.swagger2.annotations.EnableSwagger2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Swagger2API文档的配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author hmh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@EnableSwagger2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Swagger2Config {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Docket createRestApi(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new Docket(DocumentationType.SWAGGER_2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .apiInfo(apiInfo())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .select()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                //为当前包下controller生成API文档</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .apis(RequestHandlerSelectors.basePackage(&quot;com.heminhua.system.api&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                //为有@Api注解的Controller生成API文档</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                //.apis(RequestHandlerSelectors.withClassAnnotation(Api.class))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                //为有@ApiOperation注解的方法生成API文档</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                //.apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .paths(PathSelectors.any())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private ApiInfo apiInfo() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new ApiInfoBuilder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .title(&quot;SwaggerUI演示&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .description(&quot;接口文档&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .contact(&quot;hmhStart&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .version(&quot;1.0&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="knife4j">knife4j<a href="#knife4j" class="hash-link" aria-label="knife4j的直接链接" title="knife4j的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 接口地址：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//localhost:9992/doc.html#/home</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!--整合Knife4j--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.github.xiaoymin</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">knife4j-spring-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">2.0.2</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Swagger2API文档的配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@EnableSwagger2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@EnableKnife4j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Swagger2Config {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="swagger新版本">swagger新版本<a href="#swagger新版本" class="hash-link" aria-label="swagger新版本的直接链接" title="swagger新版本的直接链接">​</a></h4>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!--springfox swagger官方Starter--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">io.springfox</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">springfox-boot-starter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">3.0.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 地址</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//localhost:8088/swagger-ui/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">springfox</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token key atrule" style="color:#00a4db">documentation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="反应式编程">反应式编程<a href="#反应式编程" class="hash-link" aria-label="反应式编程的直接链接" title="反应式编程的直接链接">​</a></h3>
<p>反应式编程是关于非阻塞应用程序的，这些应用程序是异步的、事件驱动的，并且需要少量的线程来垂直伸缩(即在 JVM 中)，而不是水平伸缩(即通过集群)</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="reactor框架">Reactor框架<a href="#reactor框架" class="hash-link" aria-label="Reactor框架的直接链接" title="Reactor框架的直接链接">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- Reactor是一个第四代响应式编程框架，用于构建非阻塞JVM应用程序，基于Reactive Streams Specification实现</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- Reactor是一种基于事件驱动的编程模型，它主要用于网络编程中的高并发场景，能够高效地处理大量的并发连接请求</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- Reactor两个核心组件：Selector和Handler</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1.</span><span class="token plain"> Selector是Java NIO中的一个核心组件，它可以监听多个通道（Channel）的事件，如连接、读写等事件。Selector会不断轮询已经注册的通道，一旦某个通道发生了事件，Selector就会通知相应的</span><span class="token keyword" style="color:#00009f">Handler</span><span class="token plain">来处理这个事件。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Handler</span><span class="token plain">是一个处理器，它负责具 体的业务逻辑，当Selector通知</span><span class="token keyword" style="color:#00009f">Handler</span><span class="token plain">有事件发生时，</span><span class="token keyword" style="color:#00009f">Handler</span><span class="token plain">就会根据事件类型执行相应的操作，例如读取数据、处理数据、写入数据等等。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 主要流程</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1.</span><span class="token plain"> Selector监听通道上的事件，当有事件发生时，Selector就会通知相应的</span><span class="token keyword" style="color:#00009f">Handler</span><span class="token plain">来处理事件。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Handler</span><span class="token plain">处理事件，根据事件类型执行相应的操作。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Handler</span><span class="token plain">将处理结果返回给客户端。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 优缺点</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Java类Reactor模型的优点是可以处理大量的并发连接请求，减少了线程的创建和销毁，提高了程序的 性能和效率。但同时也需要注意防止</span><span class="token keyword" style="color:#00009f">Handler</span><span class="token plain">的处理逻辑过于复杂，导致阻塞或者耗时过长的情况出现。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="flux和mono">Flux和Mono<a href="#flux和mono" class="hash-link" aria-label="Flux和Mono的直接链接" title="Flux和Mono的直接链接">​</a></h5>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- Flux</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1.</span><span class="token plain"> 代表的是 </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"> N 个响应式序列</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2.</span><span class="token plain"> Flux其实就是一个Publisher，用来产生异步序列</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3.</span><span class="token plain"> Flux提供了非常多的有用的方法，来处理这些序列，并且提供了completion和error的信号通知</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4.</span><span class="token plain"> 相应的会去调用Subscriber的onNext</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> onComplete</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> onError方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- Mono</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1.</span><span class="token plain"> 代表的是</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">或者</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">个响应式序列</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2.</span><span class="token plain"> Mono和Flux一样，也是一个Publisher，用来产生异步序列。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3.</span><span class="token plain"> Mono因为只有</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">或者</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">个序列，所以只会触发Subscriber的onComplete和onError方法，没有onNext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4.</span><span class="token plain"> Mono和Flux是可以互相转换的，Mono</span><span class="token comment" style="color:#999988;font-style:italic">#concatWith(Publisher)返回一个Flux，而 Mono#then(Mono)返回一个Mono.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="flux">Flux<a href="#flux" class="hash-link" aria-label="Flux的直接链接" title="Flux的直接链接">​</a></h5>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 创建</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flux</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> seq1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Flux</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">just</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;foo&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;foobar&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> iterable </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">asList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;foo&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;foobar&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flux</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> seq2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Flux</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fromIterable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">iterable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flux</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">Integer</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> numbersFromFiveToSeven </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Flux</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 打印</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">创建的Flux调用log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- subscribe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Disposable subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Disposable subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Consumer</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">? super T</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> consumer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Disposable subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Consumer</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">? super T</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> consumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Consumer</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">? super Throwable</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> errorConsumer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Disposable subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Consumer</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">? super T</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> consumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Consumer</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">? super Throwable</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> errorConsumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Runnable completeConsumer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Disposable subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Consumer</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">? super T</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> consumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Consumer</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">? super Throwable</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> errorConsumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Runnable completeConsumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Consumer</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">? super Subscription</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> subscriptionConsumer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- subscribe四个参数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flux</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">Integer</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ints3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Flux</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ints3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">out</span><span class="token plain">::println</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    error </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Error &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Done&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sub </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> sub</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">参数</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">：表示打印出来</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">参数</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">：中间有错误，输出Error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">参数</span><span class="token number" style="color:#36acaa">3</span><span class="token plain">：全部完成，输出Done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">参数</span><span class="token number" style="color:#36acaa">4</span><span class="token plain">：subscriptionConsumer调用request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">决定这次subscribe获取元素的最大数目</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> interface Subscription {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> void request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">long n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> void cancel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- Disposable对象</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> interface Disposable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	void dispose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> isDisposed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">可通过调用dispose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">取消这个subscribe（发出提醒，不能保证马上停止）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- Disposables工具类</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1.</span><span class="token plain"> Disposables</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">swap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">可创建一个Disposable，用来替换或者取消一个现有的Disposable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2.</span><span class="token plain"> Disposables</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">composite</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">…</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">可以将多个Disposable合并起来，在后面统一做处理</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="事务">事务<a href="#事务" class="hash-link" aria-label="事务的直接链接" title="事务的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="分布式事务">分布式事务<a href="#分布式事务" class="hash-link" aria-label="分布式事务的直接链接" title="分布式事务的直接链接">​</a></h4>
<p>seata写隔离</p>
<ol>
<li>全局事务t1和t2</li>
<li>t1先操作
开始事务拿到本地锁--&gt;修改表中数据--&gt;提交本地事务前，拿到全局锁--&gt;本地提交释放本地锁</li>
<li>t2紧接操作
开始事务拿到本地锁--&gt;修改表中数据--&gt;提交本地事务前，请求全局锁</li>
<li>如果这个时候，t1进行本地回滚，则不会释放全局锁，而是尝试获取本地锁，
而t2将一直请求全局锁，直到请求超时，回滚并放弃请求全局锁及释放本地锁，
t2释放本地锁后，t1获取到本地锁，回滚成功</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="手动提交事务">手动提交事务<a href="#手动提交事务" class="hash-link" aria-label="手动提交事务的直接链接" title="手动提交事务的直接链接">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Autowired</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DataSourceTransactionManager transactionManager;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void test() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //获取事务定义</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DefaultTransactionDefinition def = new DefaultTransactionDefinition();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //设置事务隔离级别，开启新事务</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    def.setPropagationBehavior(TransactionDefinition.PROPAGATION_REQUIRES_NEW);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //获取事务状态，开始事务</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TransactionStatus transactionStatus = transactionManager.getTransaction(def);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //提交事务</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transactionManager.commit(transactionStatus);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //回滚事务</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transactionManager.rollback(transactionStatus);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="jdbc事务">JDBC事务<a href="#jdbc事务" class="hash-link" aria-label="JDBC事务的直接链接" title="JDBC事务的直接链接">​</a></h4>
<ul>
<li>JDBC 事务是用 Connection 对象控制的。JDBC Connection 接口（ java.sql.Connection ）提供了两种事务模式：自动提交和手工提交。</li>
<li>java.sql.Connection 提供了以下控制事务的方法：
<code>public void setAutoCommit(boolean)</code>
<code>public boolean getAutoCommit()</code>
<code>public void commit()</code>
<code>public void rollback()</code></li>
<li>使用 JDBC 事务界定时，您可以将多个 SQL 语句结合到一个事务中。
JDBC 事务的一个缺点是事务的范围局限于一个数据库连接。一个 JDBC 事务不能跨越多个数据库。</li>
<li>JDBC定义了SavePoint接口，提供在一个更细粒度的事务控制机制。当设置了一个保存点后，可以rollback到该保存点处的状态，而不是rollback整个事务。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="minio">MinIO<a href="#minio" class="hash-link" aria-label="MinIO的直接链接" title="MinIO的直接链接">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 下载地址</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https:</span><span class="token comment" style="color:#999988;font-style:italic">//min.io/download#/windows</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 操作文档</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https:</span><span class="token comment" style="color:#999988;font-style:italic">//www.macrozheng.com/mall/reference/minio.html</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 启动</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">minio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exe server D:\hayes\minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">--访问</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//localhost:9000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">io.minio</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">minio</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">8.4.6</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.squareup.okhttp3</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">okhttp</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">4.9.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pagehelper">PageHelper<a href="#pagehelper" class="hash-link" aria-label="PageHelper的直接链接" title="PageHelper的直接链接">​</a></h3>
<p>使用文档：<a href="https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.md" target="_blank" rel="noopener noreferrer">https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.md</a></p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 物理分页插件 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.github.pagehelper</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">pagehelper</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">5.3.2</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PageHelper.startPage(pageNum, pageSize);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//之后进行查询操作将自动进行分页</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List&lt;PmsBrand&gt; brandList = brandMapper.selectByExample(new PmsBrandExample());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//通过构造PageInfo对象获取分页信息，如当前页码，总页数，总条数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PageInfo&lt;PmsBrand&gt; pageInfo = new PageInfo&lt;&gt;(list);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="跨域">跨域<a href="#跨域" class="hash-link" aria-label="跨域的直接链接" title="跨域的直接链接">​</a></h3>
<p>跨域（Cross-Origin Resource Sharing, CORS）是指一个网页发起的请求，其资源位于不同的域、协议或端口。例如，<code>http://example.com</code> 的网页试图访问 <code>http://api.example.com</code>，这就是一次跨域请求。</p>
<p>浏览器基于安全原因，对跨域请求做了限制，防止恶意网站在未经授权的情况下获取用户数据。这种安全策略被称为“同源策略（Same-Origin Policy）”。同源策略规定，只有在相同的协议、域名和端口下，才能共享数据。</p>
<p>复杂的跨越请求需要先进行一次OPTIONS请求进行预检，我们的应用整合SpringSecurity，对OPTIONS请求需要放开登录认证。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cors工作原理">CORS工作原理<a href="#cors工作原理" class="hash-link" aria-label="CORS工作原理的直接链接" title="CORS工作原理的直接链接">​</a></h4>
<p>CORS 的核心在于服务器通过设置 HTTP 头来告诉浏览器允许跨域请求。常见的 CORS 相关 HTTP 头包括：</p>
<ol>
<li><strong>Access-Control-Allow-Origin</strong>：指定允许访问资 源的外域 URL。</li>
<li><strong>Access-Control-Allow-Methods</strong>：指定允许的请求方法，如 GET、POST 等。</li>
<li><strong>Access-Control-Allow-Headers</strong>：指定允许的请求头。</li>
<li><strong>Access-Control-Allow-Credentials</strong>：指示是否允许发送 Cookie。</li>
<li><strong>Access-Control-Expose-Headers</strong>：列出哪些响应头可以暴露给前端应用。</li>
<li><strong>Access-Control-Max-Age</strong>：指示在缓存预检请求的结果期间，浏览器可以缓存结果的时间（以秒为单位）。</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="预检请求">预检请求<a href="#预检请求" class="hash-link" aria-label="预检请求的直接链接" title="预检请求的直接链接">​</a></h4>
<p>对于复杂请求（如包含自定义头的 POST 请求），浏览器会在正式请求之前发送一个 OPTIONS 请求（预检请求）以确定服务器是否允许该请求。服务器在预检请求中设置相应的 CORS 头，以告知浏览器请求是否被允许。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.bind.annotation.CrossOrigin;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.bind.annotation.RequestMapping;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.bind.annotation.RequestMethod;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.bind.annotation.RestController;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@RestController</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyController {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @CrossOrigin(origins = &quot;http://example.com&quot;, methods = {RequestMethod.GET, RequestMethod.POST})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @RequestMapping(&quot;/my-endpoint&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String myEndpoint() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &quot;Hello, CORS!&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="解决跨域">解决跨域<a href="#解决跨域" class="hash-link" aria-label="解决跨域的直接链接" title="解决跨域的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="cors跨域推荐">CORS跨域（推荐）<a href="#cors跨域推荐" class="hash-link" aria-label="CORS跨域（推荐）的直接链接" title="CORS跨域（推荐）的直接链接">​</a></h5>
<p>方式一：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.context.annotation.Bean;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.context.annotation.Configuration;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.servlet.config.annotation.CorsRegistry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class WebConfig implements WebMvcConfigurer {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void addCorsMappings(CorsRegistry registry) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        registry.addMapping(&quot;/**&quot;) // 允许跨域的路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .allowedOrigins(&quot;http://example.com&quot;) // 允许跨域的域名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .allowedMethods(&quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;) // 允许跨域的方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .allowedHeaders(&quot;*&quot;) // 允许所有请求头</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .allowCredentials(true); // 允许携带凭证</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>方式二：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.context.annotation.Bean;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.context.annotation.Configuration;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.cors.CorsConfiguration;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.cors.UrlBasedCorsConfigurationSource;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.filter.CorsFilter;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * 全局跨域配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class GlobalCorsConfig {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 允许跨域调用的过滤器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public CorsFilter corsFilter() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CorsConfiguration config = new CorsConfiguration();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //允许所有域名进行跨域调用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        config.addAllowedOrigin(&quot;*&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //允许跨越发送cookie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        config.setAllowCredentials(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //放行全部原始头信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        config.addAllowedHeader(&quot;*&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //允许所有请求方法跨域调用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        config.addAllowedMethod(&quot;*&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        source.registerCorsConfiguration(&quot;/**&quot;, config);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new CorsFilter(source);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 设置SpringSecurity允许OPTIONS请求访问</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 在SecurityConfig类的configure(HttpSecurity httpSecurity)方法中添加如下代码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">antMatchers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">HttpMethod</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">OPTIONS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">//跨域请求会先进行一次options请求</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">permitAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="gateway跨域">Gateway跨域<a href="#gateway跨域" class="hash-link" aria-label="Gateway跨域的直接链接" title="Gateway跨域的直接链接">​</a></h5>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//跨域问题, 核心是需要在请求头带上Access-control-Allow-Origin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">protected boolean preHandle(ServletRequest request, ServletResponse response){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HttpServletRequest httpServletRequest = (HttpServletRequest) request;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HttpServletResponse httpServletResponse = (HttpServletResponse) response;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if(allowOrigin){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        httpServletResponse.setHeader(&quot;Access-control-Allow-Origin&quot;, &quot;*&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        httpServletResponse.setHeader(&quot;Access-Control-Allow-Methods&quot;, &quot;GET,POST,OPTIONS,PUT,DELETE&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        httpServletResponse.setHeader(&quot;Access-Control-Allow-Headers&quot;, httpServletRequest.getHeader(&quot;Access-Control-Request-Headers&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //update-begin-author:scott date:20200907 for:issues/I1TAAP 前后端分离，shiro过滤器配置引起的跨域问题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 是否允许发送Cookie，默认Cookie不包括在CORS请求之中。设为true时，表示服务器允许Cookie包含在请求中。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        httpServletResponse.setHeader(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //update-end-author:scott date:20200907 for:issues/I1TAAP 前后端分离，shiro过滤器配置引起的跨域问题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 跨域时会首先发送一个option请求，这里我们给option请求直接返回正常状态</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (httpServletRequest.getMethod().equals(RequestMethod.OPTIONS.name())) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        httpServletResponse.setStatus(HttpStatus.OK.value());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //update-begin-author:taoyan date:20200708 for: 多租户用到</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String tenant_id = httpServletRequest.getHeader(CommonConstant.TENANT_ID);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TenantContext.setTenant(tenant_id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //update-end-author:taoyan date:20200708 for:多租户用到</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return super.preHandle(request, response);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="同源代理跨域">同源代理跨域<a href="#同源代理跨域" class="hash-link" aria-label="同源代理跨域的直接链接" title="同源代理跨域的直接链接">​</a></h5>
<p>通过在同源服务器上设置代理，将跨域请求转发给目标服务器，从而绕过浏览器的同源策略。</p>
<p>在 Spring Boot 中，可以使用 <code>WebClient</code> 或 <code>RestTemplate</code> 作为代理客户端。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@RestController</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@RequestMapping(&quot;/api&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ProxyController {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @GetMapping(&quot;/data&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ResponseEntity&lt;String&gt; getData() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RestTemplate restTemplate = new RestTemplate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String result = restTemplate.getForObject(&quot;http://example.com/api/data&quot;, String.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ResponseEntity.ok(result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dubbozookeeper">Dubbo+zookeeper<a href="#dubbozookeeper" class="hash-link" aria-label="Dubbo+zookeeper的直接链接" title="Dubbo+zookeeper的直接链接">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gaea实现读写分离">Gaea实现读写分离<a href="#gaea实现读写分离" class="hash-link" aria-label="Gaea实现读写分离的直接链接" title="Gaea实现读写分离的直接链接">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="charles抓包工具">Charles（抓包工具）<a href="#charles抓包工具" class="hash-link" aria-label="Charles（抓包工具）的直接链接" title="Charles（抓包工具）的直接链接">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 网络抓包</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 地址</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">www</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">charlesproxy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 注册码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https:</span><span class="token comment" style="color:#999988;font-style:italic">//www.zzzmode.com/mytools/charles/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="任务调度">任务调度<a href="#任务调度" class="hash-link" aria-label="任务调度的直接链接" title="任务调度的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="quartz">Quartz<a href="#quartz" class="hash-link" aria-label="Quartz的直接链接" title="Quartz的直接链接">​</a></h4>
<p>Quartz是一款功能强大的开源任务调度框架，几乎可以集成到任何Java应用程序中（小到单机应用，大到分布式应用）。</p>
<p>Quartz可用于创建简单或复杂的任务调度，用以执行数以万计的任务。任务被定义为标准化的Java组件，Java编写的任务都可以被执行。</p>
<p>组件角色</p>
<ul>
<li>Scheduler（调度器）
Quartz中的任务调度器，通过Trigger和JobDetail可以用来调度、暂停和删除任务</li>
<li>Trigger（触发器）
Quartz中的触发器，可以通过CRON表达式来指定任务执行的时间，时间到了会自动触发任务执行</li>
<li>JobDetail（任务详情）
Quartz中需要执行的任务详情，包括了任务的唯一标识和具体要执行的任务，可以通过JobDataMap往任务中传递数据</li>
<li>Job（任务）
Quartz中具体的任务，包含了执行任务的具体方法</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="http">HTTP<a href="#http" class="hash-link" aria-label="HTTP的直接链接" title="HTTP的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="身份认证">身份认证<a href="#身份认证" class="hash-link" aria-label="身份认证的直接链接" title="身份认证的直接链接">​</a></h4>
<p>HTTP身份认证的方式有很多：Basic、Bearer、Digest、HOBA、Mutual、Negotiate / NTLM、VAPID、SCRAM、AWS4-HMAC-SHA256、OAuth。</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="基本basic认证">基本(Basic)认证<a href="#基本basic认证" class="hash-link" aria-label="基本(Basic)认证的直接链接" title="基本(Basic)认证的直接链接">​</a></h5>
<ol>
<li>当请求的资源需要 BASIC 认证时，服务器会随状态码 401 Authorization Required，返回带WWW-Authenticate首部字段的响应。该字段内包含认证的方式（BASIC）及Request-URI安全域字符串（realm）。</li>
<li>接收到状态码401的客户端为了通过BASIC 认证，需要将用户ID及密码发送给服务器。发送的字符串内容是由用户ID和密码构成，两者中间以冒号（:）连接后，再经过 Base64 编码处理（如guest<!-- -->:guest<!-- -->）。</li>
<li>接收到包含首部字段 Authorization 请求的服务器，会对认证信息的正确性进行验证。如验证通过，则返回一条包含 Request-URI资源的响应。</li>
</ol>
<p>缺陷：BASIC 认证虽然采用 Base64 编码方式，但这不是加密处理，由于明文解码后就是用户 ID 和密码，在 HTTP 等非加密通信的线路上进行 BASIC 认证的过程中，如果被人窃听，被盗的可能性极高。另外，除此 之外想再进行一次 BASIC 认证时，一般的浏览器却无法实现认证注销操作，这也是问题之一。</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="摘要digest认证">摘要(Digest)认证<a href="#摘要digest认证" class="hash-link" aria-label="摘要(Digest)认证的直接链接" title="摘要(Digest)认证的直接链接">​</a></h5>
<p>为弥补 BASIC 认证存在的弱点，从 HTTP/1.1 起就有了 DIGEST 认证。 DIGEST 认证同样使用质询 / 响应的方式（challenge/response），但不会像 BASIC 认证那样直接发送明文密码。所谓质询响应方式是指，一开始一方会先发送认证要求给另一方，接着使用从另一方那接收到的质询码计算生成响应码。最后将响应码返回给对方进行认证的方式。</p>
<ol>
<li>请求需认证的资源时，服务器会随着状态码 401 Authorization Required，返回带 WWW-Authenticate 首部字段的响应。该字段内包含质问响应方式认证所需的临时质询码（随机数，nonce）。首部字段 WWW-Authenticate 内必须包含 realm 和 nonce 这两个字段的信息。客户端就是依靠向服务器回送这两个值进行认证的。nonce 是一种每次随返回的 401 响应生成的任意随机字符串。该字符串通常推荐由 Base64 编码的十六进制数的组成形式，但实际内容依赖服务器的具体实现。</li>
<li>接收到 401 状态码的客户端，返回的响应中包含 DIGEST 认证必须的首部字段 Authorization 信息。首部字段 Authorization 内必须包含 username、realm、nonce、uri 和 response 的字段信息。其中，realm 和 nonce 就是之前从服务器接收到的响应中的字段。username是realm限定范围内可进行认证的用户名。uri（digest-uri）即 Request-URI 的值，但考虑到经代理转发后 Request-URI 的值可能被修改，因此事先会复制一份副本保存在 uri 内。response 也可叫做 Request-Digest，存放经过 MD5 运算后的密码字符串，形成  响应码。</li>
<li>接收到包含首部字段 Authorization 请求的服务器，会确认认证信息的正确性。认证通过后则返回包含 Request-URI 资源的响应。并且这时会在首部字段 Authentication-Info 写入一些认证成功的相关信息。</li>
</ol>
<p>缺陷：DIGEST 认证提供了高于 BASIC 认证的安全等级，但是和 HTTPS 的客户端认证相比仍旧很弱。DIGEST 认证提供防止密码被窃听的保护机制，但并不存在防止用户伪装的保护机制。DIGEST 认证和 BASIC 认证一样，使用上不那么便捷灵活，且仍达不到多数 Web 网站对高度安全等级的追求标准。因此它的适用范围也有所受限。</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="基于表单form-based的ssl客户端认证">基于表单(Form-Based)的SSL客户端认证<a href="#基于表单form-based的ssl客户端认证" class="hash-link" aria-label="基于表单(Form-Based)的SSL客户端认证的直接链接" title="基于表单(Form-Based)的SSL客户端认证的直接链接">​</a></h5>
<p>从使用用户 ID 和密码的认证方式方面来讲，只要二者的内容正确，即可认证是本人的行为。但如果用户 ID 和密码被盗，就很有可能被第三者冒充。利用 SSL 客户端认证则可以避免该情况的发生。SSL 客户端认证是借由 HTTPS 的客户端证书完成认证的方式。凭借 SSL 客户端证书认证，服务器可确认访问是否来自已登录的客户端。</p>
<p>为达到 SSL 客户端认证的目的，需要事先将客户端证书分发给客户端，且客户端必须安装此证书。</p>
<ol>
<li>接收到需要认证资源的请求，服务器会发送 Certificate Request 报文，要求客户端提供客户端证书。</li>
<li>用户选择将发送的客户端证书后，客户端会把客户端证书信息以 Client Certificate 报文方式发送给服务器。</li>
<li>服务器验证客户端证书验证通过后方可领取证书内客户端的165公开密钥，然后 开始 HTTPS 加密通信
在多数情况下，SSL 客户端认证不会仅依靠证书完成认证，一般会和基于表单认证组合形成一种双因素认证（Two-factor authentication）来使用。所谓双因素认证就是指，认证过程中不仅需要密码这一个因素，还需要申请认证者提供其他持有信息，从而作为另一个因素，与其组合使用的认证方式。换言之，第一个认证因素的 SSL 客户端证书用来认证客户端计算机，另一个认证因素的密码则用来确定这是用户本人的行为。通过双因素认证后，就可以确认是用户本人正在使用匹配正确的计算机访问服务器。</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="http请求">HTTP请求<a href="#http请求" class="hash-link" aria-label="HTTP请求的直接链接" title="HTTP请求的直接链接">​</a></h4>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- http默认超时时间为20s --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.httpcomponents</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">httpclient</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">4.5.5</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="常用http请求">常用HTTP请求<a href="#常用http请求" class="hash-link" aria-label="常用HTTP请求的直接链接" title="常用HTTP请求的直接链接">​</a></h5>
<ol>
<li>
<p>创建HttpClient实例</p>
<p><code>HttpClient client = HttpClientBuilder.create().build();</code></p>
</li>
<li>
<p>创建请求方法的实例</p>
<ul>
<li>
<p>POST请求</p>
<p><code>HttpPost post = new HttpPost(url);</code></p>
</li>
<li>
<p>GET请求，URL中带请求参数</p>
<p><code>HttpGet get = new HttpGet(url);</code></p>
</li>
</ul>
</li>
<li>
<p>添加请求参数</p>
<ul>
<li>普通形式</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">List&lt;NameValuePair&gt; list = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list.add(new BasicNameValuePair(&quot;username&quot;, &quot;admin&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list.add(new BasicNameValuePair(&quot;password&quot;, &quot;123456&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// GET请求方式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 由于GET请求的参数是拼装在URL后方，所以需要构建一个完整的URL，再创建HttpGet实例</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">URIBuilder uriBuilder = new URIBuilder(&quot;http://www.baidu.com&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uriBuilder.setParameters(list);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HttpGet get = new HttpGet(uriBuilder.build());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// POST请求方式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">post.setEntity(new UrlEncodedFormEntity(list, Charsets.UTF_8));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>JSON形式</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;String,String&gt; map = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">map.put(&quot;username&quot;, &quot;admin&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">map.put(&quot;password&quot;, &quot;123456&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gson gson = new Gson();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String json = gson.toJson(map, new TypeToken&lt;Map&lt;String, String&gt;&gt;() {}.getType());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">post.setEntity(new StringEntity(json, Charsets.UTF_8));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">post.addHeader(&quot;Content-Type&quot;, &quot;application/json;charset=UTF-8&quot;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>发送请求
<code>HttpResponse response = client.execute(post);</code></p>
</li>
<li>
<p>获取结果
<code>String result = EntityUtils.toString(response.getEntity());</code></p>
</li>
<li>
<p>释放连接
<code>post.releaseConnection();</code></p>
</li>
</ol>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="带证书http请求">带证书HTTP请求<a href="#带证书http请求" class="hash-link" aria-label="带证书HTTP请求的直接链接" title="带证书HTTP请求的直接链接">​</a></h5>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public static String sendRedEnvelope(String url, String param) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //PKCS12的密码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String PKCS12 = &quot;1340026302&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //证书地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String fileRoute = &quot;E:\\javacore1\\WXYE\\src\\apiclient_cert.p12&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //指定读取证书格式为PKCS12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    KeyStore keyStore = KeyStore.getInstance(&quot;PKCS12&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //读取本机存放的PKCS12证书文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FileInputStream instream = new FileInputStream(new File(fileRoute));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //指定PKCS12的密码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        keyStore.load(instream, PKCS12.toCharArray());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        instream.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //指定TLS版本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SSLContext sslcontext = SSLContexts.custom()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .loadKeyMaterial(keyStore, PKCS12.toCharArray())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //设置httpclient的SSLSocketFactory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SSLConnectionSocketFactory sslsf = new SSLConnectionSocketFactory(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sslcontext,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //这里无需改动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new String[]{&quot;TLSv1&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SSLConnectionSocketFactory.BROWSER_COMPATIBLE_HOSTNAME_VERIFIER);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CloseableHttpClient httpclient = HttpClients.custom()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .setSSLSocketFactory(sslsf)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    StringBuffer stringBuffer = new StringBuffer();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HttpPost httpPost = new HttpPost(url);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        InputStream is = new ByteArrayInputStream(param.getBytes(&quot;UTF-8&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //InputStreamEntity严格是对内容和长度相匹配的。用法和BasicHttpEntity类似</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        InputStreamEntity inputStreamEntity = new InputStreamEntity(is, is.available());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        httpPost.setEntity(inputStreamEntity);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CloseableHttpResponse response = httpclient.execute(httpPost);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            HttpEntity entity = response.getEntity();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            BufferedReader reader = new BufferedReader(new InputStreamReader(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                entity.getContent(), &quot;UTF-8&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String inputLine;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while ((inputLine = reader.readLine()) != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                stringBuffer.append(inputLine);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.out.println(stringBuffer);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            response.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        httpclient.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return stringBuffer.toString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mapstruct">MapStruct<a href="#mapstruct" class="hash-link" aria-label="MapStruct的直接链接" title="MapStruct的直接链接">​</a></h3>
<p>MapStruct是一款基于Java注解的对象属性映射工具</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="插件">插件<a href="#插件" class="hash-link" aria-label="插件的直接链接" title="插件的直接链接">​</a></h4>
<p>MapStruct Support</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="依赖">依赖<a href="#依赖" class="hash-link" aria-label="依赖的直接链接" title="依赖的直接链接">​</a></h4>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!--MapStruct相关依赖--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mapstruct</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mapstruct</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${mapstruct.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--排查编译的 Lombok、Mapstruct --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">plugin</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.maven.plugins</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">maven-compiler-plugin</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">3.8.1</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">configuration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">source</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.8</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">source</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">target</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.8</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">target</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">annotationProcessorPaths</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">path</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.mapstruct</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">mapstruct-processor</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${org.mapstruct.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">path</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">path</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${lombok.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">path</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- This is needed when using Lombok 1.18.16 and above --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">path</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.projectlombok</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">lombok-mapstruct-binding</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">0.2.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">path</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">annotationProcessorPaths</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">configuration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">plugin</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用">使用<a href="#使用" class="hash-link" aria-label="使用的直接链接" title="使用的直接链接">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="基本映射">基本映射<a href="#基本映射" class="hash-link" aria-label="基本映射的直接链接" title="基本映射的直接链接">​</a></h5>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Mapper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface MemberMapper {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MemberMapper INSTANCE = Mappers.getMapper(MemberMapper.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;phone&quot;,target = &quot;phoneNumber&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;birthday&quot;,target = &quot;birthday&quot;,dateFormat = &quot;yyyy-MM-dd&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MemberDto toDto(Member member);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="集合映射">集合映射<a href="#集合映射" class="hash-link" aria-label="集合映射的直接链接" title="集合映射的直接链接">​</a></h5>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Mapper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface MemberMapper {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MemberMapper INSTANCE = Mappers.getMapper(MemberMapper.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;phone&quot;,target = &quot;phoneNumber&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;birthday&quot;,target = &quot;birthday&quot;,dateFormat = &quot;yyyy-MM-dd&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    List&lt;MemberDto&gt; toDtoList(List&lt;Member&gt; list);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="子对象映射">子对象映射<a href="#子对象映射" class="hash-link" aria-label="子对象映射的直接链接" title="子对象映射的直接链接">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Mapper(uses = {MemberMapper.class,ProductMapper.class})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface OrderMapper {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    OrderMapper INSTANCE = Mappers.getMapper(OrderMapper.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;member&quot;,target = &quot;memberDto&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;productList&quot;,target = &quot;productDtoList&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    OrderDto toDto(Order order);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="合并映射">合并映射<a href="#合并映射" class="hash-link" aria-label="合并映射的直接链接" title="合并映射的直接链接">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//把多个对象属性映射到一个对象中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Mapper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface MemberMapper {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MemberMapper INSTANCE = Mappers.getMapper(MemberMapper.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;member.phone&quot;,target = &quot;phoneNumber&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;member.birthday&quot;,target = &quot;birthday&quot;,dateFormat = &quot;yyyy-MM-dd&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;member.id&quot;,target = &quot;id&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;order.orderSn&quot;, target = &quot;orderSn&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;order.receiverAddress&quot;, target = &quot;receiverAddress&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MemberOrderDto toMemberOrderDto(Member member, Order order);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用依赖注入">使用依赖注入<a href="#使用依赖注入" class="hash-link" aria-label="使用依赖注入的直接链接" title="使用依赖注入的直接 链接">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//想要使用依赖注入，我们只要将@Mapper注解的componentModel参数设置为spring即可，这样在生成接口实现类时，MapperStruct会为其添加@Component注解</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Mapper(componentModel = &quot;spring&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface MemberSpringMapper {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;phone&quot;,target = &quot;phoneNumber&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;birthday&quot;,target = &quot;birthday&quot;,dateFormat = &quot;yyyy-MM-dd&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MemberDto toDto(Member member);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用常量默认值和表达式">使用常量、默认值和表达式<a href="#使用常量默认值和表达式" class="hash-link" aria-label="使用常量、默认值和表达式的直接链接" title="使用常量、默认值和表达式的直接链接">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Mapper(imports = {UUID.class})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface ProductMapper {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ProductMapper INSTANCE = Mappers.getMapper(ProductMapper.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(target = &quot;id&quot;,constant = &quot;-1L&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;count&quot;,target = &quot;count&quot;,defaultValue = &quot;1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(target = &quot;productSn&quot;,expression = &quot;java(UUID.randomUUID().toString())&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ProductDto toDto(Product product);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="在映射前后进行自定义处理">在映射前后进行自定义处理<a href="#在映射前后进行自定义处理" class="hash-link" aria-label="在映射前后进行自定义处理的直接链接" title="在映射前后进行自定义处理的直接链接">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//此时我们需要创建自定义处理方法，创建一个抽象类ProductRoundMapper，通过@BeforeMapping注解自定义映射前操作，通过@AfterMapping注解自定义映射后操作；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Mapper(imports = {UUID.class},componentModel = &quot;spring&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public abstract class ProductRoundMapper {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 对象映射</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param product product对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return 映射后的对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(target = &quot;id&quot;,constant = &quot;-1L&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;count&quot;,target = &quot;count&quot;,defaultValue = &quot;1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(target = &quot;productSn&quot;,expression = &quot;java(UUID.randomUUID().toString())&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public abstract ProductDto toDto(Product product);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 前置操作</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param product 映射前的对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @BeforeMapping</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void beforeMapping(Product product){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //映射前当price&lt;0时设置为0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(product.getPrice().compareTo(BigDecimal.ZERO)&lt;0){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            product.setPrice(BigDecimal.ZERO);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 后置操作</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param productDto 映射后的对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @AfterMapping</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void afterMapping(@MappingTarget ProductDto productDto){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //映射后设置当前时间为createTime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        productDto.setCreateTime(new Date());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="处理映射异常">处理映射异常<a href="#处理映射异常" class="hash-link" aria-label="处理映射异常的直接链接" title="处理映射异常的直接链接">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//自定义异常类</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ProductValidatorException extends Exception{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ProductValidatorException(String message) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        super(message);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//自定义校验类</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ProductValidator {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public BigDecimal validatePrice(BigDecimal price) throws ProductValidatorException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(price.compareTo(BigDecimal.ZERO)&lt;0){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new ProductValidatorException(&quot;价格不能小于0！&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return price;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Mapper(uses = {ProductValidator.class},imports = {UUID.class},componentModel = &quot;spring&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface ProductExceptionMapper {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(target = &quot;id&quot;,constant = &quot;-1L&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(source = &quot;count&quot;,target = &quot;count&quot;,defaultValue = &quot;1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mapping(target = &quot;productSn&quot;,expression = &quot;java(UUID.randomUUID().toString())&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ProductDto toDto(Product product) throws ProductValidatorException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>[!Warning]</p>
<p>Mapper-struct存在问题，跟lombok在配合的时候会出现问题，如果mapperStruct的依赖放在lombok的依赖上面就会出现在对象复制的时候，会将原有数据全变为null的情况，所以一定要将lombok的依赖放在mapperStruct上面？</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="本地缓存">本地缓存<a href="#本地缓存" class="hash-link" aria-label="本地缓存的直接链接" title="本地缓存的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="guava-cache">Guava Cache<a href="#guava-cache" class="hash-link" aria-label="Guava Cache的直接链接" title="Guava Cache的直接链接">​</a></h4>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.google.guava</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">guava</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">28.1-jre</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>LoadingCache build(CacheLoader loader)：缓存加载器。</li>
<li>CacheBuilder.maximumSize(long size)：配置缓存数量上限。</li>
<li>expireAfterAccess(long duration, TimeUnit unit)：缓存项在给定时间内没有被读/写访问则回收。</li>
<li>expireAfterWrite(long duration, TimeUnit unit)：缓存项在给定时间内没有被写访问(创建或覆盖)则回收。</li>
<li>refreshAfterWrite(long duration, TimeUnit unit)：定时刷新。</li>
<li>removalListener(RemovalListener  listener)：移除监听器，缓存项被移除时会触发。</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">removalListener(new RemovalListener &lt;Long, String&gt;() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//移除监听器,缓存项被移除时会触发</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void onRemoval(RemovalNotification&lt;Long, String&gt; rn) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    	//执行逻辑操作</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>recordStats()：开启Guava Cache的统计功能。</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">LoadingCache&lt;String, RateLimiter&gt; ipRequestCaches = CacheBuilder.newBuilder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .maximumSize(1000)// 设置缓存个数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .expireAfterWrite(1, TimeUnit.MINUTES)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .build(new CacheLoader&lt;String, Object&gt;() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public Object load(String s) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return RateLimiter.create(5);// 新的IP初始化 (限流每秒5个令牌响应,)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public Object getIPLimiter(String ipAddr) throws ExecutionException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return ipRequestCaches.get(ipAddr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>get(String str)：获取缓存值。</li>
<li>put(Long key, String value)：设置缓存值。</li>
<li>remove(Long key)：移除缓存值。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="java内存模型">Java内存模型<a href="#java内存模型" class="hash-link" aria-label="Java内存模型的直接链接" title="Java内存模型的直接链接">​</a></h3>
<p>内存模型限制的是共享变量，也就是存储在堆内存中的变量，在 Java 语言中，所有的实例变量、静态变量和数组元素都存储在堆内存之中。方法参数、异常处理参数这些局部变量存储在方法栈帧之中，因此不会在线程之间共享，不会受到内存模型影响，也不存在内存可见性问题。</p>
<img src="https://hayes-typora.oss-cn-shenzhen.aliyuncs.com/image-20211102115340611.png" alt="image-20211102115340611" width="50%">
<p>线程 A 把在本地内存更新后的共享变量副本的值，刷新到主内存中。线程 B 在使用到该共享变量时，到主内存  中去读取线程 A 更新后的共享变量的值，并更新线程 B 本地内存的值。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="webclient">WebClient<a href="#webclient" class="hash-link" aria-label="WebClient的直接链接" title="WebClient的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="webclient和resttemplate">WebClient和RestTemplate<a href="#webclient和resttemplate" class="hash-link" aria-label="WebClient和RestTemplate的直接链接" title="WebClient和RestTemplate的直接链接">​</a></h4>
<p>区别</p>
<ol>
<li>RestTemplate阻塞客户端，WebClient非阻塞客户端</li>
<li>RestTemplate为每个事件（HTTP 调用）使用调用者线程。WebClient将为每个事件创建类似“任务”的东西。在幕后，Reactive 框架将对这些“任务”进行排队，并仅在适当的响应可用时才执行它们。</li>
</ol>
<p>使用</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public Flux&lt;Tweet&gt; getTweetsNonBlocking() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log.info(&quot;Starting NON-BLOCKING Controller!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Flux&lt;Tweet&gt; tweetFlux = WebClient.create()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .get()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .uri(getSlowServiceUri())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .retrieve()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .bodyToFlux(Tweet.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tweetFlux.subscribe(tweet -&gt; log.info(tweet.toString()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log.info(&quot;Exiting NON-BLOCKING Controller!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return tweetFlux;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="jmeter">jmeter<a href="#jmeter" class="hash-link" aria-label="jmeter的直接链接" title="jmeter的直接链接">​</a></h3>
<ol>
<li>添加线程组</li>
<li>添加HTTP请求</li>
<li>添加察看结果树</li>
<li>HTTP信息头管理器 -- 设置发送application/json请求</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="k8skubernetes">k8s(kubernetes)<a href="#k8skubernetes" class="hash-link" aria-label="k8s(kubernetes)的直接链接" title="k8s(kubernetes)的直接链接">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="多线程">多线程<a href="#多线程" class="hash-link" aria-label="多线程的直接链接" title="多线程的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="手动创建线程池">手动创建线程池<a href="#手动创建线程池" class="hash-link" aria-label="手动创建线程池的直接链接" title="手动创建线程池的直接链接">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import com.google.common.util.concurrent.ThreadFactoryBuilder;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.concurrent.LinkedBlockingQueue;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.concurrent.ThreadPoolExecutor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.concurrent.ExecutorService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.concurrent.ThreadFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.concurrent.TimeUnit;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//引入依赖包，创建线程池</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private ThreadFactory namedThreadFactory = new ThreadFactoryBuilder().setNameFormat(&quot;thread-call-runner-%d&quot;).build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private ExecutorService taskExe = new ThreadPoolExecutor(10,20,200L,TimeUnit.MILLISECONDS,new LinkedBlockingQueue&lt;Runnable&gt;(),namedThreadFactory);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">taskExe.execute(new Runnable() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void run() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //业务处理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="等待线程执行完成">等待线程执行完成<a href="#等待线程执行完成" class="hash-link" aria-label="等待线程执行完成的直接链接" title="等待线程执行完成的直接链接">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//调用await()方法  的线程会被挂起，它会等待直到count值为0才继续执行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void await() throws InterruptedException { };   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//和await()类似，只不过等待一定的时间后count值还没变为0的话就会继续执行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public boolean await(long timeout, TimeUnit unit) throws InterruptedException { };  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//将count值减1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void countDown() { }; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.concurrent.CountDownLatch;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.concurrent.ExecutorService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.concurrent.Executors;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CountDownLatchTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        final CountDownLatch latch = new CountDownLatch(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;主线程开始执行…… ……&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //第一个子线程执行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //ExecutorServiceJava提供的线程池方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ExecutorService es1 = Executors.newSingleThreadExecutor();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        es1.execute(new Runnable() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            public void run() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Thread.sleep(3000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    System.out.println(&quot;子线程：&quot;+Thread.currentThread().getName()+&quot;执行&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                } catch (InterruptedException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                latch.countDown();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        es1.shutdown();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //第二个子线程执行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ExecutorService es2 = Executors.newSingleThreadExecutor();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        es2.execute(new Runnable() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            public void run() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Thread.sleep(3000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                } catch (InterruptedException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.out.println(&quot;子线程：&quot;+Thread.currentThread().getName()+&quot;执行&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                latch.countDown();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        es2.shutdown();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;等待两个线程执行完毕…… ……&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            latch.await();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (InterruptedException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;两个子线程都执行完毕，继续执行主线程&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bpmn">BPMN<a href="#bpmn" class="hash-link" aria-label="BPMN的直接链接" title="BPMN的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="事件events">事件（Events）<a href="#事件events" class="hash-link" aria-label="事件（Events）的直接链接" title="事件（Events）的直接链接">​</a></h4>
<p>指的是在业务流程的运行过程中发生的事情</p>
<ul>
<li>开始：表示一个流程的开始</li>
<li>中间：发生的开始和结束事件之间，影响处理的流程</li>
<li>结束：表示该过程结束</li>
</ul>
<img src="https://hayes-typora.oss-cn-shenzhen.aliyuncs.com/BPMN-%E4%BA%8B%E4%BB%B6.png" width="50%">
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="活动activities">活动（Activities）<a href="#活动activities" class="hash-link" aria-label="活动（Activities）的直接链接" title="活动（Activities）的直接链接">​</a></h4>
<p>包括任务和子流程两类。子流程在图形的下方中间外加一个小加号（+）来区分。</p>
<img src="https://hayes-typora.oss-cn-shenzhen.aliyuncs.com/BPMN-%E6%B4%BB%E5%8A%A8.png" width="50%">
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="网关gateways">网关（Gateways）<a href="#网关gateways" class="hash-link" aria-label="网关（Gateways）的直接链接" title="网关（Gateways）的直接链接">​</a></h4>
<p>用于表示流程的分支与合并。</p>
<ul>
<li>
<p>排他网关：只有一条路径会被选择</p>
</li>
<li>
<p>并行网关：所有路径会被同时选择。一般首尾各设置一个。</p>
</li>
<li>
<p>包容网关：可以同时执行多条线路，也可以在网关上设置条件</p>
</li>
<li>
<p>事件网关：专门为中间捕获事件设置的，允许设置多个输出流指向多个不同的中间捕获事件。</p>
<p>当流程执行到事件网关后，流程处于等待状态，需要等待抛出事件才能将等待状态转换为活动状态。</p>
</li>
</ul>
<img src="https://hayes-typora.oss-cn-shenzhen.aliyuncs.com/BPMN-%E7%BD%91%E5%85%B3.png" width="50%"></div><div id="disqus_thread"></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.dev/mhuahe/mhuahe.com/blob/master-ts/docs/java/JAVA.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--next" href="/mhuahe.com/docs/java/JAVA-Algorithm"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">JAVA-算法</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#新闻" class="table-of-contents__link toc-highlight">新闻</a><ul><li><a href="#移除netflix" class="table-of-contents__link toc-highlight">移除Netflix</a></li><li><a href="#移除oauth2" class="table-of-contents__link toc-highlight">移除oauth2</a></li><li><a href="#servlet" class="table-of-contents__link toc-highlight">servlet</a></li><li><a href="#glib" class="table-of-contents__link toc-highlight">GLIB</a></li></ul></li><li><a href="#基础知识点" class="table-of-contents__link toc-highlight">基础知识点</a><ul><li><a href="#多态" class="table-of-contents__link toc-highlight">多态</a></li><li><a href="#时间" class="table-of-contents__link toc-highlight">时间</a></li><li><a href="#集合" class="table-of-contents__link toc-highlight">集合</a><ul><li><a href="#list" class="table-of-contents__link toc-highlight">List</a></li><li><a href="#set" class="table-of-contents__link toc-highlight">Set</a></li><li><a href="#map" class="table-of-contents__link toc-highlight">Map</a></li><li><a href="#集合api" class="table-of-contents__link toc-highlight">集合API</a></li></ul></li><li><a href="#bigdecimal" class="table-of-contents__link toc-highlight">BigDecimal</a></li><li><a href="#函数式接口" class="table-of-contents__link toc-highlight">函数式接口</a></li><li><a href="#lambda" class="table-of-contents__link toc-highlight">lambda</a></li><li><a href="#代码规范" class="table-of-contents__link toc-highlight">代码规范</a></li><li><a href="#active配置" class="table-of-contents__link toc-highlight">active配置</a></li></ul></li><li><a href="#jsqlparser" class="table-of-contents__link toc-highlight">JSqlParser</a></li><li><a href="#io" class="table-of-contents__link toc-highlight">IO</a><ul><li><a href="#file" class="table-of-contents__link toc-highlight">File</a></li><li><a href="#inputstream" class="table-of-contents__link toc-highlight">InputStream</a></li><li><a href="#outputstream" class="table-of-contents__link toc-highlight">OutputStream</a></li><li><a href="#filter模式" class="table-of-contents__link toc-highlight">Filter模式</a></li><li><a href="#zip" class="table-of-contents__link toc-highlight">Zip</a></li><li><a href="#读取classpath" class="table-of-contents__link toc-highlight">读取classpath</a></li><li><a href="#序列化" class="table-of-contents__link toc-highlight">序列化</a></li><li><a href="#reader" class="table-of-contents__link toc-highlight">Reader</a></li><li><a href="#writer" class="table-of-contents__link toc-highlight">Writer</a></li><li><a href="#printstream和printwriter" class="table-of-contents__link toc-highlight">PrintStream和PrintWriter</a></li><li><a href="#files" class="table-of-contents__link toc-highlight">Files</a></li></ul></li><li><a href="#stream" class="table-of-contents__link toc-highlight">stream</a><ul><li><a href="#stream对象的创建" class="table-of-contents__link toc-highlight">Stream对象的创建</a></li><li><a href="#filter" class="table-of-contents__link toc-highlight">filter</a></li><li><a href="#map-1" class="table-of-contents__link toc-highlight">map</a></li><li><a href="#flatmap" class="table-of-contents__link toc-highlight">flatMap</a></li><li><a href="#limit" class="table-of-contents__link toc-highlight">limit</a></li><li><a href="#count" class="table-of-contents__link toc-highlight">count</a></li><li><a href="#sorted" class="table-of-contents__link toc-highlight">sorted</a></li><li><a href="#skip" class="table-of-contents__link toc-highlight">skip</a></li><li><a href="#list转成map" class="table-of-contents__link toc-highlight">List转成map</a></li><li><a href="#parallelstream" class="table-of-contents__link toc-highlight">parallelStream</a></li></ul></li><li><a href="#泛型" class="table-of-contents__link toc-highlight">泛型</a><ul><li><a href="#擦拭法" class="table-of-contents__link toc-highlight">擦拭法</a></li><li><a href="#上界通配符-extends-t" class="table-of-contents__link toc-highlight">上界通配符（? extends T）</a><ul><li><a href="#下界通配符-super-t" class="table-of-contents__link toc-highlight">下界通配符（? super T）</a></li></ul></li><li><a href="#无限定通配符" class="table-of-contents__link toc-highlight">无限定通配符</a></li><li><a href="#示例" class="table-of-contents__link toc-highlight">示例</a></li><li><a href="#泛型和反射" class="table-of-contents__link toc-highlight">泛型和反射</a></li></ul></li><li><a href="#注解" class="table-of-contents__link toc-highlight">注解</a><ul><li><a href="#inherited" class="table-of-contents__link toc-highlight">@Inherited</a></li><li><a href="#intercepts-signature" class="table-of-contents__link toc-highlight">@Intercepts @Signature</a></li><li><a href="#conditional" class="table-of-contents__link toc-highlight">@Conditional</a></li><li><a href="#requestmapping" class="table-of-contents__link toc-highlight">@RequestMapping</a></li><li><a href="#dependson" class="table-of-contents__link toc-highlight">@DependsOn</a></li><li><a href="#postconstruct" class="table-of-contents__link toc-highlight">@PostConstruct</a></li><li><a href="#async" class="table-of-contents__link toc-highlight">@Async</a></li><li><a href="#value" class="table-of-contents__link toc-highlight">@Value</a></li><li><a href="#preauthorize" class="table-of-contents__link toc-highlight">@PreAuthorize</a></li><li><a href="#builder" class="table-of-contents__link toc-highlight">@Builder</a></li><li><a href="#within-target" class="table-of-contents__link toc-highlight">@within @target</a></li><li><a href="#validated-valid" class="table-of-contents__link toc-highlight">@Validated @Valid</a><ul><li><a href="#分组校验" class="table-of-contents__link toc-highlight">分组校验</a></li><li><a href="#嵌套校验" class="table-of-contents__link toc-highlight">嵌套校验</a></li><li><a href="#集合校验" class="table-of-contents__link toc-highlight">集合校验</a></li><li><a href="#自定义校验" class="table-of-contents__link toc-highlight">自定义校验</a></li><li><a href="#编程式校验" class="table-of-contents__link toc-highlight">编程式校验</a></li><li><a href="#快速失败" class="table-of-contents__link toc-highlight">快速失败</a></li></ul></li></ul></li><li><a href="#敏感词脱敏" class="table-of-contents__link toc-highlight">敏感词脱敏</a></li><li><a href="#jenkins自动化部署" class="table-of-contents__link toc-highlight">Jenkins自动化部署</a></li><li><a href="#spi机制" class="table-of-contents__link toc-highlight">SPI机制</a></li><li><a href="#jna-jni" class="table-of-contents__link toc-highlight">JNA JNI</a></li><li><a href="#aop" class="table-of-contents__link toc-highlight">AOP</a><ul><li><a href="#相关术语" class="table-of-contents__link toc-highlight">相关术语</a><ul><li><a href="#通知advice" class="table-of-contents__link toc-highlight">通知（Advice）</a></li><li><a href="#连接点joinpoint" class="table-of-contents__link toc-highlight">连接点（JoinPoint）</a></li><li><a href="#切点pointcut" class="table-of-contents__link toc-highlight">切点（Pointcut）</a></li><li><a href="#切面aspect" class="table-of-contents__link toc-highlight">切面（Aspect）</a></li><li><a href="#引入introduction" class="table-of-contents__link toc-highlight">引入（Introduction）</a></li><li><a href="#织入weaving" class="table-of-contents__link toc-highlight">织入（Weaving）</a></li></ul></li><li><a href="#相关注解" class="table-of-contents__link toc-highlight">相关注解</a></li><li><a href="#切点表达式" class="table-of-contents__link toc-highlight">切点表达式</a></li></ul></li><li><a href="#接口文档" class="table-of-contents__link toc-highlight">接口文档</a><ul><li><a href="#springfox" class="table-of-contents__link toc-highlight">springfox</a></li><li><a href="#swagger" class="table-of-contents__link toc-highlight">swagger</a></li><li><a href="#knife4j" class="table-of-contents__link toc-highlight">knife4j</a></li><li><a href="#swagger新版本" class="table-of-contents__link toc-highlight">swagger新版本</a></li></ul></li><li><a href="#反应式编程" class="table-of-contents__link toc-highlight">反应式编程</a><ul><li><a href="#reactor框架" class="table-of-contents__link toc-highlight">Reactor框架</a><ul><li><a href="#flux和mono" class="table-of-contents__link toc-highlight">Flux和Mono</a></li><li><a href="#flux" class="table-of-contents__link toc-highlight">Flux</a></li></ul></li></ul></li><li><a href="#事务" class="table-of-contents__link toc-highlight">事务</a><ul><li><a href="#分布式事务" class="table-of-contents__link toc-highlight">分布式事务</a></li><li><a href="#手动提交事务" class="table-of-contents__link toc-highlight">手动提交事务</a></li><li><a href="#jdbc事务" class="table-of-contents__link toc-highlight">JDBC事务</a></li></ul></li><li><a href="#minio" class="table-of-contents__link toc-highlight">MinIO</a></li><li><a href="#pagehelper" class="table-of-contents__link toc-highlight">PageHelper</a></li><li><a href="#跨域" class="table-of-contents__link toc-highlight">跨域</a><ul><li><a href="#cors工作原理" class="table-of-contents__link toc-highlight">CORS工作原理</a></li><li><a href="#预检请求" class="table-of-contents__link toc-highlight">预检请求</a></li><li><a href="#解决跨域" class="table-of-contents__link toc-highlight">解决跨域</a><ul><li><a href="#cors跨域推荐" class="table-of-contents__link toc-highlight">CORS跨域（推荐）</a></li><li><a href="#gateway跨域" class="table-of-contents__link toc-highlight">Gateway跨域</a></li><li><a href="#同源代理跨域" class="table-of-contents__link toc-highlight">同源代理跨域</a></li></ul></li></ul></li><li><a href="#dubbozookeeper" class="table-of-contents__link toc-highlight">Dubbo+zookeeper</a></li><li><a href="#gaea实现读写分离" class="table-of-contents__link toc-highlight">Gaea实现读写分离</a></li><li><a href="#charles抓包工具" class="table-of-contents__link toc-highlight">Charles（抓包工具）</a></li><li><a href="#任务调度" class="table-of-contents__link toc-highlight">任务调度</a><ul><li><a href="#quartz" class="table-of-contents__link toc-highlight">Quartz</a></li></ul></li><li><a href="#http" class="table-of-contents__link toc-highlight">HTTP</a><ul><li><a href="#身份认证" class="table-of-contents__link toc-highlight">身份认证</a><ul><li><a href="#基本basic认证" class="table-of-contents__link toc-highlight">基本(Basic)认证</a></li><li><a href="#摘要digest认证" class="table-of-contents__link toc-highlight">摘要(Digest)认证</a></li><li><a href="#基 于表单form-based的ssl客户端认证" class="table-of-contents__link toc-highlight">基于表单(Form-Based)的SSL客户端认证</a></li></ul></li><li><a href="#http请求" class="table-of-contents__link toc-highlight">HTTP请求</a><ul><li><a href="#常用http请求" class="table-of-contents__link toc-highlight">常用HTTP请求</a></li><li><a href="#带证书http请求" class="table-of-contents__link toc-highlight">带证书HTTP请求</a></li></ul></li></ul></li><li><a href="#mapstruct" class="table-of-contents__link toc-highlight">MapStruct</a><ul><li><a href="#插件" class="table-of-contents__link toc-highlight">插件</a></li><li><a href="#依赖" class="table-of-contents__link toc-highlight">依赖</a></li><li><a href="#使用" class="table-of-contents__link toc-highlight">使用</a><ul><li><a href="#基本映射" class="table-of-contents__link toc-highlight">基本映射</a></li><li><a href="#集合映射" class="table-of-contents__link toc-highlight">集合映射</a></li></ul></li><li><a href="#子对象映射" class="table-of-contents__link toc-highlight">子对象映射</a></li><li><a href="#合并映射" class="table-of-contents__link toc-highlight">合并映射</a></li><li><a href="#使用依赖注入" class="table-of-contents__link toc-highlight">使用依赖注入</a></li><li><a href="#使用常量默认值和表达式" class="table-of-contents__link toc-highlight">使用常量、默认值和表达式</a></li><li><a href="#在映射前后进行自定义处理" class="table-of-contents__link toc-highlight">在映射前后进行自定义处理</a></li><li><a href="#处理映射异常" class="table-of-contents__link toc-highlight">处理映射异常</a></li></ul></li><li><a href="#本地缓存" class="table-of-contents__link toc-highlight">本地缓存</a><ul><li><a href="#guava-cache" class="table-of-contents__link toc-highlight">Guava Cache</a></li></ul></li><li><a href="#java内存模型" class="table-of-contents__link toc-highlight">Java内存模型</a></li><li><a href="#webclient" class="table-of-contents__link toc-highlight">WebClient</a><ul><li><a href="#webclient和resttemplate" class="table-of-contents__link toc-highlight">WebClient和RestTemplate</a></li></ul></li><li><a href="#jmeter" class="table-of-contents__link toc-highlight">jmeter</a></li><li><a href="#k8skubernetes" class="table-of-contents__link toc-highlight">k8s(kubernetes)</a></li><li><a href="#多线程" class="table-of-contents__link toc-highlight">多线程</a><ul><li><a href="#手动创建线程池" class="table-of-contents__link toc-highlight">手动创建线程池</a></li><li><a href="#等待线程执行完成" class="table-of-contents__link toc-highlight">等待线程执行完成</a></li></ul></li><li><a href="#bpmn" class="table-of-contents__link toc-highlight">BPMN</a><ul><li><a href="#事件events" class="table-of-contents__link toc-highlight">事件（Events）</a></li><li><a href="#活动activities" class="table-of-contents__link toc-highlight">活动（Activities）</a></li><li><a href="#网关gateways" class="table-of-contents__link toc-highlight">网关（Gateways）</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docusaurus.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">开发文档</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.cnblogs.com/minhua" target="_blank" rel="noopener noreferrer" class="footer__link-item">博客园<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://juejin.cn/user/2331397363880808" target="_blank" rel="noopener noreferrer" class="footer__link-item">掘金<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/mihuahe" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mhuahe.com/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mhuahe" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2024 mhuahe. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>
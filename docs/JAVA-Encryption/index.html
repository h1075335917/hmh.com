<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-JAVA-Encryption" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">JAVA-加密方式 | 贺敏华的官方网站</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mhuahe.github.io/mhuahe.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://mhuahe.github.io/mhuahe.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://mhuahe.github.io/mhuahe.com/docs/JAVA-Encryption"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="JAVA-加密方式 | 贺敏华的官方网站"><meta data-rh="true" name="description" content="别用MD5加密密码了"><meta data-rh="true" property="og:description" content="别用MD5加密密码了"><link data-rh="true" rel="icon" href="/mhuahe.com/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://mhuahe.github.io/mhuahe.com/docs/JAVA-Encryption"><link data-rh="true" rel="alternate" href="https://mhuahe.github.io/mhuahe.com/docs/JAVA-Encryption" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://mhuahe.github.io/mhuahe.com/docs/JAVA-Encryption" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://WZKDOGRNUN-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/mhuahe.com/blog/rss.xml" title="贺敏华的官方网站 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/mhuahe.com/blog/atom.xml" title="贺敏华的官方网站 Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="贺敏华的官方网站" href="/mhuahe.com/opensearch.xml"><link rel="stylesheet" href="/mhuahe.com/assets/css/styles.d11026b5.css">
<script src="/mhuahe.com/assets/js/runtime~main.22ac515c.js" defer="defer"></script>
<script src="/mhuahe.com/assets/js/main.04fdebd4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mhuahe.com/"><div class="navbar__logo"><img src="/mhuahe.com/img/logo.svg" alt="Hmh Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/mhuahe.com/img/logo.svg" alt="Hmh Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">贺敏华的官方网站</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/mhuahe.com/docs/intro">Java</a><a class="navbar__item navbar__link" href="/mhuahe.com/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mhuahe/mhuahe.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mhuahe.com/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="展开侧边栏分类 &#x27;Tutorial - Basics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mhuahe.com/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="展开侧边栏分类 &#x27;Tutorial - Extras&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/C">C语言</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-Algorithm">JAVA-算法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-Code-Generation">JAVA-代码生成</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-Data-Structure">JAVA-数据结构</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-Design-Pattern">JAVA-设计模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-Elaticsearch">JAVA-ES</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/mhuahe.com/docs/JAVA-Encryption">JAVA-加密方  式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-Error-Record">JAVA-Hutool</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-Hutool">JAVA-错误记录</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-JDK-Version">JAVA-JDK版本</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-JVM">JAVA-JVM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-Knowledge-Question">JAVA-知识题</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-MQ">JAVA-消息队列</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-Maven-Dependent">JAVA-Maven依赖</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-Maven">JAVA-Maven</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-MongoDB">JAVA-MongoDB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-MybatisPlus">JAVA-MybatisPlus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-OAuth2-SourceCode">JAVA-oauth2源码解读</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-SQL-Interceptor">JAVA-SQL拦截器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-Servlet">JAVA-Servlet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-SpringBoot-Stack">JAVA-SpringBoot技术栈</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-SpringBoot-Version">JAVA-SpringBoot版本</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-SpringCloud-Stack">JAVA-SpringCloud技术栈</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-Thread">JAVA-多线程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA-WebSocket">JAVA-WebSocket</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/JAVA">JAVA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/Linux">Linux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/MySQL">MySQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/Nginx">Nginx</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/OTHER-Examination">其他-考试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/OTHER-Work-Experience">其他-工作经验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/PROJECT-Build-Blog">项目-博客</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/PROJECT-Build-Microservices">项目-搭建微服务</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/PROJECT-Handwritten-Spring">项目-手写Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/PROJECT">项目</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/Python">Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/TOOL-Chrome-Plug">工具-谷歌插件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/TOOL-Excel-Stack">工具-Excel技巧</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/TOOL-IDEA-Stack">工具-IDEA技巧</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/TOOL-Regular">工具-正则表达式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/TOOL-Sequence-UML">工具-时序图-UML类图</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/TOOL-Typora">工具-Typora技巧</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/TOOL-VSCode">工具-VSCode</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/TOOL">工具</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/WEB-ElementUI">WEB-ElementUI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/WEB-HTML">WEB-HTML</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/WEB-React">WEB-React</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/WEB-Vite">WEB-Vite</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mhuahe.com/docs/WEB">WEB</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/mhuahe.com/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">JAVA-加密方式</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>JAVA-加密方式</h1></header>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="别用md5加密密码了">别用MD5加密密码了<a href="#别用md5加密密码了" class="hash-link" aria-label="别用MD5加密密码了的直接链接" title="别用MD5加密密码了的直接链接">​</a></h3>
<p>解释</p>
<blockquote>
<p>MD 算法有多个版本，包括 MD2、MD4、MD5 等，其中 MD5 是最常用的版本，它可以生成一个 128 位（16 字节）的哈希值。从安全性上说：MD5 &gt; MD4 &gt; MD2。除了这些版本，还有一些基于 MD4 或 MD5 改进的算法，如 RIPEMD、HAVAL 等。即使是最安全 MD 算法 MD5 也存在被破解的风险，攻击者可以通过暴力破解或彩虹表攻击等方式，找到与原始数据相同的哈希值，从而破解数据。</p>
<p>为了增加破解难度，通常可以选择加盐。盐（Salt）在密码学中，是指通过在密码任意固定位置插入特定的字符串，让哈希后的结果和使用原始密码的哈希结果不相符，这种过程称之为“加盐”。加盐之后就安全了吗？并不一定，这只是增加了破解难度，不代表无法破解。而且，MD5 算法本身就存在弱碰撞（Collision）问题，即多个不同的输入产生相同的 MD5 值。因此，不建议使用 MD5 加密密码，即使加盐也存在安全风险。</p>
</blockquote>
<p>替换方案</p>
<blockquote>
<p>为了增加安全性，可以使用<strong>安全性较高的加密哈希算法+ Salt（盐）</strong>（例如 SHA2、SHA3、SM3，更高的安全性更强的抗碰撞性）  。建议每个用户的 Salt 值不同（最好对不同用户的密码随机生成不同的 Salt，Salt 库和密码库分离开），这样就没办法用彩虹表进行批量破解。不过，这不代表没有破解风险了（利用密码破解硬件，我们可以在一秒钟内进行数十亿次的哈希计算）。</p>
<p>安全性更高的一种方案是使用 <strong>密钥派生算法（Key Derivation Function，简称 KDF，也称为密码哈希算法）</strong>。相比其他加密哈希算法，KDF 具有一个独特属性——计算速度很慢，而且从设计上就使其计算速度难以提升，所以 KDF 也被称为 <strong>慢哈希算法</strong> 。这个慢相比于其带来的安全性来说是可以接受的，毕竟主要也是在登录时执行一次。</p>
</blockquote>
<p>常见的 KDF 算法主要有（安全程度依次递增）：</p>
<p><a href="https://docs.spring.io/spring-security/reference/features/authentication/password-storage.html" target="_blank" rel="noopener noreferrer">具体代码实现</a></p>
<blockquote>
<ol>
<li>PBKDF2：其核心是对 HMAC 进行多次迭代以增加破解难度。PBKDF2 对内存的要求较低，并不能抵抗密码破解硬件（如 GPU、ASIC、FPGA）攻击。这个 KDF 算法比较老了，目前已经不推荐使用。</li>
<li>Bcrypt：一种基于 Blowfish 加密算法的密码哈希算法，专门为密码加密而设计，安全性高于 PBKDF2。Bcrypt 对内存的要求较低，同样不能抵抗密码破解硬件攻击。</li>
<li>Scrypt：相比于 PBKDF2 和 Bcrypt，其占用的内存更多，安全性也要更高。它还可以通过调整内存和 CPU 的使用量来增加破解的难度。</li>
<li>Argon2：目前最强的密码 Hash 算法，在 2015 年赢得了密码 Hash 竞赛。和 Scrypt 一样，Argon2 同样需要大量的内存。二者综合使用加盐、多次迭代、大量消耗 CPU 时间和内存资源等手段，大大提升了对抗密码破解硬件的能力。</li>
</ol>
</blockquote>
<p>建议方 案</p>
<blockquote>
<p>对于绝大部分项目来说， Bcrypt 就足够了，虽然它的安全性比不上 Scrypt 和 Argon2，但综合起来性价比较高</p>
<p>Bcrypt 采用了 salt（盐） 和 cost（成本） 两种机制，它可以有效地防止彩虹表攻击和暴力破解攻击，从而保证密码的安全性。加 salt 可以防止彩虹表攻击，也就是说，使用 Bcrypt 加密密码时已经包含了一个随机加盐的过程，不需要额外加盐了。</p>
<p>cost 又称为工作因子，定义了哈希计算的复杂度。成本越高，计算所需的时间和资源就越多，这使得暴力破解攻击变得更加困难。实际项目中，可以根据系统的性能和安全需求调整 cost。</p>
<p>Spring Security 提供的<code>BCryptPasswordEncoder</code> 工作因子范围在 4-31 ，默认是 10</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * @param strength the log rounds to use, between 4 and 31</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> public BCryptPasswordEncoder(int strength) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  this(strength, null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="md5"><a href="https://blog.csdn.net/yb546822612/article/details/103953034" target="_blank" rel="noopener noreferrer">MD5</a><a href="#md5" class="hash-link" aria-label="md5的直接链接" title="md5的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1.MD5加密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">加密后的位数分为16位和32位</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">16位实际为32位中取9-24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String md5_16 = md5_32.substring(8, 24);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Java 中 MD5 加密的结果默认是32位小写。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="https://hayes-typora.oss-cn-shenzhen.aliyuncs.com/MD5-1.png" alt="" class="img_ev3q"></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1.MD5加密算法(经常使用MD5+salt作为用户密码加密或MD5加密后再使用MD5加密)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MD5的全称是Message-Digest Algorithm 5，MD5可以将任意长度的“字节串”变换成⼀个128bit的⼤整数，并且它是⼀个不可逆的字符串变换算法，换句话说是，即使你看到源程序和算法描述，也⽆法将⼀个MD5的值变换回原始的字符串，从数学原理上说，是因为</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">原始的字符串有⽆穷多个，这有点象不存在反函数的数学函数。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2004年，证实MD5算法无法防止碰撞（collision）(不同的值加密后生成相同的字符串)，因此不适用于安全性认证，如SSL公开密钥认证或是数字签名等用途。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.math.BigInteger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.MessageDigest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.NoSuchAlgorithmException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.binary.Hex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.digest.DigestUtils;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.digests.MD2Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.digests.MD5Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MDUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * MD5加密，方式1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param pwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String commonsCodecMd5(String pwd) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return DigestUtils.md5Hex(pwd.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String commonsCodecMd2(String pwd) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return DigestUtils.md2Hex(pwd.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * MD5加密，方式2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param pwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String jdkMd5(String pwd) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] message = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        message = pwd.getBytes();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MessageDigest md = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            md = MessageDigest.getInstance(&quot;MD5&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] encrypwd = md.digest(message);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String md5code = new BigInteger(1, encrypwd).toString(16);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; 32 - md5code.length(); i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            md5code = &quot;0&quot; + md5code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return md5code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String jdkMd2(String pwd) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] message = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        message = pwd.getBytes();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MessageDigest md = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            md = MessageDigest.getInstance(&quot;md2&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] encrypwd = md.digest(message);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String md5code = Hex.encodeHexString(encrypwd);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; 32 - md5code.length(); i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            md5code = &quot;0&quot; + md5code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return md5code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      * Bouncy Castle实现MD4加密 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     public static String bouncyCastleMD4(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         /*通过这种方式给JDK动态添加一个provider,就可以通过这种方式获得JDK本身不支持的MD4了*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         Security.addProvider(new BouncyCastleProvider());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         MessageDigest md = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            md = MessageDigest.getInstance(&quot;md4&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         byte[] md4Bytes = md.digest(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         return new String(org.bouncycastle.util.encoders.Hex.encode(md4Bytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     /** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      * Bouncy Castle实现MD5加密 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     public static String bouncyCastleMD5(String src){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         Digest digest = new MD5Digest();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         digest.update(src.getBytes(), 0, src.getBytes().length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         byte[]md5Bytes = new byte[digest.getDigestSize()];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         digest.doFinal(md5Bytes, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         return new String(org.bouncycastle.util.encoders.Hex.encode(md5Bytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     /** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      * Bouncy Castle实现MD2加密 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     public static String bouncyCastleMD2(String src){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         Digest digest = new MD2Digest();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         digest.update(src.getBytes(), 0, src.getBytes().length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         byte[]md2Bytes = new byte[digest.getDigestSize()];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         digest.doFinal(md2Bytes, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         return new String(org.bouncycastle.util.encoders.Hex.encode(md2Bytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *  可逆的加密算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param inStr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String KL(String inStr) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        char[] a = inStr.toCharArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; a.length; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            a[i] = (char) (a[i] ^ &#x27;t&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String s = new String(a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return s;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *  加密后解密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param inStr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String JM(String inStr) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        char[] a = inStr.toCharArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; a.length; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            a[i] = (char) (a[i] ^ &#x27;t&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String k = new String(a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return k;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void md5(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String str = &quot;md5&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//Java原生</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] digest = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MessageDigest md5 = MessageDigest.getInstance(&quot;md5&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        digest  = md5.digest(str.getBytes(StandardCharsets.UTF_8));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //16是表示转换为16进制数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String md5StrJava = new BigInteger(1, digest).toString(16);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(md5StrJava);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	} catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//spring自带工具类</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String md5StrSpring = DigestUtils.md5DigestAsHex(str.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(md5StrSpring);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void md() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String inStr = &quot;000000&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;原始字符串：&quot;+inStr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD2加密：&quot; + MDUtil.jdkMd2(inStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD2加密：&quot; + MDUtil.commonsCodecMd2(inStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD2加密：&quot; + MDUtil.bouncyCastleMD2(inStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//670b14728ad9902aecba32e22fa4f6bd  32位 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD4加密：&quot; + MDUtil.bouncyCastleMD4(inStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//bf85aaf547303397450fbc8ede0ec3a5  32位 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD5加密：&quot; + MDUtil.jdkMd5(inStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD5加密：&quot; + MDUtil.commonsCodecMd5(inStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD5加密：&quot; + MDUtil.bouncyCastleMD5(inStr));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//670b14728ad9902aecba32e22fa4f6bd  32位</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String encrypMode = MDUtil.jdkMd5(inStr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;MD5后再加密：&quot; + MDUtil.KL(encrypMode));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;解密为MD5后的：&quot; + MDUtil.JM(MDUtil.KL(encrypMode)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="des">DES<a href="#des" class="hash-link" aria-label="DES的直接链接" title="DES的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2. DES加密算法--3DES--AES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DES全称为Data Encryption Standard，即数据加密标准，是⼀种使⽤密钥加密的块算法， DES算法的⼊⼝参数有三个：Key、Data、Mode。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Key为7个字节共56位,是DES算法的⼯作密钥。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Data为8个字节64位，是要被加密或被解密的数据。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mode为DES的工作方式,有两种:加密或解密。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.CipherInputStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.CipherOutputStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.SecretKeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.DESKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.IvParameterSpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Base64;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class DESUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 偏移变量，固定占8位字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final static String IV_PARAMETER = &quot;12345678&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 密钥算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String ALGORITHM = &quot;DES&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 加密/解密算法-工作模式-填充模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String CIPHER_ALGORITHM = &quot;DES/CBC/PKCS5Padding&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 默认编码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String CHARSET = &quot;utf-8&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 生成key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static Key generateKey(String password) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DESKeySpec dks = new DESKeySpec(password.getBytes(CHARSET));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return keyFactory.generateSecret(dks);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DES加密字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param password 加密密码，长度不能够小于8位</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data 待加密字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return 加密后内容</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String encrypt(String password, String data) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (password== null || password.length() &lt; 8) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(&quot;加密失败，key不能小于8位&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (data == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Key secretKey = generateKey(password);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(CIPHER_ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            IvParameterSpec iv = new IvParameterSpec(IV_PARAMETER.getBytes(CHARSET));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, secretKey, iv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] bytes = cipher.doFinal(data.getBytes(CHARSET));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //JDK1.8及以上可直接使用Base64，JDK1.7及以下可以使用BASE64Encoder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //Android平台可以使用android.util.Base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return new String(Base64.getEncoder().encode(bytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DES解密字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param password 解密密码，长度不能够小于8位</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data 待解密字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return 解密后内容</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String decrypt(String password, String data) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (password== null || password.length() &lt; 8) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(&quot;加密失败，key不能小于8位&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (data == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Key secretKey = generateKey(password);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(CIPHER_ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            IvParameterSpec iv = new IvParameterSpec(IV_PARAMETER.getBytes(CHARSET));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, secretKey, iv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return new String(cipher.doFinal(Base64.getDecoder().decode(data.getBytes(CHARSET))), CHARSET);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DES加密文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param srcFile  待加密的文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param destFile 加密后存放的文件路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return 加密后的文件路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String encryptFile(String password, String srcFile, String destFile) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (password== null || password.length() &lt; 8) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(&quot;加密失败，key不能小于8位&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            IvParameterSpec iv = new IvParameterSpec(IV_PARAMETER.getBytes(CHARSET));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(CIPHER_ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, generateKey(password), iv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            InputStream is = new FileInputStream(srcFile);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            OutputStream out = new FileOutputStream(destFile);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            CipherInputStream cis = new CipherInputStream(is, cipher);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] buffer = new byte[1024];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int r;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while ((r = cis.read(buffer)) &gt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                out.write(buffer, 0, r);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cis.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            is.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return destFile;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DES解密文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param srcFile  已加密的文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param destFile 解密后存放的文件路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return 解密后的文件路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String decryptFile(String password, String srcFile, String destFile) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (password== null || password.length() &lt; 8) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new RuntimeException(&quot;加密失败，key不能小于8位&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            File file = new File(destFile);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (!file.exists()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                file.getParentFile().mkdirs();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                file.createNewFile();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            IvParameterSpec iv = new IvParameterSpec(IV_PARAMETER.getBytes(CHARSET));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(CIPHER_ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, generateKey(password), iv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            InputStream is = new FileInputStream(srcFile);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            OutputStream out = new FileOutputStream(destFile);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            CipherOutputStream cos = new CipherOutputStream(out, cipher);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] buffer = new byte[1024];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int r;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while ((r = is.read(buffer)) &gt;= 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                cos.write(buffer, 0, r);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cos.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            is.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return destFile;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.KeyGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.lang3.StringUtils;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SecurityDES {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String DES_MODE_JDK = &quot;jdk&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String DES_MODE_BC = &quot;bouncyCastle&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Key key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //单例模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static SecurityDES securityDES;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static SecurityDES getInstance(String password, String succurityMode) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(securityDES == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            securityDES = new SecurityDES(password, succurityMode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return securityDES;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private SecurityDES(String password, String succurityMode)  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyGenerator generator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecureRandom secureRandom = SecureRandom.getInstance(&quot;SHA1PRNG&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            secureRandom.setSeed(password.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(StringUtils.isNotBlank(succurityMode) &amp;&amp; StringUtils.equals(DES_MODE_BC, succurityMode)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Security.addProvider(new BouncyCastleProvider());//增加provider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                generator = KeyGenerator.getInstance(&quot;DES&quot;, &quot;BC&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                generator.init(56, secureRandom);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                generator.getProvider();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                generator = KeyGenerator.getInstance(&quot;DES&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                generator.init(56, secureRandom);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            key = generator.generateKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] encrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;DES/ECB/PKCS5Padding&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] decrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;DES/ECB/PKCS5Padding&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch(Exception e ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void des() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String src = &quot;面向对象编程，object-oriented！@#*5&quot;; // 需要加密的原始字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String password = &quot;123456&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityDES securityJdkDES = SecurityDES.getInstance(password, SecurityDES.DES_MODE_JDK);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeJdkDES = securityJdkDES.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK DES加密：&quot; + Base64.getEncoder().encode(encodeJdkDES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeJdkDES = securityJdkDES.decrypt(encodeJdkDES);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK DES解密：&quot; + new String(decodeJdkDES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityDES securityBcDES = SecurityDES.getInstance(password, SecurityDES.DES_MODE_BC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeBcDES = securityBcDES.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle DES加密：&quot; + Base64.getEncoder().encode(encodeBcDES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeBcDES = securityBcDES.decrypt(encodeBcDES);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle DES解密：&quot; + new String(decodeBcDES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.KeyGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.SecretKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.SecretKeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.DESedeKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.lang3.StringUtils;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SecurityDES3 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String DES3_MODE_JDK = &quot;jdk&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String DES3_MODE_BC = &quot;bouncyCastle&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Key key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //单例模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static SecurityDES3 securityDES3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static SecurityDES3 getInstance(String password, String succurityMode) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(securityDES3 == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            securityDES3 = new SecurityDES3(password, succurityMode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return securityDES3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private SecurityDES3(String password, String succurityMode)  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //1.生成key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecureRandom secureRandom = SecureRandom.getInstance(&quot;SHA1PRNG&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            secureRandom.setSeed(password.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyGenerator keyGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(StringUtils.isNotBlank(succurityMode) &amp;&amp; StringUtils.equals(DES3_MODE_BC, succurityMode)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 Security.addProvider(new BouncyCastleProvider());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 keyGenerator = KeyGenerator.getInstance(&quot;desede&quot;, &quot;BC&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                keyGenerator = KeyGenerator.getInstance(&quot;desede&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyGenerator.init(168, secureRandom);//初始化key的长度，只能是128，</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKey secretKey = keyGenerator.generateKey();//生成key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] keyBytes = secretKey.getEncoded();//得到key的字节数组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //2.key的转换</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DESedeKeySpec deSedeKeySpec = new DESedeKeySpec(keyBytes);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKeyFactory factory = SecretKeyFactory.getInstance(&quot;desede&quot;);//秘密密钥工厂</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            key = factory.generateSecret(deSedeKeySpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] encrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;desede/ECB/PKCS5Padding&quot;);//加解密方式+工作模式+填充方式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, key);//以加密模式初始化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch(Exception e ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] decrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;desede/ECB/PKCS5Padding&quot;);//加解密方式+工作模式+填充方式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch(Exception e ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void des3() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String src = &quot;面向对象编程，object-oriented！@#*5&quot;; // 需要加密的原始字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String password = &quot;123456&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityDES3 securityJdkDES3 = SecurityDES3.getInstance(password, SecurityDES3.DES3_MODE_JDK);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeJdkDES3 = securityJdkDES3.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK DES3加密：&quot; + Base64.getEncoder().encode(encodeJdkDES3));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeJdkDES3 = securityJdkDES3.decrypt(encodeJdkDES3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK DES3解密：&quot; + new String(decodeJdkDES3));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityDES3 securityBcDES3 = SecurityDES3.getInstance(password, SecurityDES3.DES3_MODE_BC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeBcDES3 = securityBcDES3.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle DES3加密：&quot; + Base64.getEncoder().encode(encodeBcDES3));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeBcDES3 = securityBcDES3.decrypt(encodeBcDES3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle DES3解密：&quot; + new String(decodeBcDES3));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rsa">RSA<a href="#rsa" class="hash-link" aria-label="RSA的直接链接" title="RSA的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">3. RSA加密算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RSA是⽬前最有影响⼒的公钥加密算法，它能够抵抗到⽬前为⽌已知的绝⼤多数密码攻击，已被ISO推荐为公钥数据加密标准。RSA是被研究得最⼴泛的公钥算法，从提出到现在，经历了各种攻击的考验，逐渐为⼈们接受，普遍认为是⽬前最优秀的公钥⽅案之⼀。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import sun.misc.BASE64Decoder;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import sun.misc.BASE64Encoder;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.BadPaddingException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.IllegalBlockSizeException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.NoSuchPaddingException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.IOException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @title: RSAUtil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Author hmh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Date: 2022/7/4 16:06</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @Version 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class RSAUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static KeyPair keyPairGenerator(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        KeyPair keyPair = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //使用RSA算法获得密钥对生成器对象keyPairGenerator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;RSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //设置密钥长度为1024</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPairGenerator.initialize(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //生成密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPair = keyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return keyPair;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 公钥加密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param password 加密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param publicKey 公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return 加密后数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String encrypt(String password, PublicKey publicKey){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] secret = new byte[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //获取一个加密算法为RSA的加解密器对象cipher。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;RSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //设置为加密模式,并将公钥给cipher。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //获得密文</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            secret = cipher.doFinal(password.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException | NoSuchPaddingException | InvalidKeyException | IllegalBlockSizeException | BadPaddingException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //进行Base64编码并返回</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new BASE64Encoder().encode(secret);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 私钥解密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param password 解密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param privateKey 私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return 解密后的数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String decrypt(String password, PrivateKey privateKey){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] b = new byte[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;RSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //传递私钥，设置为解密模式。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //解密器解密由Base64解码后的密文,获得明文字节数组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            b = cipher.doFinal(new BASE64Decoder().decodeBuffer(password));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException | NoSuchPaddingException | IllegalBlockSizeException | BadPaddingException | IOException | InvalidKeyException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //转换成字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(b);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void rsa() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	KeyPair keyPair = RSAUtil.keyPairGenerator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	PrivateKey privateKey = keyPair.getPrivate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	PublicKey publicKey = keyPair.getPublic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(RSAUtil.encrypt(&quot;rsa&quot;, publicKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(RSAUtil.decrypt(RSAUtil.encrypt(&quot;rsa&quot;, publicKey), privateKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPair;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPairGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.NoSuchAlgorithmException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Signature;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.interfaces.RSAPrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.interfaces.RSAPublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.PKCS8EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.X509EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class DigitalSignRSA {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PUBLIC_KEY = &quot;RSAPublicKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PRIVATE_KEY = &quot;RSAPrivateKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 初始化密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Map 密钥对Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Map&lt;String, Object&gt; initKey() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //实例化密钥对生成器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;RSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 初始化密钥对生成器，密钥大小为96-1024位</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPairGenerator.initialize(512, new SecureRandom());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //生成密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RSAPrivateKey privateKey = (RSAPrivateKey) keyPair.getPrivate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //将密钥对存储在Map中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Map&lt;String, Object&gt; keyMap = new HashMap&lt;String, Object&gt;(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PUBLIC_KEY, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PRIVATE_KEY, privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return keyMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 执行数字签名【私钥签名】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data 待加密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param privKey  私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 加密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] digitalSign(byte[] data, byte[] privKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrivateKey privateKey = (PrivateKey) KeyFactory.getInstance(&quot;RSA&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePrivate(new PKCS8EncodedKeySpec(privKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Signature signature = Signature.getInstance(&quot;MD5WithRSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.initSign(privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.update(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return signature.sign();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 验证签名【公钥验证】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data 待解密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param pubKey  公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 解密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static boolean signVerify(byte[] data, byte[] rsaData, byte[] pubKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PublicKey publicKey = (PublicKey) KeyFactory.getInstance(&quot;RSA&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePublic(new X509EncodedKeySpec(pubKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Signature signature = Signature.getInstance(&quot;MD5WithRSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.initVerify(publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.update(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return signature.verify(rsaData);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 取得私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap 密钥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPrivateKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PRIVATE_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 取得公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap 密钥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPublicKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PUBLIC_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void rsa() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] publicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] privateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//初始化密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//生成密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Map&lt;String, Object&gt; keyMap = DigitalSignRSA.initKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	publicKey = DigitalSignRSA.getPublicKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	privateKey = DigitalSignRSA.getPrivateKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;RSA公钥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(publicKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;RSA私钥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(privateKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String msgA2B = &quot;What can I do for you?&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//执行数字签名【私钥签名】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeMsgA2B = DigitalSignRSA.digitalSign(msgA2B.getBytes(), privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK RSA签名：:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(encodeMsgA2B));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//验证签名【公钥验证】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	boolean bool = DigitalSignRSA.signVerify(msgA2B.getBytes(), encodeMsgA2B, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;数字签名是否有效？:\n&quot; + bool);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="idea">IDEA<a href="#idea" class="hash-link" aria-label="IDEA的直接链接" title="IDEA的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">4.IDEA加密算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IDEA（International Data Encryption Algorithm）国际数据加密算法：使⽤ 128 位密钥提供⾮常强的安全性。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dsa">DSA<a href="#dsa" class="hash-link" aria-label="DSA的直接链接" title="DSA的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">5. DSA加密算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DSA（Digital Signature Algorithm）：数字签名算法，是⼀种标准的 DSS（数字签名标准）。只能用于签名，不能用于加解密</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPair;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPairGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.NoSuchAlgorithmException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Signature;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.interfaces.DSAPrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.interfaces.DSAPublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.PKCS8EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.X509EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class DSAUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PUBLIC_KEY = &quot;DSAPublicKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PRIVATE_KEY = &quot;DSAPrivateKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 初始化密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Map 密钥对Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Map&lt;String, Object&gt; initKey() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //实例化密钥对生成器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;DSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 初始化密钥对生成器，密钥大小为96-1024位</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPairGenerator.initialize(512, new SecureRandom());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //生成密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DSAPublicKey publicKey = (DSAPublicKey) keyPair.getPublic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DSAPrivateKey privateKey = (DSAPrivateKey) keyPair.getPrivate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //将密钥对存储在Map中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Map&lt;String, Object&gt; keyMap = new HashMap&lt;String, Object&gt;(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PUBLIC_KEY, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PRIVATE_KEY, privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return keyMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 执行数字签名【私钥签名】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data 待加密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param privKey  私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 加密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] digitalSign(byte[] data, byte[] privKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrivateKey privateKey = (PrivateKey) KeyFactory.getInstance(&quot;DSA&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePrivate(new PKCS8EncodedKeySpec(privKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Signature signature = Signature.getInstance(&quot;SHA1WithDSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.initSign(privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.update(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return signature.sign();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 验证签名【公钥验证】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data 待解密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param pubKey  公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 解密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static boolean signVerify(byte[] data, byte[] rsaData, byte[] pubKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PublicKey publicKey = (PublicKey) KeyFactory.getInstance(&quot;DSA&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePublic(new X509EncodedKeySpec(pubKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Signature signature = Signature.getInstance(&quot;SHA1WithDSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.initVerify(publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.update(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return signature.verify(rsaData);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 取得私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap 密钥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPrivateKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PRIVATE_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 取得公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap 密钥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPublicKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PUBLIC_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void dsa() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] publicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] privateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//初始化密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//生成密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Map&lt;String, Object&gt; keyMap = DSAUtil.initKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	publicKey = DSAUtil.getPublicKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	privateKey = DSAUtil.getPrivateKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;DSA公钥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(publicKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;DSA私钥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(privateKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String msgA2B = &quot;What can I do for you?&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//执行数字签名【私钥  签名】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeMsgA2B = DSAUtil.digitalSign(msgA2B.getBytes(), privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK DSA签名：:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(encodeMsgA2B));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//验证签名【公钥验证】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	boolean bool = DSAUtil.signVerify(msgA2B.getBytes(), encodeMsgA2B, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;数字签名是否有效？:\n&quot; + bool);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="aes">AES<a href="#aes" class="hash-link" aria-label="AES的直接链接" title="AES的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">6.AES加密算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AES加密算法⼜称Rijndael加密法，⽬前已经被多⽅分析且⼴为全世界所使⽤。经过五年发展，AES加密算法已然成为对称密钥加密中最流行的算法之⼀。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">问题：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(1) Illegal key size or default parameters：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">需要更改jce，下载地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-429243.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">更换目录jar：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#{jdk}\jre\lib\security</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(2)Jurisdiction policy files are not signed by trusted signers!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jce版本不对，对应jdk版本下载正确的jce</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.IvParameterSpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.SecretKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.binary.Base64;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.binary.Hex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Locale;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author ：smallkinghjm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @description：TODO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @date ：2022/3/2 11:20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class AESUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * AES加密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param content 明文</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key     秘钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String encrypt(String content, String key) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 将返回的加密过的 byte[] 转换成Base64编码字符串 ！！！！很关键</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return base64ToString(AES_ECB_Encrypt(content.getBytes(), key.getBytes()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * AES解密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param content Base64编码的密文</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key     秘钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String decrypt(String content, String key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // stringToBase64() 将 Base64编码的字符串转换成 byte[] !!!与base64ToString(）配套使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] base64 = stringToBase64(content);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] bytes = AES_ECB_Decrypt(base64, key.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String result = new String(bytes);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result.replaceAll(&quot;\&quot;&quot;,&quot;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log.info(&quot;AES解密出错！！！&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] AES_ECB_Encrypt(byte[] content, byte[] keyBytes) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKeySpec key = new SecretKeySpec(keyBytes, &quot;AES&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;AES/ECB/PKCS7Padding&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] result = cipher.doFinal(content);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] AES_ECB_Decrypt(byte[] content, byte[] keyBytes) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKeySpec key = new SecretKeySpec(keyBytes, &quot;AES&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;AES/ECB/PKCS7Padding&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] result = cipher.doFinal(content);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 字符串装换成 Base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] stringToBase64(String key) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Base64.decodeBase64(key.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Base64装换成字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String base64ToString(byte[] key) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new Base64().encodeToString(key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void aes() throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String key = &quot;5F6B2AK33DZE20A05E74C231B47AC8F6&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String content = &quot;smallkinghjm_2022&quot;;//明文</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String encrypt = AESUtil.encrypt(content, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;加密：&quot; + encrypt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String decrypt = AESUtil.decrypt(encrypt, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;解密：&quot;+decrypt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.KeyGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.SecretKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.SecretKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.lang3.StringUtils;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SecurityAES {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String AES_MODE_JDK = &quot;jdk&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String AES_MODE_BC = &quot;bouncyCastle&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Key key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //单例模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static SecurityAES securityAES;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static SecurityAES getInstance(String password, String succurityMode) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(securityAES == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            securityAES = new SecurityAES(password, succurityMode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return securityAES;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private SecurityAES(String password, String succurityMode)  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //1.生成key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecureRandom secureRandom = SecureRandom.getInstance(&quot;SHA1PRNG&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            secureRandom.setSeed(password.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyGenerator keyGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(StringUtils.isNotBlank(succurityMode) &amp;&amp; StringUtils.equals(AES_MODE_BC, succurityMode)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 Security.addProvider(new BouncyCastleProvider());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 keyGenerator = KeyGenerator.getInstance(&quot;aes&quot;, &quot;BC&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                keyGenerator = KeyGenerator.getInstance(&quot;aes&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyGenerator.init(128, secureRandom);//初始化key的长度，只能是128，</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKey secretKey = keyGenerator.generateKey();//生成key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] keyBytes = secretKey.getEncoded();//得到key的字节数组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //2.key的转换</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            key = new SecretKeySpec(keyBytes, &quot;aes&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] encrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;AES/ECB/PKCS5Padding&quot;);//加解密方式+工作模式+填充方式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, key);//以加密模式初始化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch(Exception e ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] decrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;AES/ECB/PKCS5Padding&quot;);//加解密方式+工作模式+填充方式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch(Exception e ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void aes() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String src = &quot;面向对象编程，object-oriented！@#*5&quot;; // 需要加密的原始字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String password = &quot;123456&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityAES securityJdkAES = SecurityAES.getInstance(password, SecurityAES.AES_MODE_JDK);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeJdkAES = securityJdkAES.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK AES加密：&quot; + Base64.getEncoder().encode(encodeJdkAES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeJdkAES = securityJdkAES.decrypt(encodeJdkAES);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK AES解密：&quot; + new String(decodeJdkAES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityAES securityBcAES = SecurityAES.getInstance(password, SecurityAES.AES_MODE_BC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeBcAES = securityBcAES.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle AES加密：&quot; + Base64.getEncoder().encode(encodeBcAES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeBcAES = securityBcAES.decrypt(encodeBcAES);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle AES解密：&quot; + new String(decodeBcAES));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="elgamal">Elgamal<a href="#elgamal" class="hash-link" aria-label="Elgamal的直接链接" title="Elgamal的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">7. Elgamal加密算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ElGamal算法，是⼀种较为常见的加密算法，它是基于1984年提出的公钥密码体制和椭圆曲线加密体系。既能⽤于数据加密也能⽤于数字签名。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.AlgorithmParameterGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.AlgorithmParameters;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPair;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPairGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.PKCS8EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.X509EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.DHParameterSpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ElgamalUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 非对称加密算法——ELGamal算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 对于：“Illegal key size or default parameters”异常，是因为美国的出口限制，Sun通过权限文件（local_policy.jar、US_export_policy.jar）做了相应限制。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Java 7 无政策限制文件：http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 下载后得到UnlimitedJCEPolicyJDK7.zip，解压替换%JAVA_HOME%/jre/lib/security的两个文件即可</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PUBLIC_KEY = &quot;elgamalPublicKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PRIVATE_KEY = &quot;elgamalPrivateKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 初始化密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Map 密钥对Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Map&lt;String, Object&gt; initKey() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Security.addProvider(new BouncyCastleProvider());//加入对Bouncy Castle的支持</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //1.初始化发送方密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            AlgorithmParameterGenerator algorithmParameterGenerator = AlgorithmParameterGenerator.getInstance(&quot;ELGamal&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            algorithmParameterGenerator.init(256);//初始化参数生成器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            AlgorithmParameters algorithmParameters = algorithmParameterGenerator.generateParameters();//生成算法参数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DHParameterSpec dhParameterSpec = algorithmParameters.getParameterSpec(DHParameterSpec.class);//构建参数材料</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;ELGamal&quot;);//实例化密钥对生成器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //初始化密钥对生成器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPairGenerator.initialize(dhParameterSpec, new SecureRandom());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //公钥和私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PublicKey elGamalPublicKey = keyPair.getPublic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrivateKey elGamalPrivateKey = keyPair.getPrivate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //将密钥对存储在Map中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Map&lt;String, Object&gt; keyMap = new HashMap&lt;String, Object&gt;(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PUBLIC_KEY, elGamalPublicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PRIVATE_KEY, elGamalPrivateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return keyMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 加密【公钥加密，私钥解密】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data 待加密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key  公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 加密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] encrypt(byte[] data, byte[] key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PublicKey pubKey = (PublicKey) KeyFactory.getInstance(&quot;ELGamal&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePublic(new X509EncodedKeySpec(key));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;ELGamal&quot;,&quot;BC&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, pubKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] result = cipher.doFinal(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**  解密【公钥加密，私钥解密】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data 待解密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key  私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 解密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] decrypt(byte[] data, byte[] key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrivateKey priKey = (PrivateKey) KeyFactory.getInstance(&quot;ELGamal&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePrivate(new PKCS8EncodedKeySpec(key));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //实例化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;ELGamal&quot;,&quot;BC&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //使用密钥初始化，设置为解密模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, priKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //执行操作</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] result = cipher.doFinal(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 取得私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap 密钥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPrivateKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PRIVATE_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 取得公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap 密钥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPublicKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PUBLIC_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void elgamal() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] publicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] privateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//初始化密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//生成甲方密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Map&lt;String, Object&gt; keyMap = ElgamalUtil.initKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	publicKey = ElgamalUtil.getPublicKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	privateKey = ElgamalUtil.getPrivateKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Elgamal公钥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(publicKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Elgamal私钥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(privateKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;===甲方向乙方发送加密数据===&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String msgA2B = &quot;求知若饥，虚心若愚。&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;原文:\n&quot; + msgA2B);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;---甲方使用公钥对数据进行加密---&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//使用公钥对数据加密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeMsgA2B = ElgamalUtil.encrypt(msgA2B.getBytes(), publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Elgamal加密:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(encodeMsgA2B));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;---乙方使用私钥对数据库进行解密---&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//使用私钥对数据进行解密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] msgB2A = ElgamalUtil.decrypt(encodeMsgA2B, privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String output1 = new String(msgB2A);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Elgamal解密:\n&quot; + output1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="base64">Base64<a href="#base64" class="hash-link" aria-label="Base64的直接链接" title="Base64的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">8. Base64加密算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Base64加密算法是⽹络上最常见的⽤于传输8bit字节代码的编码⽅式之⼀，Base64编码可⽤于在HTTP环境下传递较长的标识信息。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//base64加密解密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Base64.getEncoder().encode(String)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Base64.getDecoder().decode(String)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.binary.Base64;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SecurityBASE64 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * base64算法是基于64个字符的一种替换算法。base64加密的产生式电子邮件的“历史问题”——邮件只能传输ASCII码。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * base64加密的应用场景：email、密钥、证书文件。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *  该算法可以由2种方式实现：Bouncy Castle、Commons Codec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Commons Codec实现base64编码 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String encodeCC(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] encode = Base64.encodeBase64(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(encode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String decodeCC(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] decode = Base64.decodeBase64(src);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(decode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Bouncy Castle实现base64编码 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String encodeBC(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] encode = org.bouncycastle.util.encoders.Base64.encode(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(encode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String decodeBC(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] decode = org.bouncycastle.util.encoders.Base64.decode(src);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(decode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void base64() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String inStr = &quot;面向对象编程，object-oriented！@#*5&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String encodeCC = SecurityBASE64.encodeCC(inStr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Commons Codec实现base64编码：\t&quot; + encodeCC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String decodeCC = SecurityBASE64.decodeCC(encodeCC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Commons Codec实现base64解码：\t&quot; + decodeCC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String encodeBC = SecurityBASE64.encodeBC(inStr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Bouncy Castle实现base64编码：\t&quot; + encodeBC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String decodeBC = SecurityBASE64.decodeBC(encodeBC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;Bouncy Castle实现base64解码：\t&quot; + decodeBC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sha">SHA<a href="#sha" class="hash-link" aria-label="SHA的直接链接" title="SHA的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">9. SHA1加密算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SHA1是和MD5⼀样流⾏的消息摘要算法。SHA加密算法模仿MD4加密算法。SHA1主要适⽤于数字签名标准⾥⾯定义的数字签名算法。不可逆</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.MessageDigest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.NoSuchAlgorithmException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.binary.Hex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.digest.DigestUtils;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.digests.SHA1Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.digests.SHA224Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.digests.SHA256Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SHAUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *  安全散列算法，固定长度的摘要信息。被认为是MD5的继承者。是一个系列，包括SHA-1、SHA-2（SHA-224、SHA-256、SHA-384、SHA-512）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * JDK实现sha-1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String jdkSHA1(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MessageDigest md = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            md = MessageDigest.getInstance(&quot;sha&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }// sha1算法传入参数为sha</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] sha1Bytes = md.digest(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Hex.encodeHexString(sha1Bytes);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * JDK实现sha-256 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String jdkSHA256(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MessageDigest md = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            md = MessageDigest.getInstance(&quot;sha-256&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        md.update(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(org.bouncycastle.util.encoders.Hex.encode(md.digest()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Commons Codec实现sha-1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String commonsCodecSAH1(String src){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//        return DigestUtils.sha1Hex(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return DigestUtils.sha1Hex(src);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Bouncy Castle实现sha-1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String bouncyCastleSHA1(String src){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Digest digest = new SHA1Digest();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        digest.update(src.getBytes(), 0, src.getBytes().length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[]sha1Bytes = new byte[digest.getDigestSize()];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        digest.doFinal(sha1Bytes, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(org.bouncycastle.util.encoders.Hex.encode(sha1Bytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Bouncy Castle实现sha-224 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String bouncyCastleSHA224(String src){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Digest digest = new SHA224Digest();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        digest.update(src.getBytes(), 0, src.getBytes().length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[]sha224Bytes = new byte[digest.getDigestSize()];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        digest.doFinal(sha224Bytes, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(org.bouncycastle.util.encoders.Hex.encode(sha224Bytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Bouncy Castle实现sha-256 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String bouncyCastleSHA256(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Digest digest = new SHA256Digest();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        digest.update(src.getBytes(), 0, src.getBytes().length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] sha256Bytes = new byte[digest.getDigestSize()];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        digest.doFinal(sha256Bytes, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(org.bouncycastle.util.encoders.Hex.encode(sha256Bytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void sha() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String src = &quot;object-oriente&quot;; // 需要加密的原始字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK SHA-1:\t&quot; + SHAUtil.jdkSHA1(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;cc SHA-1:\t&quot; + SHAUtil.commonsCodecSAH1(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bc SHA-1:\t&quot; + SHAUtil.bouncyCastleSHA1(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bc SHA-224:\t&quot; + SHAUtil.bouncyCastleSHA224(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK SHA-256:\t&quot; + SHAUtil.jdkSHA256(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bc SHA-256:\t&quot; + SHAUtil.bouncyCastleSHA256(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pkcs">PKCS<a href="#pkcs" class="hash-link" aria-label="PKCS的直接链接" title="PKCS的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">10. PKCS加密算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PKCS是由美国RSA数据安全公司及其合作伙伴制定的⼀组公钥密码学标准，其中包括证书申请、证书更新、证书作废表发布、扩展证书内容以及数字签名、数字信封的格式等⽅⾯的⼀系列相关协议。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ecdsa">ECDSA<a href="#ecdsa" class="hash-link" aria-label="ECDSA的直接链接" title="ECDSA的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">11.ECDSA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">微软的Office、Windows操作系统的验证就是ECDSA算法——椭圆曲线数字签名算法（Elliptic Curve Digital Signature Algorithm），在2000年的时候称为了ANSI和IEEE的标准。特点是：速度快、签名短、强度高。在JDK1.7update4之后提供了对ECDSA的支持。该签名的算法也和RSA的数字签名算法也是大同小异。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPair;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPairGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.NoSuchAlgorithmException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Signature;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.interfaces.ECPrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.interfaces.ECPublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.PKCS8EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.X509EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class DigitalSignECDSA {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PUBLIC_KEY = &quot;ECDSAPublicKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PRIVATE_KEY = &quot;ECDSAPrivateKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 初始化密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Map 密钥对Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Map&lt;String, Object&gt; initKey() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //实例化密钥对生成器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;EC&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 初始化密钥对生成器，密钥大小为256位</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPairGenerator.initialize(256, new SecureRandom());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //生成密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ECPublicKey publicKey = (ECPublicKey) keyPair.getPublic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ECPrivateKey privateKey = (ECPrivateKey) keyPair.getPrivate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //将密钥对存储在Map中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Map&lt;String, Object&gt; keyMap = new HashMap&lt;String, Object&gt;(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PUBLIC_KEY, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PRIVATE_KEY, privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return keyMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 执行数字签名【私钥签名】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data 待加密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param privKey  私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 加密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] digitalSign(byte[] data, byte[] privKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrivateKey privateKey = (PrivateKey) KeyFactory.getInstance(&quot;EC&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePrivate(new PKCS8EncodedKeySpec(privKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Signature signature = Signature.getInstance(&quot;SHA1WithECDSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.initSign(privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.update(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return signature.sign();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 验证签名【公钥验证】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data 待解密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param pubKey  公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 解密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static boolean signVerify(byte[] data, byte[] rsaData, byte[] pubKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PublicKey publicKey = (PublicKey) KeyFactory.getInstance(&quot;EC&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .generatePublic(new X509EncodedKeySpec(pubKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Signature signature = Signature.getInstance(&quot;SHA1WithECDSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.initVerify(publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            signature.update(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return signature.verify(rsaData);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 取得私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap 密钥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPrivateKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PRIVATE_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 取得公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap 密钥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPublicKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PUBLIC_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void ecdsa() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] publicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] privateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//初始化密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//生成密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Map&lt;String, Object&gt; keyMap = DigitalSignECDSA.initKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	publicKey = DigitalSignECDSA.getPublicKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	privateKey = DigitalSignECDSA.getPrivateKey(keyMap);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;ECDSA公钥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(publicKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;ECDSA私钥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(privateKey));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String msgA2B = &quot;What can I do for you?&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//执行数字签名【私钥签名】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeMsgA2B = DigitalSignECDSA.digitalSign(msgA2B.getBytes(), privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK ECDSA签名：:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(encodeMsgA2B));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//验证签名【公钥验证】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	boolean bool = DigitalSignECDSA.signVerify(msgA2B.getBytes(), encodeMsgA2B, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;数字签名是否有效？:\n&quot; + bool);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dh">DH<a href="#dh" class="hash-link" aria-label="DH的直接链接" title="DH的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">非对称加密算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">加密密钥分为公钥和私钥。可以使用公钥加密私钥解密，也可以使用私钥加密公钥解密。非对称加密算法主要有：DH（Diffie-Hellman）密钥交换算法、RSA（基于因子分解）、Elgamal（基于离散对数）、ECC（Elliptical Curve Cryptography，椭圆曲线加密）。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DH（密钥交换）算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">如何安全地传送密钥是对称加密算法的症结所在。密钥交换算法是通过构建本地密钥来解决对称加密算法中的密钥传递的问题的。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPair;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.KeyPairGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.NoSuchAlgorithmException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.PublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.PKCS8EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.spec.X509EncodedKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.HashMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Map;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.KeyAgreement;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.KeyGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.SecretKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.interfaces.DHPrivateKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.interfaces.DHPublicKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.DHParameterSpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.SecretKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SecurityDH {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 使用DH方式加解密的前提条件：否则报错 java.security.NoSuchAlgorithmException: Unsupported secret key algorithm: AES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *     1.当前开发环境中的运行的java程序, 在jre中配置缺省VM变量 -Djdk.crypto.KeyAgreement.legacyKDF=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *         A.点击窗口，选择首选项  B.点击installed JREs, 选择JRE配置，然后编辑  C.在缺省VM参数：-Djdk.crypto.KeyAgreement.legacyKDF=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *  2.可运行jar包，则需要在运行时采用命令提示符运行，在运行时添加VM参数，运行命令为：java -jar -Djdk.crypto.KeyAgreement.legacyKDF=true jarPackName.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *         A.编辑可执行文件，配置VM参数：-Djdk.crypto.KeyAgreement.legacyKDF=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 本地密钥算法，即对称加密密钥算法  可选DES、DESede或者AES*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String SELECT_ALGORITHM = &quot;AES&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 默认的加密算法 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String DEFAULT_CIPHER_ALGORITHM = &quot;AES/ECB/PKCS5Padding&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 密钥长度 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final int KEY_SIZE = 512;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PUBLIC_KEY = &quot;DHPublicKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final String PRIVATE_KEY = &quot;DHPrivateKey&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**  初始化甲方密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Map 甲方密钥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Map&lt;String, Object&gt; initKey() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //实例化密钥对生成器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;DH&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //初始化密钥对生成器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPairGenerator.initialize(KEY_SIZE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //生成密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //甲方公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DHPublicKey publicKey = (DHPublicKey) keyPair.getPublic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //甲方私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DHPrivateKey privateKey = (DHPrivateKey) keyPair.getPrivate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //将密钥对存储在Map中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Map&lt;String, Object&gt; keyMap = new HashMap&lt;String, Object&gt;(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PUBLIC_KEY, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PRIVATE_KEY, privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return keyMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 初始化乙方密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key 甲方公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return Map 乙方密钥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Map&lt;String, Object&gt; initKey(byte[] key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //解析甲方公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //转换公钥材料</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            X509EncodedKeySpec x509KeySpec = new X509EncodedKeySpec(key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //实例化密钥工厂</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyFactory keyFactory = KeyFactory.getInstance(&quot;DH&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //产生公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PublicKey pubKey = keyFactory.generatePublic(x509KeySpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //由甲方公钥构建乙方密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DHParameterSpec dhParameterSpec = ((DHPublicKey) pubKey).getParams();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //实例化密钥对生成器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;DH&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //初始化密钥对生成器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyPairGenerator.initialize(dhParameterSpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //产生密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //乙方公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DHPublicKey publicKey = (DHPublicKey) keyPair.getPublic();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //乙方私约</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            DHPrivateKey privateKey = (DHPrivateKey) keyPair.getPrivate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //将密钥对存储在Map中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Map&lt;String, Object&gt; keyMap = new HashMap&lt;String, Object&gt;(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PUBLIC_KEY, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyMap.put(PRIVATE_KEY, privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return keyMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 生成加密秘钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static SecretKeySpec getSecretKey(final byte[] key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //返回生成指定算法密钥生成器的 KeyGenerator 对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        KeyGenerator kg = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            kg = KeyGenerator.getInstance(SELECT_ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //AES 要求密钥长度为 128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            kg.init(128, new SecureRandom(key));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //生成一个密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKey secretKey = kg.generateKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return new SecretKeySpec(secretKey.getEncoded(), SELECT_ALGORITHM);// 转换为AES专用密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 加密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data 待加密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key  密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 加密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] encrypt(byte[] data, byte[] key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(DEFAULT_CIPHER_ALGORITHM);// 创建密码器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] byteContent = data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, getSecretKey(key));// 初始化为加密模式的密码器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] result = cipher.doFinal(byteContent);// 加密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**  解密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param data 待解密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param key  密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 解密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] decrypt(byte[] data, byte[] key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //实例化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(DEFAULT_CIPHER_ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //使用密钥初始化，设置为解密模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, getSecretKey(key));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //执行操作</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] result = cipher.doFinal(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ex.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 构建密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param publicKey  公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param privateKey 私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 本地密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getSecretKey(byte[] publicKey, byte[] privateKey) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //实例化密钥工厂</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyFactory keyFactory = KeyFactory.getInstance(&quot;DH&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //初始化公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //密钥材料转换</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            X509EncodedKeySpec x509KeySpec = new X509EncodedKeySpec(publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //产生公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PublicKey pubKey = keyFactory.generatePublic(x509KeySpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //初始化私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //密钥材料转换</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PKCS8EncodedKeySpec pkcs8KeySpec = new PKCS8EncodedKeySpec(privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //产生私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PrivateKey priKey = keyFactory.generatePrivate(pkcs8KeySpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //实例化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            KeyAgreement keyAgree = KeyAgreement.getInstance(keyFactory.getAlgorithm());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //初始化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyAgree.init(priKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyAgree.doPhase(pubKey, true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //生成本地密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKey secretKey = keyAgree.generateSecret(SELECT_ALGORITHM);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return secretKey.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 取得私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap 密钥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPrivateKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PRIVATE_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /** 取得公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param keyMap 密钥Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return byte[] 公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static byte[] getPublicKey(Map&lt;String, Object&gt; keyMap) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Key key = (Key) keyMap.get(PUBLIC_KEY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return key.getEncoded();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void dh() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//甲方公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] publicKeyA;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//甲方私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] privateKeyA;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//甲方本地密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] localKeyA;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//乙方公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] publicKeyB;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//乙方私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] privateKeyB;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//乙方本地密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] localKeyB;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//初始化密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//生成甲方密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Map&lt;String, Object&gt; keyMapA = SecurityDH.initKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	publicKeyA = SecurityDH.getPublicKey(keyMapA);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	privateKeyA = SecurityDH.getPrivateKey(keyMapA);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;甲方公钥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(publicKeyA));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;甲方私钥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(privateKeyA));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//由甲方公钥产生乙方本地密钥对</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Map&lt;String, Object&gt; keyMapB = SecurityDH.initKey(publicKeyA);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	publicKeyB = SecurityDH.getPublicKey(keyMapB);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	privateKeyB = SecurityDH.getPrivateKey(keyMapB);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;乙方公钥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(publicKeyB));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;乙方私钥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(privateKeyB));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	localKeyA = SecurityDH.getSecretKey(publicKeyB, privateKeyA);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;甲方本地密钥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(localKeyA));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	localKeyB = SecurityDH.getSecretKey(publicKeyA, privateKeyB);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;乙方本地密钥:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(localKeyB));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;===甲方向乙方发送加密数据===&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String msgA2B = &quot;求知若饥，虚心若愚。&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;原文:\n&quot; + msgA2B);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;---使用甲方本地密钥对数据进行加密---&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//使用甲方本地密钥对数据加密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeMsgA2B = SecurityDH.encrypt(msgA2B.getBytes(), localKeyA);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;加密:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(encodeMsgA2B));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;---使用乙方本地密钥对数据库进行解密---&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//使用乙方本地密钥对数据进行解密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] msgB2A = SecurityDH.decrypt(encodeMsgA2B, localKeyB);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String output1 = new String(msgB2A);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;解密:\n&quot; + output1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;/~.~.~.~.~.~.~.~.~.~.~.~.~.~.~.~.~.~..~.~.~.~.~.~.~.~.~.~.~.~.~.~.~.~.~.~/&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;===乙方向甲方发送加密数据===&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String input2 = &quot;好好学习，天天向上。&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;原文:\n&quot; + input2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;---使用乙方本地密钥对数据进行加密---&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//使用乙方本地密钥对数据进行加密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encode2 = SecurityDH.encrypt(input2.getBytes(), localKeyB);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;加密:\n&quot; + org.apache.commons.codec.binary.Base64.encodeBase64String(encode2));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;---使用甲方本地密钥对数据进行解密---&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	//使用甲方本地密钥对数据进行解密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decode2 = SecurityDH.decrypt(encode2, localKeyA);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String output2 = new String(decode2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;解密:\n&quot; + output2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pbe">PBE<a href="#pbe" class="hash-link" aria-label="PBE的直接链接" title="PBE的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PBE算法结合了消息摘要算法和对称加密算法的优点，是一种特殊的对称加密算法。Password Based Encryption，基于口令的加密。因为口令是比较好记的，就容易通过穷举、猜测的方式获得口令——针对这种情况，我们采用的方式是加盐（Salt），通过加入一些额外的内容（通常是随机字符）去扰乱。实现的方式有2种：JDK和BC。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.SecureRandom;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Cipher;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.SecretKeyFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.PBEKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.PBEParameterSpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.lang3.StringUtils;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SecurityPBE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String PBE_MODE_JDK = &quot;jdk&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String PBE_MODE_BC = &quot;bouncyCastle&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private PBEParameterSpec parameterSpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Key key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //单例模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static SecurityPBE securityPBE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static SecurityPBE getInstance(String password, String succurityMode) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(securityPBE == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            securityPBE = new SecurityPBE(password, succurityMode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return securityPBE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private SecurityPBE(String password, String succurityMode)  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //1.初始化盐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecureRandom secureRandom = new SecureRandom();//强加密随机数生成器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] salt= secureRandom.generateSeed(8);//产生盐必须是8位</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //2.口令与密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(StringUtils.isNotBlank(succurityMode) &amp;&amp; StringUtils.equals(PBE_MODE_BC, succurityMode)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Security.addProvider(new BouncyCastleProvider());//添加到provider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                PBEKeySpec pbeKeySpec = new PBEKeySpec(password.toCharArray());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SecretKeyFactory factory = SecretKeyFactory.getInstance(&quot;PBEWithMD5AndDES&quot;,&quot;BC&quot;);//指定provider</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                key = factory.generateSecret(pbeKeySpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                parameterSpec = new PBEParameterSpec(salt, 50);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                PBEKeySpec pbeKeySpec = new PBEKeySpec(password.toCharArray());//密钥转换的对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SecretKeyFactory factory = SecretKeyFactory.getInstance(&quot;PBEWithMD5AndDES&quot;);//实例化密钥转换工厂</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                key = factory.generateSecret(pbeKeySpec);//由工厂产生key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                parameterSpec = new PBEParameterSpec(salt, 100);//PBE输入参数的材料，盐，迭代100次</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] encrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;PBEWithMD5AndDES&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.ENCRYPT_MODE, key, parameterSpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] result = cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch(Exception e ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public byte[] decrypt(byte[] array) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Cipher cipher = Cipher.getInstance(&quot;PBEWithMD5AndDES&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher.init(Cipher.DECRYPT_MODE, key, parameterSpec);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cipher.doFinal(array);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch(Exception e ){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代 码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void pbe() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String src = &quot;面向对象编程，object-oriented！@#*5&quot;; // 需要加密的原始字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String password = &quot;123456&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityPBE securityJdkPBE1 = SecurityPBE.getInstance(password, SecurityPBE.PBE_MODE_JDK);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeJdkPBE = securityJdkPBE1.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK PBE加密：&quot; + Base64.getEncoder().encode(encodeJdkPBE));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityPBE securityJdkPBE2 = SecurityPBE.getInstance(password, SecurityPBE.PBE_MODE_JDK);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeJdkPBE = securityJdkPBE2.decrypt(encodeJdkPBE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;JDK PBE解密：&quot; + new String(decodeJdkPBE));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	SecurityPBE securityBcPBE = SecurityPBE.getInstance(password, SecurityDES3.DES3_MODE_BC);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] encodeBcPBE = securityBcPBE.encrypt(src.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle PBE加密：&quot; + Base64.getEncoder().encode(encodeBcPBE));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	byte[] decodeBcPBE = securityBcPBE.decrypt(encodeBcPBE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bouncyCastle PBE解密：&quot; + new String(decodeBcPBE));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mac">MAC<a href="#mac" class="hash-link" aria-label="MAC的直接链接" title="MAC的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">消息摘要算法——MAC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAC(Message Authentication Code)，兼容了MD和SHA的特性，并且在它们的基础上加入了密钥。因此MAC也称为HMAC（keyed-Hash Message Authentication Code）含有密钥的散列函数算法。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MD系列：HmacMD2、HmacMD4、HmacMD5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SHA系列：HmacSHA1、HmacSHA224、HmacSHA256、HmacSHA384、HmacSHA512</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.jeecg.modules.p14.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.InvalidKeyException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.NoSuchAlgorithmException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.Mac;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.SecretKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.crypto.spec.SecretKeySpec;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.DecoderException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.commons.codec.binary.Hex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.digests.MD5Digest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.macs.HMac;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.bouncycastle.crypto.params.KeyParameter;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SecurityMac {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * MAC(Message Authentication</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Code)，兼容了MD和SHA的特性，并且在它们的基础上加入了密钥。因此MAC也称为HMAC（keyed-Hash Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Authentication Code）含有密钥的散列函数算法。 MD系列：HmacMD2、HmacMD4、HmacMD5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * SHA系列：HmacSHA1、HmacSHA224、HmacSHA256、HmacSHA384、HmacSHA512</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 例如：常用的Linux客户端SecurityCRT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static String privateKey = &quot;aabbccddee&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * HmacMD5加密算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String jdkHmacMD5(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] hmacMD5Bytes = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 1.得到密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//            KeyGenerator keyGenerator = KeyGenerator.getInstance(&quot;HmacMD5&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//            SecretKey secretKey = keyGenerator.generateKey();// 生成密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//            byte[] key = secretKey.getEncoded();//获得密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 2.还原密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] privKey = Hex.decodeHex(privateKey.toCharArray());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SecretKey restoreSecretKey = new SecretKeySpec(privKey, &quot;HmacMD5&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 3.信息摘要</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Mac mac = Mac.getInstance(restoreSecretKey.getAlgorithm());// 实例化mac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mac.init(restoreSecretKey);// 初始化mac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            hmacMD5Bytes = mac.doFinal(src.getBytes());// 执行摘要</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (NoSuchAlgorithmException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (DecoderException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (InvalidKeyException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Hex.encodeHexString(hmacMD5Bytes);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * HmacMD5加密算法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static String bouncyCastleHmacMD5(String src) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HMac hmac = new HMac(new MD5Digest());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //生成密钥的时候以aabbccddee为基准</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hmac.init(new KeyParameter(org.bouncycastle.util.encoders.Hex.decode(privateKey)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hmac.update(src.getBytes(), 0, src.getBytes().length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 执行摘要</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[]hmacMDdBytes = new byte[hmac.getMacSize()];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hmac.doFinal(hmacMDdBytes, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new String(org.bouncycastle.util.encoders.Hex.encode(hmacMDdBytes));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void mac() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	String src = &quot;object-oriente&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;jdkHmacMD5:\t&quot; + SecurityMac.jdkHmacMD5(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	System.out.println(&quot;bcHmacMD5:\t&quot;+ SecurityMac.bouncyCastleHmacMD5(src));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="哈希算法">哈希算法<a href="#哈希算法" class="hash-link" aria-label="哈希算法的直接链接" title="哈希算法的直接链接">​</a></h3>
<blockquote>
<p>哈希算法可以简单分为两类</p>
<blockquote>
<ol>
<li>
<p>加密哈希算法</p>
<blockquote>
<p>安全性较高的哈希算法，它可以提供一定的数据完整性保护和数据防篡改能力，能够抵御一定的攻击手段，安全性相对较高，但性能较差，适用于对安全性要求较高的场景。例如 SHA2、SHA3、SM3、RIPEMD-160、BLAKE2、SipHash 等等</p>
</blockquote>
</li>
<li>
<p>非加密哈希算法</p>
<blockquote>
<p>安全性相对较低的哈希算法，易受到暴力破解、冲突攻击等攻击手段的影响，但性能较高，适用于对安全性没有要求的业务场景。例如 CRC32、MurMurHash3、SipHash 等等</p>
</blockquote>
</li>
<li>
<p>除了这两种之外，还有一些特殊的哈希算法，例如安全性更高的<strong>慢哈希算法</strong>。</p>
</li>
</ol>
</blockquote>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="私钥公钥签证加密">私钥公钥签证加密<a href="#私钥公钥签证加密" class="hash-link" aria-label="私钥公钥签证加密的直接链接" title="私钥公钥签证加密的直接链接">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//utf-8编码/解密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String encode = URLEncoder.encode(&quot;测试&quot;, &quot;UTF-8&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String decode = URLDecoder.decode(&quot;测试&quot;, &quot;UTF-8&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Private转成String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Base64.getEncoder().encodeToString(privateKey.getEncoded());</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//自定义实现 -- utf-8编码/解密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class EncodingUtil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> public static String decodeURIComponent(String s) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   if (s == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   String result = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result = URLDecoder.decode(s, &quot;UTF-8&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }catch (UnsupportedEncodingException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result = s;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> public static String encodeURIComponent(String s) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   String result = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     result = URLEncoder.encode(s, &quot;UTF-8&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               .replaceAll(&quot;\\+&quot;, &quot;%20&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               .replaceAll(&quot;\\%21&quot;, &quot;!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               .replaceAll(&quot;\\%27&quot;, &quot;&#x27;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               .replaceAll(&quot;\\%28&quot;, &quot;(&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               .replaceAll(&quot;\\%29&quot;, &quot;)&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               .replaceAll(&quot;\\%7E&quot;, &quot;~&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }catch (UnsupportedEncodingException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     result = s;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private EncodingUtil() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   super();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * pfx获取私钥别名等信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static byte[] getPrivateKeyInfo(String content){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String keyAlias = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        KeyStore keyStore = KeyStore.getInstance(&quot;PKCS12&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileInputStream fileInputStream = new FileInputStream(new ClassPathResource(PRIVATE_ADDRESS).getFile());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        char[] nPassword = PRIVATE_PASSWORD.toCharArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        keyStore.load(fileInputStream, nPassword);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fileInputStream.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;keystore type=&quot; + keyStore.getType());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Enumeration&lt;String&gt; enumeration = keyStore.aliases();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (enumeration.hasMoreElements()){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyAlias = enumeration.nextElement();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log.info( &quot;alias=[&quot; + keyAlias + &quot;]&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;is key entry=&quot; + keyStore.isKeyEntry(keyAlias));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PrivateKey privateKey = (PrivateKey) keyStore.getKey(keyAlias, nPassword);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;private: &quot;+Base64.getEncoder().encodeToString(privateKey.getEncoded()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Certificate cert = keyStore.getCertificate(keyAlias);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PublicKey publickey = cert.getPublicKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 导出为 cer 证书</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            FileOutputStream fos = new FileOutputStream(&quot;C:\\Users\\chenx\\Desktop\\test&quot; + &quot;.cer&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fos.write(cert.getEncoded());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fos.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;public: &quot;+Base64.getEncoder().encodeToString(publickey.getEncoded()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;cert class = &quot; + cert.getClass().getName());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;cert = &quot; + cert);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;public key = &quot; + publickey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;private key = &quot; + privateKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //私钥签名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] signOne = sign(content, privateKey) ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info(&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;签名后&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n&quot; + new String(Base64.getEncoder().encode(signOne)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //公钥验签</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        boolean verifySign = verify(content,signOne,publickey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info(&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;验签结果&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n&quot; + verifySign);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (verifySign){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return signOne;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (Exception e){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.error(e.getMessage());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new byte[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//私钥签名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static byte[] sign(String content, PrivateKey priKey) throws NoSuchAlgorithmException, InvalidKeyException, SignatureException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //这里可以从证书中解析出签名算法名称</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //Signature signature = Signature.getInstance(getSigAlgName(pubCert));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Signature signature = Signature.getInstance(&quot;SHA256withRSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signature.initSign(priKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signature.update(content.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return signature.sign();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//公钥验签</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static boolean verify(String content, byte[] sign, PublicKey pubKey) throws NoSuchAlgorithmException, InvalidKeyException, SignatureException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //这里可以从证书中解析出签名算法名称</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //Signature signature = Signature.getInstance(getSigAlgName(priCert));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Signature signature = Signature.getInstance(&quot;SHA256withRSA&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signature.initVerify(pubKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signature.update(content.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return signature.verify(sign);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//参数排序 -- 按字母顺序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static String getSordBaseParamsStr(String jose,String nonce,String timestamp) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Map&lt;String,String&gt; params = getHeaderMaps(nonce,timestamp);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    params.put(&quot;jose&quot;, jose);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TreeMap&lt;String, String&gt; sorted = new TreeMap&lt;&gt;(params);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set&lt;String&gt; keys = params.keySet();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (String key : keys) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sorted.put(key, params.get(key));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    StringBuilder builder = new StringBuilder();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for (Map.Entry&lt;String, String&gt; entry : sorted.entrySet()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (builder.length() &gt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            builder.append(&quot;&amp;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.append(entry.getKey()).append(&quot;=&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (null != entry.getValue()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            builder.append(entry.getValue());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log.info(&quot;*******sb.tostring:&quot; + builder.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return builder.toString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 获取私钥别名等信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static PrivateKey getPrivateKeyInfo() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String privKeyFileString = SHA256WithRSASignatureUtil.PRIVATE_ADDRESS;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String privKeyPswdString = SHA256WithRSASignatureUtil.PRIVATE_PASSWORD;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String keyAlias = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        KeyStore keyStore = KeyStore.getInstance( &quot;PKCS12&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileInputStream fileInputStream = new FileInputStream(new ClassPathResource(privKeyFileString).getFile());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        char[] nPassword = privKeyPswdString.toCharArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        keyStore.load(fileInputStream, nPassword);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fileInputStream.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;keystore type=&quot; + keyStore.getType());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Enumeration&lt;String&gt; enumeration = keyStore.aliases();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (enumeration.hasMoreElements())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyAlias = enumeration.nextElement();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log.info( &quot;alias=[&quot; + keyAlias + &quot;]&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;is key entry=&quot; + keyStore.isKeyEntry(keyAlias));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return  (PrivateKey) keyStore.getKey(keyAlias, nPassword);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.error(&quot;-------获取私钥失败------&quot;,e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new JeecgBootException(&quot;获取私钥失败&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 获取公钥别名等信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static PublicKey getPublicKeyInfo()  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String privKeyFileString = SHA256WithRSASignatureUtil.PRIVATE_ADDRESS;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String privKeyPswdString = SHA256WithRSASignatureUtil.PRIVATE_PASSWORD;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String keyAlias = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        KeyStore keyStore = KeyStore.getInstance( &quot;PKCS12&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileInputStream fileInputStream = new FileInputStream(new ClassPathResource(privKeyFileString).getFile());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        char[] nPassword = privKeyPswdString.toCharArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        keyStore.load(fileInputStream, nPassword);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fileInputStream.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info( &quot;keystore type=&quot; + keyStore.getType());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Enumeration&lt;String&gt; enumeration = keyStore.aliases();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (enumeration.hasMoreElements()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyAlias = enumeration.nextElement();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log.info( &quot;alias=[&quot; + keyAlias + &quot;]&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return keyStore.getCertificate(keyAlias).getPublicKey();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.error(&quot;------获取公钥失败-----&quot;,e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new JeecgBootException(&quot;获取公钥失败&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 加密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param publicKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static String jweEncryption(Key publicKey, String payload)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(&quot;Payload before encryption :: &quot; + payload);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /*Encryption*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JWEHeader header = new JWEHeader.Builder(JWEAlgorithm.RSA_OAEP, EncryptionMethod.A256GCM).build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JWEEncrypter encryptedJWE = new RSAEncrypter((RSAPublicKey) publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JWEObject jweObject = new JWEObject(header, new Payload(getSignedContent(payload)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jweObject.encrypt(encryptedJWE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return jweObject.serialize();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static JWSObject getSignedContent(String content) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Payload contentPayload = new Payload(content);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RSASSASigner rsa = new RSASSASigner(getPrivateKeyInfo());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        JWSHeader header = new JWSHeader(JWSAlgorithm.RS256);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        JWSObject jws = new JWSObject(header, contentPayload);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        jws.sign(rsa);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return jws;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new RuntimeException(e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static String decryptJWE(String data){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JWEObject jweObject;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        jweObject = JWEObject.parse(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Decrypt with shared key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        jweObject.decrypt(new RSADecrypter(getPrivateKeyInfo()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Extract payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SignedJWT signedJWT = jweObject.getPayload().toSignedJWT();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (signedJWT.verify(new RSASSAVerifier((RSAPublicKey) getPublicKeyInfo()))) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //解密数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return jweObject.getPayload().toString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (ParseException | JOSEException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.error(String.valueOf(e));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/mhuahe/mhuahe.com/tree/master/docs/JAVA-Encryption.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/mhuahe.com/docs/JAVA-Elaticsearch"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">JAVA-ES</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/mhuahe.com/docs/JAVA-Error-Record"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">JAVA-Hutool</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#别用md5加密密码了" class="table-of-contents__link toc-highlight">别用MD5加密密码了</a></li><li><a href="#md5" class="table-of-contents__link toc-highlight">MD5</a></li><li><a href="#des" class="table-of-contents__link toc-highlight">DES</a></li><li><a href="#rsa" class="table-of-contents__link toc-highlight">RSA</a></li><li><a href="#idea" class="table-of-contents__link toc-highlight">IDEA</a></li><li><a href="#dsa" class="table-of-contents__link toc-highlight">DSA</a></li><li><a href="#aes" class="table-of-contents__link toc-highlight">AES</a></li><li><a href="#elgamal" class="table-of-contents__link toc-highlight">Elgamal</a></li><li><a href="#base64" class="table-of-contents__link toc-highlight">Base64</a></li><li><a href="#sha" class="table-of-contents__link toc-highlight">SHA</a></li><li><a href="#pkcs" class="table-of-contents__link toc-highlight">PKCS</a></li><li><a href="#ecdsa" class="table-of-contents__link toc-highlight">ECDSA</a></li><li><a href="#dh" class="table-of-contents__link toc-highlight">DH</a></li><li><a href="#pbe" class="table-of-contents__link toc-highlight">PBE</a></li><li><a href="#mac" class="table-of-contents__link toc-highlight">MAC</a></li><li><a href="#哈希算法" class="table-of-contents__link toc-highlight">哈希算法</a></li><li><a href="#私钥公钥签证加密" class="table-of-contents__link toc-highlight">私钥公钥签证加密</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docusaurus.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">开发文档</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.cnblogs.com/minhua" target="_blank" rel="noopener noreferrer" class="footer__link-item">博客园<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://juejin.cn/user/2331397363880808" target="_blank" rel="noopener noreferrer" class="footer__link-item">掘金<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/mihuahe" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mhuahe.com/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/mhuahe" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">&copy;<a href="/mhuahe.com">mhuahe.com</a>
            - <a href="https://github.com/mhuahe/mhuahe.com" target="_blank">GitHub</a>
            - <a href="/mhuahe.com/license/README" target="_blank">License</a>
            - Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>
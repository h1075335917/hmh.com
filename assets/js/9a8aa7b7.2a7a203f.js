"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[729],{3514:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>t,contentTitle:()=>l,default:()=>o,frontMatter:()=>c,metadata:()=>d,toc:()=>h});let d=JSON.parse('{"id":"java/JAVA-Thread","title":"JAVA-\u591A\u7EBF\u7A0B","description":"\u591A\u7EBF\u7A0B\u57FA\u7840","source":"@site/docs/java/JAVA-Thread.md","sourceDirName":"java","slug":"/java/JAVA-Thread","permalink":"/mhuahe.com/docs/java/JAVA-Thread","draft":false,"unlisted":false,"editUrl":"https://github.dev/mhuahe/mhuahe.com/blob/master-ts/docs/java/JAVA-Thread.md","tags":[],"version":"current","lastUpdatedBy":"heminhua","lastUpdatedAt":1725382806000,"frontMatter":{},"sidebar":"java","previous":{"title":"JAVA-SpringCloud\u6280\u672F\u6808","permalink":"/mhuahe.com/docs/java/JAVA-SpringCloud-Stack"},"next":{"title":"JAVA-WebSocket","permalink":"/mhuahe.com/docs/java/JAVA-WebSocket"}}');var i=r(4848),s=r(8453);let c={},l="JAVA-\u591A\u7EBF\u7A0B",t={},h=[{value:"\u591A\u7EBF\u7A0B\u57FA\u7840",id:"\u591A\u7EBF\u7A0B\u57FA\u7840",level:2},{value:"\u521B\u5EFA\u65B0\u7EBF\u7A0B",id:"\u521B\u5EFA\u65B0\u7EBF\u7A0B",level:2},{value:"\u7EBF\u7A0B\u72B6\u6001",id:"\u7EBF\u7A0B\u72B6\u6001",level:2},{value:"\u4E2D\u65AD\u7EBF\u7A0B",id:"\u4E2D\u65AD\u7EBF\u7A0B",level:2},{value:"\u5B88\u62A4\u7EBF\u7A0B",id:"\u5B88\u62A4\u7EBF\u7A0B",level:2},{value:"\u7EBF\u7A0B\u540C\u6B65",id:"\u7EBF\u7A0B\u540C\u6B65",level:2},{value:"\u540C\u6B65\u6982\u5FF5",id:"\u540C\u6B65\u6982\u5FF5",level:3},{value:"\u540C\u6B65\u65B9\u6CD5",id:"\u540C\u6B65\u65B9\u6CD5",level:3},{value:"\u6B7B\u9501",id:"\u6B7B\u9501",level:3},{value:"\u4F7F\u7528wait\u548Cnotify",id:"\u4F7F\u7528wait\u548Cnotify",level:3},{value:"\u4F7F\u7528ReentrantLock",id:"\u4F7F\u7528reentrantlock",level:2}];function a(n){let e={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"java-\u591A\u7EBF\u7A0B",children:"JAVA-\u591A\u7EBF\u7A0B"})}),"\n",(0,i.jsx)(e.h2,{id:"\u591A\u7EBF\u7A0B\u57FA\u7840",children:"\u591A\u7EBF\u7A0B\u57FA\u7840"}),"\n",(0,i.jsxs)(e.p,{children:["Java\u8BED\u8A00\u5185\u7F6E\u4E86\u591A\u7EBF\u7A0B\u652F\u6301\uFF1A\u4E00\u4E2AJava\u7A0B\u5E8F\u5B9E\u9645\u4E0A\u662F\u4E00\u4E2AJVM\u8FDB\u7A0B\uFF0CJVM\u8FDB\u7A0B\u7528\u4E00\u4E2A\u4E3B\u7EBF\u7A0B\u6765\u6267\u884C",(0,i.jsx)(e.code,{children:"main()"}),"\u65B9\u6CD5\uFF0C\u5728",(0,i.jsx)(e.code,{children:"main()"}),"\u65B9\u6CD5\u5185\u90E8\uFF0C\u6211\u4EEC\u53C8\u53EF\u4EE5\u542F\u52A8\u591A\u4E2A\u7EBF\u7A0B\u3002\u6B64\u5916\uFF0CJVM\u8FD8\u6709\u8D1F\u8D23\u5783\u573E\u56DE\u6536\u7684\u5176\u4ED6\u5DE5\u4F5C\u7EBF\u7A0B\u7B49\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u56E0\u6B64\uFF0C\u5BF9\u4E8E\u5927\u591A\u6570Java\u7A0B\u5E8F\u6765\u8BF4\uFF0C\u6211\u4EEC\u8BF4\u591A\u4EFB\u52A1\uFF0C\u5B9E\u9645\u4E0A\u662F\u8BF4\u5982\u4F55\u4F7F\u7528\u591A\u7EBF\u7A0B\u5B9E\u73B0\u591A\u4EFB\u52A1\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u548C\u5355\u7EBF\u7A0B\u76F8\u6BD4\uFF0C\u591A\u7EBF\u7A0B\u7F16\u7A0B\u7684\u7279\u70B9\u5728\u4E8E\uFF1A\u591A\u7EBF\u7A0B\u7ECF\u5E38\u9700\u8981\u8BFB\u5199\u5171\u4EAB\u6570\u636E\uFF0C\u5E76\u4E14\u9700\u8981\u540C\u6B65\u3002\u4F8B\u5982\uFF0C\u64AD\u653E\u7535\u5F71\u65F6\uFF0C\u5C31\u5FC5\u987B\u7531\u4E00\u4E2A\u7EBF\u7A0B\u64AD\u653E\u89C6\u9891\uFF0C\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u64AD\u653E\u97F3\u9891\uFF0C\u4E24\u4E2A\u7EBF\u7A0B\u9700\u8981\u534F\u8C03\u8FD0\u884C\uFF0C\u5426\u5219\u753B\u9762\u548C\u58F0\u97F3\u5C31\u4E0D\u540C\u6B65\u3002\u56E0\u6B64\uFF0C\u591A\u7EBF\u7A0B\u7F16\u7A0B\u7684\u590D\u6742\u5EA6\u9AD8\uFF0C\u8C03\u8BD5\u66F4\u56F0\u96BE\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u521B\u5EFA\u65B0\u7EBF\u7A0B",children:"\u521B\u5EFA\u65B0\u7EBF\u7A0B"}),"\n",(0,i.jsxs)(e.p,{children:["\u8981\u521B\u5EFA\u4E00\u4E2A\u65B0\u7EBF\u7A0B\u975E\u5E38\u5BB9\u6613\uFF0C\u6211\u4EEC\u9700\u8981\u5B9E\u4F8B\u5316\u4E00\u4E2A",(0,i.jsx)(e.code,{children:"Thread"}),"\u5B9E\u4F8B\uFF0C\u7136\u540E\u8C03\u7528\u5B83\u7684",(0,i.jsx)(e.code,{children:"start()"}),"\u65B9\u6CD5\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"Thread t = new Thread();\r\nt.start(); // \u542F\u52A8\u65B0\u7EBF\u7A0B\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4F46\u662F\u8FD9\u4E2A\u7EBF\u7A0B\u542F\u52A8\u540E\u5B9E\u9645\u4E0A\u4EC0\u4E48\u4E5F\u4E0D\u505A\u5C31\u7ACB\u523B\u7ED3\u675F\u4E86\u3002\u6211\u4EEC\u5E0C\u671B\u65B0\u7EBF\u7A0B\u80FD\u6267\u884C\u6307\u5B9A\u7684\u4EE3\u7801\uFF0C\u6709\u4EE5\u4E0B\u51E0\u79CD\u65B9\u6CD5\uFF1A"}),"\n",(0,i.jsxs)(e.p,{children:["\u65B9\u6CD5\u4E00\uFF1A\u4ECE",(0,i.jsx)(e.code,{children:"Thread"}),"\u6D3E\u751F\u4E00\u4E2A\u81EA\u5B9A\u4E49\u7C7B\uFF0C\u7136\u540E\u8986\u5199",(0,i.jsx)(e.code,{children:"run()"}),"\u65B9\u6CD5\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// \u591A\u7EBF\u7A0B\r\npublic class Main {\r\n    public static void main(String[] args) {\r\n        Thread t = new MyThread();\r\n        t.start(); // \u542F\u52A8\u65B0\u7EBF\u7A0B\r\n    }\r\n}\r\nclass MyThread extends Thread {\r\n    @Override\r\n    public void run() {\r\n        System.out.println("start new thread!");\r\n    }\r\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u65B9\u6CD5\u4E8C\uFF1A\u521B\u5EFA",(0,i.jsx)(e.code,{children:"Thread"}),"\u5B9E\u4F8B\u65F6\uFF0C\u4F20\u5165\u4E00\u4E2A",(0,i.jsx)(e.code,{children:"Runnable"}),"\u5B9E\u4F8B\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// \u591A\u7EBF\u7A0B\r\npublic class Main {\r\n    public static void main(String[] args) {\r\n        Thread t = new Thread(new MyRunnable());\r\n        t.start(); // \u542F\u52A8\u65B0\u7EBF\u7A0B\r\n    }\r\n}\r\nclass MyRunnable implements Runnable {\r\n    @Override\r\n    public void run() {\r\n        System.out.println("start new thread!");\r\n    }\r\n}\r\n//\u6216\u8005\u7528Java 8\u5F15\u5165\u7684lambda\u8BED\u6CD5\u8FDB\u4E00\u6B65\u7B80\u5199\u4E3A\uFF1A\r\nThread t = new Thread(() -> {\r\n    System.out.println("start new thread!");\r\n});\r\nt.start(); // \u542F\u52A8\u65B0\u7EBF\u7A0B\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u65B9\u6CD5\u4E09\uFF1A\u901A\u8FC7 Callable \u548C Future \u521B\u5EFA\u7EBF\u7A0B\uFF1A"}),"\n",(0,i.jsx)(e.p,{children:"\u5B9E\u73B0\u4E86Runnable\u63A5\u53E3\u7684FutureTask\u4F5C\u4E3A\u8F6C\u6362\u5668\uFF0C\u5728run()\u65B9\u6CD5\u4E2D\u8C03\u7528Callable\u7684call()\u65B9\u6CD5\uFF0C\u672C\u8D28\u4E0A\u8FD8\u662F\u5B9E\u73B0Runnable\u63A5\u53E3\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class CallableThreadTest implements Callable<Integer> {\r\n    public static void main(String[] args) {\r\n        CallableThreadTest ctt = new CallableThreadTest();\r\n        FutureTask<Integer> ft = new FutureTask<>(ctt);\r\n        for (int i = 0; i < 100; i++) {\r\n            System.out.println(Thread.currentThread().getName() + " \u7684\u5FAA\u73AF\u53D8\u91CFi\u7684\u503C" + i);\r\n            if (i == 20) {\r\n                new Thread(ft, "\u6709\u8FD4\u56DE\u503C\u7684\u7EBF\u7A0B").start();\r\n            }\r\n        }\r\n        try {\r\n            System.out.println("\u5B50\u7EBF\u7A0B\u7684\u8FD4\u56DE\u503C\uFF1A" + ft.get());\r\n        } catch (InterruptedException e) {\r\n            e.printStackTrace();\r\n        } catch (ExecutionException e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n    @Override\r\n    public Integer call() throws Exception {\r\n        int i = 0;\r\n        for (; i < 100; i++) {\r\n            System.out.println(Thread.currentThread().getName() + " " + i);\r\n        }\r\n        return i;\r\n    }\r\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u6CE8\u610F\uFF1A\u76F4\u63A5\u8C03\u7528",(0,i.jsx)(e.code,{children:"Thread"}),"\u5B9E\u4F8B\u7684",(0,i.jsx)(e.code,{children:"run()"}),"\u65B9\u6CD5\u662F\u65E0\u6548\u7684\uFF1A"]}),"\n",(0,i.jsxs)(e.p,{children:["\u76F4\u63A5\u8C03\u7528",(0,i.jsx)(e.code,{children:"run()"}),"\u65B9\u6CD5\uFF0C\u76F8\u5F53\u4E8E\u8C03\u7528\u4E86\u4E00\u4E2A\u666E\u901A\u7684Java\u65B9\u6CD5\uFF0C\u5F53\u524D\u7EBF\u7A0B\u5E76\u6CA1\u6709\u4EFB\u4F55\u6539\u53D8\uFF0C\u4E5F\u4E0D\u4F1A\u542F\u52A8\u65B0\u7EBF\u7A0B\u3002\u4E0A\u8FF0\u4EE3\u7801\u5B9E\u9645\u4E0A\u662F\u5728",(0,i.jsx)(e.code,{children:"main()"}),"\u65B9\u6CD5\u5185\u90E8\u53C8\u8C03\u7528\u4E86",(0,i.jsx)(e.code,{children:"run()"}),"\u65B9\u6CD5\uFF0C\u6253\u5370",(0,i.jsx)(e.code,{children:"hello"}),"\u8BED\u53E5\u662F\u5728",(0,i.jsx)(e.code,{children:"main"}),"\u7EBF\u7A0B\u4E2D\u6267\u884C\u7684\uFF0C\u6CA1\u6709\u4EFB\u4F55\u65B0\u7EBF\u7A0B\u88AB\u521B\u5EFA\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5FC5\u987B\u8C03\u7528",(0,i.jsx)(e.code,{children:"Thread"}),"\u5B9E\u4F8B\u7684",(0,i.jsx)(e.code,{children:"start()"}),"\u65B9\u6CD5\u624D\u80FD\u542F\u52A8\u65B0\u7EBF\u7A0B\uFF0C\u5982\u679C\u6211\u4EEC\u67E5\u770B",(0,i.jsx)(e.code,{children:"Thread"}),"\u7C7B\u7684\u6E90\u4EE3\u7801\uFF0C\u4F1A\u770B\u5230",(0,i.jsx)(e.code,{children:"start()"}),"\u65B9\u6CD5\u5185\u90E8\u8C03\u7528\u4E86\u4E00\u4E2A",(0,i.jsx)(e.code,{children:"private native void start0()"}),"\u65B9\u6CD5\uFF0C",(0,i.jsx)(e.code,{children:"native"}),"\u4FEE\u9970\u7B26\u8868\u793A\u8FD9\u4E2A\u65B9\u6CD5\u662F\u7531JVM\u865A\u62DF\u673A\u5185\u90E8\u7684C\u4EE3\u7801\u5B9E\u73B0\u7684\uFF0C\u4E0D\u662F\u7531Java\u4EE3\u7801\u5B9E\u73B0\u7684\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u7EBF\u7A0B\u7684\u4F18\u5148\u7EA7"}),"\n",(0,i.jsx)(e.p,{children:"\u53EF\u4EE5\u5BF9\u7EBF\u7A0B\u8BBE\u5B9A\u4F18\u5148\u7EA7\uFF0C\u8BBE\u5B9A\u4F18\u5148\u7EA7\u7684\u65B9\u6CD5\u662F\uFF1A"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.code,{children:"Thread.setPriority(int n) // 1~10, \u9ED8\u8BA4\u503C5"})}),"\n",(0,i.jsx)(e.p,{children:"JVM\u81EA\u52A8\u628A1\uFF08\u4F4E\uFF09~10\uFF08\u9AD8\uFF09\u7684\u4F18\u5148\u7EA7\u6620\u5C04\u5230\u64CD\u4F5C\u7CFB\u7EDF\u5B9E\u9645\u4F18\u5148\u7EA7\u4E0A\uFF08\u4E0D\u540C\u64CD\u4F5C\u7CFB\u7EDF\u6709\u4E0D\u540C\u7684\u4F18\u5148\u7EA7\u6570\u91CF\uFF09\u3002\u4F18\u5148\u7EA7\u9AD8\u7684\u7EBF\u7A0B\u88AB\u64CD\u4F5C\u7CFB\u7EDF\u8C03\u5EA6\u7684\u4F18\u5148\u7EA7\u8F83\u9AD8\uFF0C\u64CD\u4F5C\u7CFB\u7EDF\u5BF9\u9AD8\u4F18\u5148\u7EA7\u7EBF\u7A0B\u53EF\u80FD\u8C03\u5EA6\u66F4\u9891\u7E41\uFF0C\u4F46\u6211\u4EEC\u51B3\u4E0D\u80FD\u901A\u8FC7\u8BBE\u7F6E\u4F18\u5148\u7EA7\u6765\u786E\u4FDD\u9AD8\u4F18\u5148\u7EA7\u7684\u7EBF\u7A0B\u4E00\u5B9A\u4F1A\u5148\u6267\u884C\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u7EBF\u7A0B\u72B6\u6001",children:"\u7EBF\u7A0B\u72B6\u6001"}),"\n",(0,i.jsxs)(e.p,{children:["\u5728Java\u7A0B\u5E8F\u4E2D\uFF0C\u4E00\u4E2A\u7EBF\u7A0B\u5BF9\u8C61\u53EA\u80FD\u8C03\u7528\u4E00\u6B21",(0,i.jsx)(e.code,{children:"start()"}),"\u65B9\u6CD5\u542F\u52A8\u65B0\u7EBF\u7A0B\uFF0C\u5E76\u5728\u65B0\u7EBF\u7A0B\u4E2D\u6267\u884C",(0,i.jsx)(e.code,{children:"run()"}),"\u65B9\u6CD5\u3002\u4E00\u65E6",(0,i.jsx)(e.code,{children:"run()"}),"\u65B9\u6CD5\u6267\u884C\u5B8C\u6BD5\uFF0C\u7EBF\u7A0B\u5C31\u7ED3\u675F\u4E86\u3002\u56E0\u6B64\uFF0CJava\u7EBF\u7A0B\u7684\u72B6\u6001\u6709\u4EE5\u4E0B\u51E0\u79CD\uFF1A"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"New\uFF1A\u65B0\u521B\u5EFA\u7684\u7EBF\u7A0B\uFF0C\u5C1A\u672A\u6267\u884C\uFF1B"}),"\n",(0,i.jsxs)(e.li,{children:["Runnable\uFF1A\u8FD0\u884C\u4E2D\u7684\u7EBF\u7A0B\uFF0C\u6B63\u5728\u6267\u884C",(0,i.jsx)(e.code,{children:"run()"}),"\u65B9\u6CD5\u7684Java\u4EE3\u7801\uFF1B"]}),"\n",(0,i.jsx)(e.li,{children:"Blocked\uFF1A\u8FD0\u884C\u4E2D\u7684\u7EBF\u7A0B\uFF0C\u56E0\u4E3A\u67D0\u4E9B\u64CD\u4F5C\u88AB\u963B\u585E\u800C\u6302\u8D77\uFF1B"}),"\n",(0,i.jsx)(e.li,{children:"Waiting\uFF1A\u8FD0\u884C\u4E2D\u7684\u7EBF\u7A0B\uFF0C\u56E0\u4E3A\u67D0\u4E9B\u64CD\u4F5C\u5728\u7B49\u5F85\u4E2D\uFF1B"}),"\n",(0,i.jsxs)(e.li,{children:["Timed Waiting\uFF1A\u8FD0\u884C\u4E2D\u7684\u7EBF\u7A0B\uFF0C\u56E0\u4E3A\u6267\u884C",(0,i.jsx)(e.code,{children:"sleep()"}),"\u65B9\u6CD5\u6B63\u5728\u8BA1\u65F6\u7B49\u5F85\uFF1B"]}),"\n",(0,i.jsxs)(e.li,{children:["Terminated\uFF1A\u7EBF\u7A0B\u5DF2\u7EC8\u6B62\uFF0C\u56E0\u4E3A",(0,i.jsx)(e.code,{children:"run()"}),"\u65B9\u6CD5\u6267\u884C\u5B8C\u6BD5\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5F53\u7EBF\u7A0B\u542F\u52A8\u540E\uFF0C\u5B83\u53EF\u4EE5\u5728",(0,i.jsx)(e.code,{children:"Runnable"}),"\u3001",(0,i.jsx)(e.code,{children:"Blocked"}),"\u3001",(0,i.jsx)(e.code,{children:"Waiting"}),"\u548C",(0,i.jsx)(e.code,{children:"Timed Waiting"}),"\u8FD9\u51E0\u4E2A\u72B6\u6001\u4E4B\u95F4\u5207\u6362\uFF0C\u76F4\u5230\u6700\u540E\u53D8\u6210",(0,i.jsx)(e.code,{children:"Terminated"}),"\u72B6\u6001\uFF0C\u7EBF\u7A0B\u7EC8\u6B62\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u7EBF\u7A0B\u7EC8\u6B62\u7684\u539F\u56E0\u6709\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u7EBF\u7A0B\u6B63\u5E38\u7EC8\u6B62\uFF1A",(0,i.jsx)(e.code,{children:"run()"}),"\u65B9\u6CD5\u6267\u884C\u5230",(0,i.jsx)(e.code,{children:"return"}),"\u8BED\u53E5\u8FD4\u56DE\uFF1B"]}),"\n",(0,i.jsxs)(e.li,{children:["\u7EBF\u7A0B\u610F\u5916\u7EC8\u6B62\uFF1A",(0,i.jsx)(e.code,{children:"run()"}),"\u65B9\u6CD5\u56E0\u4E3A\u672A\u6355\u83B7\u7684\u5F02\u5E38\u5BFC\u81F4\u7EBF\u7A0B\u7EC8\u6B62\uFF1B"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5BF9\u67D0\u4E2A\u7EBF\u7A0B\u7684",(0,i.jsx)(e.code,{children:"Thread"}),"\u5B9E\u4F8B\u8C03\u7528",(0,i.jsx)(e.code,{children:"stop()"}),"\u65B9\u6CD5\u5F3A\u5236\u7EC8\u6B62\uFF08\u5F3A\u70C8\u4E0D\u63A8\u8350\u4F7F\u7528\uFF09\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u4E00\u4E2A\u7EBF\u7A0B\u8FD8\u53EF\u4EE5\u7B49\u5F85\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u76F4\u5230\u5176\u8FD0\u884C\u7ED3\u675F\u3002\u4F8B\u5982\uFF0C",(0,i.jsx)(e.code,{children:"main"}),"\u7EBF\u7A0B\u5728\u542F\u52A8",(0,i.jsx)(e.code,{children:"t"}),"\u7EBF\u7A0B\u540E\uFF0C\u53EF\u4EE5\u901A\u8FC7",(0,i.jsx)(e.code,{children:"t.join()"}),"\u7B49\u5F85",(0,i.jsx)(e.code,{children:"t"}),"\u7EBF\u7A0B\u7ED3\u675F\u540E\u518D\u7EE7\u7EED\u8FD0\u884C\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// \u591A\u7EBF\u7A0B\r\npublic class Main {\r\n    public static void main(String[] args) throws InterruptedException {\r\n        Thread t = new Thread(() -> {\r\n            System.out.println("hello");\r\n        });\r\n        System.out.println("start");\r\n        t.start(); // \u542F\u52A8t\u7EBF\u7A0B\r\n        t.join(); // \u6B64\u5904main\u7EBF\u7A0B\u4F1A\u7B49\u5F85t\u7ED3\u675F\r\n        System.out.println("end");\r\n    }\r\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u679C",(0,i.jsx)(e.code,{children:"t"}),"\u7EBF\u7A0B\u5DF2\u7ECF\u7ED3\u675F\uFF0C\u5BF9\u5B9E\u4F8B",(0,i.jsx)(e.code,{children:"t"}),"\u8C03\u7528",(0,i.jsx)(e.code,{children:"join()"}),"\u4F1A\u7ACB\u523B\u8FD4\u56DE\u3002\u6B64\u5916\uFF0C",(0,i.jsx)(e.code,{children:"join(long)"}),"\u7684\u91CD\u8F7D\u65B9\u6CD5\u4E5F\u53EF\u4EE5\u6307\u5B9A\u4E00\u4E2A\u7B49\u5F85\u65F6\u95F4\uFF0C\u8D85\u8FC7\u7B49\u5F85\u65F6\u95F4\u540E\u5C31\u4E0D\u518D\u7EE7\u7EED\u7B49\u5F85\u3002"]}),"\n",(0,i.jsx)(e.h2,{id:"\u4E2D\u65AD\u7EBF\u7A0B",children:"\u4E2D\u65AD\u7EBF\u7A0B"}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u679C\u7EBF\u7A0B\u9700\u8981\u6267\u884C\u4E00\u4E2A\u957F\u65F6\u95F4\u4EFB\u52A1\uFF0C\u5C31\u53EF\u80FD\u9700\u8981\u80FD\u4E2D\u65AD\u7EBF\u7A0B\u3002\u4E2D\u65AD\u7EBF\u7A0B\u5C31\u662F\u5176\u4ED6\u7EBF\u7A0B\u7ED9\u8BE5\u7EBF\u7A0B\u53D1\u4E00\u4E2A\u4FE1\u53F7\uFF0C\u8BE5\u7EBF\u7A0B\u6536\u5230\u4FE1\u53F7\u540E\u7ED3\u675F\u6267\u884C",(0,i.jsx)(e.code,{children:"run()"}),"\u65B9\u6CD5\uFF0C\u4F7F\u5F97\u81EA\u8EAB\u7EBF\u7A0B\u80FD\u7ACB\u523B\u7ED3\u675F\u8FD0\u884C\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4EEC\u4E3E\u4E2A\u6817\u5B50\uFF1A\u5047\u8BBE\u4ECE\u7F51\u7EDC\u4E0B\u8F7D\u4E00\u4E2A100M\u7684\u6587\u4EF6\uFF0C\u5982\u679C\u7F51\u901F\u5F88\u6162\uFF0C\u7528\u6237\u7B49\u5F97\u4E0D\u8010\u70E6\uFF0C\u5C31\u53EF\u80FD\u5728\u4E0B\u8F7D\u8FC7\u7A0B\u4E2D\u70B9\u201C\u53D6\u6D88\u201D\uFF0C\u8FD9\u65F6\uFF0C\u7A0B\u5E8F\u5C31\u9700\u8981\u4E2D\u65AD\u4E0B\u8F7D\u7EBF\u7A0B\u7684\u6267\u884C\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u4E2D\u65AD\u4E00\u4E2A\u7EBF\u7A0B\u975E\u5E38\u7B80\u5355\uFF0C\u53EA\u9700\u8981\u5728\u5176\u4ED6\u7EBF\u7A0B\u4E2D\u5BF9\u76EE\u6807\u7EBF\u7A0B\u8C03\u7528",(0,i.jsx)(e.code,{children:"interrupt()"}),"\u65B9\u6CD5\uFF0C\u76EE\u6807\u7EBF\u7A0B\u9700\u8981\u53CD\u590D\u68C0\u6D4B\u81EA\u8EAB\u72B6\u6001\u662F\u5426\u662Finterrupted\u72B6\u6001\uFF0C\u5982\u679C\u662F\uFF0C\u5C31\u7ACB\u523B\u7ED3\u675F\u8FD0\u884C\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Test\r\npublic void interruptThread() throws InterruptedException {\r\n    Thread t = new MyThread();\r\n    t.start();\r\n    Thread.sleep(1); // \u6682\u505C1\u6BEB\u79D2\r\n    t.interrupt(); // \u4E2D\u65ADt\u7EBF\u7A0B\r\n    t.join(); // \u7B49\u5F85t\u7EBF\u7A0B\u7ED3\u675F\r\n    System.out.println("end");\r\n}\r\nstatic class MyThread extends Thread {\r\n    public void run() {\r\n        int n = 0;\r\n        while (!isInterrupted()) {\r\n            n++;\r\n            System.out.println(n + " hello!");\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u4ED4\u7EC6\u770B\u4E0A\u8FF0\u4EE3\u7801\uFF0C",(0,i.jsx)(e.code,{children:"main"}),"\u7EBF\u7A0B\u901A\u8FC7\u8C03\u7528",(0,i.jsx)(e.code,{children:"t.interrupt()"}),"\u65B9\u6CD5\u4E2D\u65AD",(0,i.jsx)(e.code,{children:"t"}),"\u7EBF\u7A0B\uFF0C\u4F46\u662F\u8981\u6CE8\u610F\uFF0C",(0,i.jsx)(e.code,{children:"interrupt()"}),"\u65B9\u6CD5\u4EC5\u4EC5\u5411",(0,i.jsx)(e.code,{children:"t"}),"\u7EBF\u7A0B\u53D1\u51FA\u4E86\u201C\u4E2D\u65AD\u8BF7\u6C42\u201D\uFF0C\u81F3\u4E8E",(0,i.jsx)(e.code,{children:"t"}),"\u7EBF\u7A0B\u662F\u5426\u80FD\u7ACB\u523B\u54CD\u5E94\uFF0C\u8981\u770B\u5177\u4F53\u4EE3\u7801\u3002\u800C",(0,i.jsx)(e.code,{children:"t"}),"\u7EBF\u7A0B\u7684",(0,i.jsx)(e.code,{children:"while"}),"\u5FAA\u73AF\u4F1A\u68C0\u6D4B",(0,i.jsx)(e.code,{children:"isInterrupted()"}),"\uFF0C\u6240\u4EE5\u4E0A\u8FF0\u4EE3\u7801\u80FD\u6B63\u786E\u54CD\u5E94",(0,i.jsx)(e.code,{children:"interrupt()"}),"\u8BF7\u6C42\uFF0C\u4F7F\u5F97\u81EA\u8EAB\u7ACB\u523B\u7ED3\u675F\u8FD0\u884C",(0,i.jsx)(e.code,{children:"run()"}),"\u65B9\u6CD5\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'important@Test\r\npublic void interruptThread2() throws InterruptedException {\r\n    Thread t = new MyThread2();\r\n    t.start();\r\n    Thread.sleep(1000);\r\n    t.interrupt(); // \u4E2D\u65ADt\u7EBF\u7A0B\r\n    t.join(); // \u7B49\u5F85t\u7EBF\u7A0B\u7ED3\u675F\r\n    System.out.println("end");\r\n}\r\nstatic class MyThread2 extends Thread {\r\n    public void run() {\r\n        Thread hello = new HelloThread();\r\n        hello.start(); // \u542F\u52A8hello\u7EBF\u7A0B\r\n        try {\r\n            hello.join(); // \u7B49\u5F85hello\u7EBF\u7A0B\u7ED3\u675F\r\n        } catch (InterruptedException e) {\r\n            System.out.println("MyThread2 interrupted!");\r\n        }\r\n        hello.interrupt();\r\n    }\r\n}\r\nstatic class HelloThread extends Thread {\r\n    public void run() {\r\n        int n = 0;\r\n        while (!isInterrupted()) {\r\n            n++;\r\n            System.out.println(n + " hello!");\r\n            try {\r\n                Thread.sleep(100);\r\n            } catch (InterruptedException e) {\r\n                System.out.println("HelloThread interrupted!");\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"[!tip]"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"HelloThead\u7C7B\u91CC\u4F1A\u629B\u51FA InterruptedException \u5F02\u5E38\uFF1F\u5982\u679C\u53BB\u6389HelloThead\u7C7B\u91CC\u7684break\u4F1A\u6B7B\u5FAA\u73AF\uFF1F"})}),"\n",(0,i.jsx)(e.p,{children:"MyThread\u4E2D\u8C03\u7528 hello.interrupt() \u540E\uFF0CHelloThread\u4E2D\u7684 isInterrupted() \u5DF2\u7ECF\u53D8\u6210\u4E86true\uFF0C\u5982\u679C\u6B64\u65F6HelloThread\u6CA1\u6709\u5728sleep\u72B6\u6001\uFF0Cwhile\u5224\u65AD !isInterrupted() \u4E3Afalse\u4F1A\u76F4\u63A5\u7ED3\u675F\u7EBF\u7A0B\uFF1B\u5982\u679C\u6B64\u65F6HelloThread\u5728sleep\u72B6\u6001\uFF0C\u4F1A\u76F4\u63A5\u629B\u51FAInterruptedException\u5F02\u5E38\uFF0C\u5E76\u6E05\u9664\u4E2D\u65AD\u72B6\u6001\uFF0C\u5373isInterrupted() \u4F1A\u8FD4\u56DEfalse\uFF0C\u5982\u679C\u6CA1\u6709break\u7684\u8BDD\uFF0Cwhile\u4F1A\u6761\u4EF6\u4F1A\u4E00\u76F4\u8FD4\u56DEtrue\uFF0C\u5C31\u6B7B\u5FAA\u73AF\u4E86\uFF1B\u7EFC\u4E0A\uFF0C\u6CA1\u6709break\u5927\u6982\u7387\u4F1A\u5BFC\u81F4\u6B7B\u5FAA\u73AF\uFF0C\u4F46\u4E0D\u662F\u4E00\u5B9A\u4F1A\u6B7B\u5FAA\u73AF\uFF0C\u52A0break\u662F\u4E3A\u4E86\u4FDD\u8BC1\u4EE3\u7801\u7684\u5065\u58EE\uFF0C\u6240\u4EE5\u4E5F\u662F\u5FC5\u987B\u8981\u52A0\u7684\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u53EA\u6709sleep/wait\u72B6\u6001\u7684\u7EBF\u7A0B\u4F1A\u54CD\u5E94interrupt\uFF0C\u4E2D\u65AD\u7EBF\u7A0B\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"main"}),"\u7EBF\u7A0B\u901A\u8FC7\u8C03\u7528",(0,i.jsx)(e.code,{children:"t.interrupt()"}),"\u4ECE\u800C\u901A\u77E5",(0,i.jsx)(e.code,{children:"t"}),"\u7EBF\u7A0B\u4E2D\u65AD\uFF0C\u800C\u6B64\u65F6",(0,i.jsx)(e.code,{children:"t"}),"\u7EBF\u7A0B\u6B63\u4F4D\u4E8E",(0,i.jsx)(e.code,{children:"hello.join()"}),"\u7684\u7B49\u5F85\u4E2D\uFF0C\u6B64\u65B9\u6CD5\u4F1A\u7ACB\u523B\u7ED3\u675F\u7B49\u5F85\u5E76\u629B\u51FA",(0,i.jsx)(e.code,{children:"InterruptedException"}),"\u3002\u7531\u4E8E\u6211\u4EEC\u5728",(0,i.jsx)(e.code,{children:"t"}),"\u7EBF\u7A0B\u4E2D\u6355\u83B7\u4E86",(0,i.jsx)(e.code,{children:"InterruptedException"}),"\uFF0C\u56E0\u6B64\uFF0C\u5C31\u53EF\u4EE5\u51C6\u5907\u7ED3\u675F\u8BE5\u7EBF\u7A0B\u3002\u5728",(0,i.jsx)(e.code,{children:"t"}),"\u7EBF\u7A0B\u7ED3\u675F\u524D\uFF0C\u5BF9",(0,i.jsx)(e.code,{children:"hello"}),"\u7EBF\u7A0B\u4E5F\u8FDB\u884C\u4E86",(0,i.jsx)(e.code,{children:"interrupt()"}),"\u8C03\u7528\u901A\u77E5\u5176\u4E2D\u65AD\u3002\u5982\u679C\u53BB\u6389\u8FD9\u4E00\u884C\u4EE3\u7801\uFF0C\u53EF\u4EE5\u53D1\u73B0",(0,i.jsx)(e.code,{children:"hello"}),"\u7EBF\u7A0B\u4ECD\u7136\u4F1A\u7EE7\u7EED\u8FD0\u884C\uFF0C\u4E14JVM\u4E0D\u4F1A\u9000\u51FA\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u53E6\u4E00\u4E2A\u5E38\u7528\u7684\u4E2D\u65AD\u7EBF\u7A0B\u7684\u65B9\u6CD5\u662F\u8BBE\u7F6E\u6807\u5FD7\u4F4D\u3002\u6211\u4EEC\u901A\u5E38\u4F1A\u7528\u4E00\u4E2A",(0,i.jsx)(e.code,{children:"running"}),"\u6807\u5FD7\u4F4D\u6765\u6807\u8BC6\u7EBF\u7A0B\u662F\u5426\u5E94\u8BE5\u7EE7\u7EED\u8FD0\u884C\uFF0C\u5728\u5916\u90E8\u7EBF\u7A0B\u4E2D\uFF0C\u901A\u8FC7\u628A",(0,i.jsx)(e.code,{children:"HelloThread.running"}),"\u7F6E\u4E3A",(0,i.jsx)(e.code,{children:"false"}),"\uFF0C\u5C31\u53EF\u4EE5\u8BA9\u7EBF\u7A0B\u7ED3\u675F\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Test\r\npublic void interruptThread3() throws InterruptedException {\r\n    HelloThread2 t = new HelloThread2();\r\n    t.start();\r\n    Thread.sleep(1);\r\n    t.running = false; // \u6807\u5FD7\u4F4D\u7F6E\u4E3Afalse\r\n}\r\nstatic class HelloThread2 extends Thread {\r\n    public volatile boolean running = true;\r\n    public void run() {\r\n        int n = 0;\r\n        while (running) {\r\n            n++;\r\n            System.out.println(n + " hello!");\r\n        }\r\n        System.out.println("end!");\r\n    }\r\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u6CE8\u610F\u5230",(0,i.jsx)(e.code,{children:"HelloThread"}),"\u7684\u6807\u5FD7\u4F4D",(0,i.jsx)(e.code,{children:"boolean running"}),"\u662F\u4E00\u4E2A\u7EBF\u7A0B\u95F4\u5171\u4EAB\u7684\u53D8\u91CF\u3002\u7EBF\u7A0B\u95F4\u5171\u4EAB\u53D8\u91CF\u9700\u8981\u4F7F\u7528",(0,i.jsx)(e.code,{children:"volatile"}),"\u5173\u952E\u5B57\u6807\u8BB0\uFF0C\u786E\u4FDD\u6BCF\u4E2A\u7EBF\u7A0B\u90FD\u80FD\u8BFB\u53D6\u5230\u66F4\u65B0\u540E\u7684\u53D8\u91CF\u503C\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u4E3A\u4EC0\u4E48\u8981\u5BF9\u7EBF\u7A0B\u95F4\u5171\u4EAB\u7684\u53D8\u91CF\u7528\u5173\u952E\u5B57",(0,i.jsx)(e.code,{children:"volatile"}),"\u58F0\u660E\uFF1F\u8FD9\u6D89\u53CA\u5230Java\u7684\u5185\u5B58\u6A21\u578B\u3002\u5728Java\u865A\u62DF\u673A\u4E2D\uFF0C\u53D8\u91CF\u7684\u503C\u4FDD\u5B58\u5728\u4E3B\u5185\u5B58\u4E2D\uFF0C\u4F46\u662F\uFF0C\u5F53\u7EBF\u7A0B\u8BBF\u95EE\u53D8\u91CF\u65F6\uFF0C\u5B83\u4F1A\u5148\u83B7\u53D6\u4E00\u4E2A\u526F\u672C\uFF0C\u5E76\u4FDD\u5B58\u5728\u81EA\u5DF1\u7684\u5DE5\u4F5C\u5185\u5B58\u4E2D\u3002\u5982\u679C\u7EBF\u7A0B\u4FEE\u6539\u4E86\u53D8\u91CF\u7684\u503C\uFF0C\u865A\u62DF\u673A\u4F1A\u5728\u67D0\u4E2A\u65F6\u523B\u628A\u4FEE\u6539\u540E\u7684\u503C\u56DE\u5199\u5230\u4E3B\u5185\u5B58\uFF0C\u4F46\u662F\uFF0C\u8FD9\u4E2A\u65F6\u95F4\u662F\u4E0D\u786E\u5B9A\u7684\uFF01"]}),"\n",(0,i.jsx)(e.p,{children:"\u8FD9\u4F1A\u5BFC\u81F4\u5982\u679C\u4E00\u4E2A\u7EBF\u7A0B\u66F4\u65B0\u4E86\u67D0\u4E2A\u53D8\u91CF\uFF0C\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u8BFB\u53D6\u7684\u503C\u53EF\u80FD\u8FD8\u662F\u66F4\u65B0\u524D\u7684\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u56E0\u6B64\uFF0C",(0,i.jsx)(e.code,{children:"volatile"}),"\u5173\u952E\u5B57\u7684\u76EE\u7684\u662F\u544A\u8BC9\u865A\u62DF\u673A\uFF1A"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6BCF\u6B21\u8BBF\u95EE\u53D8\u91CF\u65F6\uFF0C\u603B\u662F\u83B7\u53D6\u4E3B\u5185\u5B58\u7684\u6700\u65B0\u503C\uFF1B"}),"\n",(0,i.jsx)(e.li,{children:"\u6BCF\u6B21\u4FEE\u6539\u53D8\u91CF\u540E\uFF0C\u7ACB\u523B\u56DE\u5199\u5230\u4E3B\u5185\u5B58\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"volatile"}),"\u5173\u952E\u5B57\u89E3\u51B3\u7684\u662F\u53EF\u89C1\u6027\u95EE\u9898\uFF1A\u5F53\u4E00\u4E2A\u7EBF\u7A0B\u4FEE\u6539\u4E86\u67D0\u4E2A\u5171\u4EAB\u53D8\u91CF\u7684\u503C\uFF0C\u5176\u4ED6\u7EBF\u7A0B\u80FD\u591F\u7ACB\u523B\u770B\u5230\u4FEE\u6539\u540E\u7684\u503C\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u679C\u6211\u4EEC\u53BB\u6389",(0,i.jsx)(e.code,{children:"volatile"}),"\u5173\u952E\u5B57\uFF0C\u8FD0\u884C\u4E0A\u8FF0\u7A0B\u5E8F\uFF0C\u53D1\u73B0\u6548\u679C\u548C\u5E26",(0,i.jsx)(e.code,{children:"volatile"}),"\u5DEE\u4E0D\u591A\uFF0C\u8FD9\u662F\u56E0\u4E3A\u5728x86\u7684\u67B6\u6784\u4E0B\uFF0CJVM\u56DE\u5199\u4E3B\u5185\u5B58\u7684\u901F\u5EA6\u975E\u5E38\u5FEB\uFF0C\u4F46\u662F\uFF0C\u6362\u6210ARM\u7684\u67B6\u6784\uFF0C\u5C31\u4F1A\u6709\u663E\u8457\u7684\u5EF6\u8FDF\u3002"]}),"\n",(0,i.jsx)(e.h2,{id:"\u5B88\u62A4\u7EBF\u7A0B",children:"\u5B88\u62A4\u7EBF\u7A0B"}),"\n",(0,i.jsxs)(e.p,{children:["Java\u7A0B\u5E8F\u5165\u53E3\u5C31\u662F\u7531JVM\u542F\u52A8",(0,i.jsx)(e.code,{children:"main"}),"\u7EBF\u7A0B\uFF0C",(0,i.jsx)(e.code,{children:"main"}),"\u7EBF\u7A0B\u53C8\u53EF\u4EE5\u542F\u52A8\u5176\u4ED6\u7EBF\u7A0B\u3002\u5F53\u6240\u6709\u7EBF\u7A0B\u90FD\u8FD0\u884C\u7ED3\u675F\u65F6\uFF0CJVM\u9000\u51FA\uFF0C\u8FDB\u7A0B\u7ED3\u675F\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679C\u6709\u4E00\u4E2A\u7EBF\u7A0B\u6CA1\u6709\u9000\u51FA\uFF0CJVM\u8FDB\u7A0B\u5C31\u4E0D\u4F1A\u9000\u51FA\u3002\u6240\u4EE5\uFF0C\u5FC5\u987B\u4FDD\u8BC1\u6240\u6709\u7EBF\u7A0B\u90FD\u80FD\u53CA\u65F6\u7ED3\u675F\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u4F46\u662F\u6709\u4E00\u79CD\u7EBF\u7A0B\u7684\u76EE\u7684\u5C31\u662F\u65E0\u9650\u5FAA\u73AF\uFF0C\u4F8B\u5982\uFF0C\u4E00\u4E2A\u5B9A\u65F6\u89E6\u53D1\u4EFB\u52A1\u7684\u7EBF\u7A0B\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"class TimerThread extends Thread {\r\n    @Override\r\n    public void run() {\r\n        while (true) {\r\n            System.out.println(LocalTime.now());\r\n            try {\r\n                Thread.sleep(1000);\r\n            } catch (InterruptedException e) {\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679C\u8FD9\u4E2A\u7EBF\u7A0B\u4E0D\u7ED3\u675F\uFF0CJVM\u8FDB\u7A0B\u5C31\u65E0\u6CD5\u7ED3\u675F\u3002\u95EE\u9898\u662F\uFF0C\u7531\u8C01\u8D1F\u8D23\u7ED3\u675F\u8FD9\u4E2A\u7EBF\u7A0B\uFF1F"}),"\n",(0,i.jsx)(e.p,{children:"\u7136\u800C\u8FD9\u7C7B\u7EBF\u7A0B\u7ECF\u5E38\u6CA1\u6709\u8D1F\u8D23\u4EBA\u6765\u8D1F\u8D23\u7ED3\u675F\u5B83\u4EEC\u3002\u4F46\u662F\uFF0C\u5F53\u5176\u4ED6\u7EBF\u7A0B\u7ED3\u675F\u65F6\uFF0CJVM\u8FDB\u7A0B\u53C8\u5FC5\u987B\u8981\u7ED3\u675F\uFF0C\u600E\u4E48\u529E\uFF1F"}),"\n",(0,i.jsx)(e.p,{children:"\u7B54\u6848\u662F\u4F7F\u7528\u5B88\u62A4\u7EBF\u7A0B\uFF08Daemon Thread\uFF09\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u5B88\u62A4\u7EBF\u7A0B\u662F\u6307\u4E3A\u5176\u4ED6\u7EBF\u7A0B\u670D\u52A1\u7684\u7EBF\u7A0B\u3002\u5728JVM\u4E2D\uFF0C\u6240\u6709\u975E\u5B88\u62A4\u7EBF\u7A0B\u90FD\u6267\u884C\u5B8C\u6BD5\u540E\uFF0C\u65E0\u8BBA\u6709\u6CA1\u6709\u5B88\u62A4\u7EBF\u7A0B\uFF0C\u865A\u62DF\u673A\u90FD\u4F1A\u81EA\u52A8\u9000\u51FA\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u56E0\u6B64\uFF0CJVM\u9000\u51FA\u65F6\uFF0C\u4E0D\u5FC5\u5173\u5FC3\u5B88\u62A4\u7EBF\u7A0B\u662F\u5426\u5DF2\u7ED3\u675F\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u4F55\u521B\u5EFA\u5B88\u62A4\u7EBF\u7A0B\u5462\uFF1F\u65B9\u6CD5\u548C\u666E\u901A\u7EBF\u7A0B\u4E00\u6837\uFF0C\u53EA\u662F\u5728\u8C03\u7528",(0,i.jsx)(e.code,{children:"start()"}),"\u65B9\u6CD5\u524D\uFF0C\u8C03\u7528",(0,i.jsx)(e.code,{children:"setDaemon(true)"}),"\u628A\u8BE5\u7EBF\u7A0B\u6807\u8BB0\u4E3A\u5B88\u62A4\u7EBF\u7A0B\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"Thread t = new MyThread();\r\nt.setDaemon(true);\r\nt.start();\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5728Java\u4E2D\uFF0C",(0,i.jsx)(e.code,{children:"main"})," \u65B9\u6CD5\u662F\u7A0B\u5E8F\u7684\u5165\u53E3\u70B9\uFF0C\u5B83\u672C\u8EAB\u4E5F\u662F\u4E00\u4E2A\u7EBF\u7A0B\u3002\u5F53 ",(0,i.jsx)(e.code,{children:"main"})," \u65B9\u6CD5\u7ED3\u675F\u65F6\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u6240\u6709\u975E\u5B88\u62A4\u7EBF\u7A0B\uFF08\u975E-daemon threads\uFF09\u5982\u679C\u8FD8\u5728\u8FD0\u884C\uFF0CJVM \u4F1A\u7EE7\u7EED\u8FD0\u884C\u76F4\u5230\u8FD9\u4E9B\u975E\u5B88\u62A4\u7EBF\u7A0B\u5168\u90E8\u7ED3\u675F\u3002\u5B88\u62A4\u7EBF\u7A0B\uFF08daemon threads\uFF09\u5219\u4F1A\u5728 ",(0,i.jsx)(e.code,{children:"main"})," \u65B9\u6CD5\u7ED3\u675F\u540E\u88AB\u7EC8\u6B62\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5173\u4E8E ",(0,i.jsx)(e.code,{children:"main"})," \u65B9\u6CD5\u548C\u7EBF\u7A0B\u7684\u751F\u547D\u5468\u671F"]}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.strong,{children:[(0,i.jsx)(e.code,{children:"main"})," \u65B9\u6CD5\u7ED3\u675F"]}),"\uFF1A","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5F53 ",(0,i.jsx)(e.code,{children:"main"})," \u65B9\u6CD5\u6267\u884C\u5B8C\u6BD5\u65F6\uFF0C\u5982\u679C\u6CA1\u6709\u5176\u4ED6\u975E\u5B88\u62A4\u7EBF\u7A0B\u5728\u8FD0\u884C\uFF0CJVM \u4F1A\u9000\u51FA\u3002"]}),"\n",(0,i.jsx)(e.li,{children:"\u5982\u679C\u6709\u5176\u4ED6\u975E\u5B88\u62A4\u7EBF\u7A0B\u5728\u8FD0\u884C\uFF0CJVM \u4F1A\u7EE7\u7EED\u8FD0\u884C\u76F4\u5230\u8FD9\u4E9B\u7EBF\u7A0B\u7ED3\u675F\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u5B88\u62A4\u7EBF\u7A0B\uFF08Daemon Threads\uFF09"}),"\uFF1A","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5B88\u62A4\u7EBF\u7A0B\u662F\u4E3A\u4E86\u670D\u52A1\u5176\u4ED6\u7EBF\u7A0B\u800C\u5B58\u5728\u7684\uFF0C\u6BD4\u5982\u5783\u573E\u56DE\u6536\u7EBF\u7A0B\u5C31\u662F\u4E00\u4E2A\u5178\u578B\u7684\u5B88\u62A4\u7EBF\u7A0B\u3002"}),"\n",(0,i.jsxs)(e.li,{children:["\u5F53 ",(0,i.jsx)(e.code,{children:"main"})," \u65B9\u6CD5\u7ED3\u675F\u65F6\uFF0C\u6240\u6709\u975E\u5B88\u62A4\u7EBF\u7A0B\u5982\u679C\u5DF2\u7ECF\u7ED3\u675F\uFF0CJVM \u4F1A\u81EA\u52A8\u7EC8\u6B62\u6240\u6709\u7684\u5B88\u62A4\u7EBF\u7A0B\u5E76\u9000\u51FA\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u975E\u5B88\u62A4\u7EBF\u7A0B\uFF08Non-Daemon Threads\uFF09"}),"\uFF1A","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u975E\u5B88\u62A4\u7EBF\u7A0B\u662F\u7528\u6237\u521B\u5EFA\u7684\u7EBF\u7A0B\uFF0C\u5B83\u4EEC\u662F\u7A0B\u5E8F\u7684\u4E3B\u8981\u5DE5\u4F5C\u7EBF\u7A0B\u3002"}),"\n",(0,i.jsxs)(e.li,{children:["\u5982\u679C\u5728 ",(0,i.jsx)(e.code,{children:"main"})," \u65B9\u6CD5\u4E2D\u521B\u5EFA\u4E86\u975E\u5B88\u62A4\u7EBF\u7A0B\uFF0C\u5E76\u4E14\u8FD9\u4E9B\u7EBF\u7A0B\u4ECD\u5728\u8FD0\u884C\uFF0CJVM \u4E0D\u4F1A\u7ACB\u5373\u9000\u51FA\uFF0C\u800C\u662F\u7B49\u5F85\u8FD9\u4E9B\u7EBF\u7A0B\u8FD0\u884C\u7ED3\u675F\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"[!warning]"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u5B88\u62A4\u7EBF\u7A0B\u4E2D\uFF0C\u7F16\u5199\u4EE3\u7801\u8981\u6CE8\u610F\uFF1A\u5B88\u62A4\u7EBF\u7A0B\u4E0D\u80FD\u6301\u6709\u4EFB\u4F55\u9700\u8981\u5173\u95ED\u7684\u8D44\u6E90\uFF0C\u4F8B\u5982\u6253\u5F00\u6587\u4EF6\u7B49\uFF0C\u56E0\u4E3A\u865A\u62DF\u673A\u9000\u51FA\u65F6\uFF0C\u5B88\u62A4\u7EBF\u7A0B\u6CA1\u6709\u4EFB\u4F55\u673A\u4F1A\u6765\u5173\u95ED\u6587\u4EF6\uFF0C\u8FD9\u4F1A\u5BFC\u81F4\u6570\u636E\u4E22\u5931\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u7EBF\u7A0B\u540C\u6B65",children:"\u7EBF\u7A0B\u540C\u6B65"}),"\n",(0,i.jsx)(e.h3,{id:"\u540C\u6B65\u6982\u5FF5",children:"\u540C\u6B65\u6982\u5FF5"}),"\n",(0,i.jsx)(e.p,{children:"\u5F53\u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u8FD0\u884C\u65F6\uFF0C\u7EBF\u7A0B\u7684\u8C03\u5EA6\u7531\u64CD\u4F5C\u7CFB\u7EDF\u51B3\u5B9A\uFF0C\u7A0B\u5E8F\u672C\u8EAB\u65E0\u6CD5\u51B3\u5B9A\u3002\u56E0\u6B64\uFF0C\u4EFB\u4F55\u4E00\u4E2A\u7EBF\u7A0B\u90FD\u6709\u53EF\u80FD\u5728\u4EFB\u4F55\u6307\u4EE4\u5904\u88AB\u64CD\u4F5C\u7CFB\u7EDF\u6682\u505C\uFF0C\u7136\u540E\u5728\u67D0\u4E2A\u65F6\u95F4\u6BB5\u540E\u7EE7\u7EED\u6267\u884C\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u8FD9\u4E2A\u65F6\u5019\uFF0C\u6709\u4E2A\u5355\u7EBF\u7A0B\u6A21\u578B\u4E0B\u4E0D\u5B58\u5728\u7684\u95EE\u9898\u5C31\u6765\u4E86\uFF1A\u5982\u679C\u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u8BFB\u5199\u5171\u4EAB\u53D8\u91CF\uFF0C\u4F1A\u51FA\u73B0\u6570\u636E\u4E0D\u4E00\u81F4\u7684\u95EE\u9898\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public static void main(String[] args) throws Exception {\r\n    var add = new AddThread();\r\n    var dec = new DecThread();\r\n    add.start();\r\n    dec.start();\r\n    add.join();\r\n    dec.join();\r\n    System.out.println(Counter.count);\r\n}\r\nclass Counter {\r\n    public static int count = 0;\r\n}\r\nclass AddThread extends Thread {\r\n    public void run() {\r\n        for (int i=0; i<10000; i++) { Counter.count += 1; }\r\n    }\r\n}\r\nclass DecThread extends Thread {\r\n    public void run() {\r\n        for (int i=0; i<10000; i++) { Counter.count -= 1; }\r\n    }\r\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u4E0A\u9762\u7684\u4EE3\u7801\u5F88\u7B80\u5355\uFF0C\u4E24\u4E2A\u7EBF\u7A0B\u540C\u65F6\u5BF9\u4E00\u4E2A",(0,i.jsx)(e.code,{children:"int"}),"\u53D8\u91CF\u8FDB\u884C\u64CD\u4F5C\uFF0C\u4E00\u4E2A\u52A010000\u6B21\uFF0C\u4E00\u4E2A\u51CF10000\u6B21\uFF0C\u6700\u540E\u7ED3\u679C\u5E94\u8BE5\u662F0\uFF0C\u4F46\u662F\uFF0C\u6BCF\u6B21\u8FD0\u884C\uFF0C\u7ED3\u679C\u5B9E\u9645\u4E0A\u90FD\u662F\u4E0D\u4E00\u6837\u7684\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u8FD9\u662F\u56E0\u4E3A\u5BF9\u53D8\u91CF\u8FDB\u884C\u8BFB\u53D6\u548C\u5199\u5165\u65F6\uFF0C\u7ED3\u679C\u8981\u6B63\u786E\uFF0C\u5FC5\u987B\u4FDD\u8BC1\u662F\u539F\u5B50\u64CD\u4F5C\u3002\u539F\u5B50\u64CD\u4F5C\u662F\u6307\u4E0D\u80FD\u88AB\u4E2D\u65AD\u7684\u4E00\u4E2A\u6216\u4E00\u7CFB\u5217\u64CD\u4F5C\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u4F8B\u5982\uFF0C\u5BF9\u4E8E\u8BED\u53E5\uFF1A",(0,i.jsx)(e.code,{children:"n = n + 1;"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u770B\u4E0A\u53BB\u662F\u4E00\u884C\u8BED\u53E5\uFF0C\u5B9E\u9645\u4E0A\u5BF9\u5E94\u4E863\u6761\u6307\u4EE4\uFF1A",(0,i.jsx)(e.code,{children:"ILOAD\u3001IADD\u3001ISTORE"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u6211\u4EEC\u5047\u8BBE",(0,i.jsx)(e.code,{children:"n"}),"\u7684\u503C\u662F",(0,i.jsx)(e.code,{children:"100"}),"\uFF0C\u5982\u679C\u4E24\u4E2A\u7EBF\u7A0B\u540C\u65F6\u6267\u884C",(0,i.jsx)(e.code,{children:"n = n + 1"}),"\uFF0C\u5F97\u5230\u7684\u7ED3\u679C\u5F88\u53EF\u80FD\u4E0D\u662F",(0,i.jsx)(e.code,{children:"102"}),"\uFF0C\u800C\u662F",(0,i.jsx)(e.code,{children:"101"}),"\uFF0C\u539F\u56E0\u5728\u4E8E\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502Thread1\u2502     \u2502Thread2\u2502\r\n\u2514\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2518\r\n    \u2502             \u2502\r\n    \u2502ILOAD (100)  \u2502\r\n    \u2502             \u2502ILOAD (100)\r\n    \u2502             \u2502IADD\r\n    \u2502             \u2502ISTORE (101)\r\n    \u2502IADD         \u2502\r\n    \u2502ISTORE (101) \u2502\r\n    \u25BC             \u25BC\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u679C\u7EBF\u7A0B1\u5728\u6267\u884C",(0,i.jsx)(e.code,{children:"ILOAD"}),"\u540E\u88AB\u64CD\u4F5C\u7CFB\u7EDF\u4E2D\u65AD\uFF0C\u6B64\u523B\u5982\u679C\u7EBF\u7A0B2\u88AB\u8C03\u5EA6\u6267\u884C\uFF0C\u5B83\u6267\u884C",(0,i.jsx)(e.code,{children:"ILOAD"}),"\u540E\u83B7\u53D6\u7684\u503C\u4ECD\u7136\u662F",(0,i.jsx)(e.code,{children:"100"}),"\uFF0C\u6700\u7EC8\u7ED3\u679C\u88AB\u4E24\u4E2A\u7EBF\u7A0B\u7684",(0,i.jsx)(e.code,{children:"ISTORE"}),"\u5199\u5165\u540E\u53D8\u6210\u4E86",(0,i.jsx)(e.code,{children:"101"}),"\uFF0C\u800C\u4E0D\u662F\u671F\u5F85\u7684",(0,i.jsx)(e.code,{children:"102"}),"\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u8FD9\u8BF4\u660E\u591A\u7EBF\u7A0B\u6A21\u578B\u4E0B\uFF0C\u8981\u4FDD\u8BC1\u903B\u8F91\u6B63\u786E\uFF0C\u5BF9\u5171\u4EAB\u53D8\u91CF\u8FDB\u884C\u8BFB\u5199\u65F6\uFF0C\u5FC5\u987B\u4FDD\u8BC1\u4E00\u7EC4\u6307\u4EE4\u4EE5\u539F\u5B50\u65B9\u5F0F\u6267\u884C\uFF1A\u5373\u67D0\u4E00\u4E2A\u7EBF\u7A0B\u6267\u884C\u65F6\uFF0C\u5176\u4ED6\u7EBF\u7A0B\u5FC5\u987B\u7B49\u5F85\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502Thread1\u2502     \u2502Thread2\u2502\r\n\u2514\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2518\r\n    \u2502             \u2502\r\n    \u2502-- lock --   \u2502\r\n    \u2502ILOAD (100)  \u2502\r\n    \u2502IADD         \u2502\r\n    \u2502ISTORE (101) \u2502\r\n    \u2502-- unlock -- \u2502\r\n    \u2502             \u2502-- lock --\r\n    \u2502             \u2502ILOAD (101)\r\n    \u2502             \u2502IADD\r\n    \u2502             \u2502ISTORE (102)\r\n    \u2502             \u2502-- unlock --\r\n    \u25BC             \u25BC\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u901A\u8FC7\u52A0\u9501\u548C\u89E3\u9501\u7684\u64CD\u4F5C\uFF0C\u5C31\u80FD\u4FDD\u8BC13\u6761\u6307\u4EE4\u603B\u662F\u5728\u4E00\u4E2A\u7EBF\u7A0B\u6267\u884C\u671F\u95F4\uFF0C\u4E0D\u4F1A\u6709\u5176\u4ED6\u7EBF\u7A0B\u4F1A\u8FDB\u5165\u6B64\u6307\u4EE4\u533A\u95F4\u3002\u5373\u4F7F\u5728\u6267\u884C\u671F\u7EBF\u7A0B\u88AB\u64CD\u4F5C\u7CFB\u7EDF\u4E2D\u65AD\u6267\u884C\uFF0C\u5176\u4ED6\u7EBF\u7A0B\u4E5F\u4F1A\u56E0\u4E3A\u65E0\u6CD5\u83B7\u5F97\u9501\u5BFC\u81F4\u65E0\u6CD5\u8FDB\u5165\u6B64\u6307\u4EE4\u533A\u95F4\u3002\u53EA\u6709\u6267\u884C\u7EBF\u7A0B\u5C06\u9501\u91CA\u653E\u540E\uFF0C\u5176\u4ED6\u7EBF\u7A0B\u624D\u6709\u673A\u4F1A\u83B7\u5F97\u9501\u5E76\u6267\u884C\u3002\u8FD9\u79CD\u52A0\u9501\u548C\u89E3\u9501\u4E4B\u95F4\u7684\u4EE3\u7801\u5757\u6211\u4EEC\u79F0\u4E4B\u4E3A\u4E34\u754C\u533A\uFF08Critical Section\uFF09\uFF0C\u4EFB\u4F55\u65F6\u5019\u4E34\u754C\u533A\u6700\u591A\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u80FD\u6267\u884C\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u53EF\u89C1\uFF0C\u4FDD\u8BC1\u4E00\u6BB5\u4EE3\u7801\u7684\u539F\u5B50\u6027\u5C31\u662F\u901A\u8FC7\u52A0\u9501\u548C\u89E3\u9501\u5B9E\u73B0\u7684\u3002Java\u7A0B\u5E8F\u4F7F\u7528",(0,i.jsx)(e.code,{children:"synchronized"}),"\u5173\u952E\u5B57\u5BF9\u4E00\u4E2A\u5BF9\u8C61\u8FDB\u884C\u52A0\u9501; ",(0,i.jsx)(e.code,{children:"synchronized"}),"\u4FDD\u8BC1\u4E86\u4EE3\u7801\u5757\u5728\u4EFB\u610F\u65F6\u523B\u6700\u591A\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u80FD\u6267\u884C\u3002\u6211\u4EEC\u628A\u4E0A\u9762\u7684\u4EE3\u7801\u7528",(0,i.jsx)(e.code,{children:"synchronized"}),"\u6539\u5199\u5982\u4E0B\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public static void main(String[] args) throws Exception {\r\n    var add = new AddThread();\r\n    var dec = new DecThread();\r\n    add.start();\r\n    dec.start();\r\n    add.join();\r\n    dec.join();\r\n    System.out.println(Counter.count);\r\n}\r\nclass Counter {\r\n    public static final Object lock = new Object();\r\n    public static int count = 0;\r\n}\r\nclass AddThread extends Thread {\r\n    public void run() {\r\n        for (int i=0; i<10000; i++) {\r\n            synchronized(Counter.lock) { //\u83B7\u53D6\u9501\uFF1A\u76F8\u540C\u4E1A\u52A1\u9700\u8981\u4F7F\u7528\u540C\u4E00\u628A\u9501\uFF1B\r\n                Counter.count += 1;\r\n            } //\u65E0\u8BBA\u6709\u65E0\u5F02\u5E38\uFF0C\u90FD\u4F1A\u5728\u6B64\u91CA\u653E\u9501\r\n        }\r\n    }\r\n}\r\nclass DecThread extends Thread {\r\n    public void run() {\r\n        for (int i=0; i<10000; i++) {\r\n            synchronized(Counter.lock) { //\u83B7\u53D6\u9501\uFF1A\u76F8\u540C\u4E1A\u52A1\u9700\u8981\u4F7F\u7528\u540C\u4E00\u628A\u9501\uFF1B\r\n                Counter.count -= 1;\r\n            } //\u65E0\u8BBA\u6709\u65E0\u5F02\u5E38\uFF0C\u90FD\u4F1A\u5728\u6B64\u91CA\u653E\u9501\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u4F7F\u7528",(0,i.jsx)(e.code,{children:"synchronized"}),"\u89E3\u51B3\u4E86\u591A\u7EBF\u7A0B\u540C\u6B65\u8BBF\u95EE\u5171\u4EAB\u53D8\u91CF\u7684\u6B63\u786E\u6027\u95EE\u9898\u3002\u4F46\u662F\uFF0C\u5B83\u7684\u7F3A\u70B9\u662F\u5E26\u6765\u4E86\u6027\u80FD\u4E0B\u964D\u3002\u56E0\u4E3A",(0,i.jsx)(e.code,{children:"synchronized"}),"\u4EE3\u7801\u5757\u65E0\u6CD5\u5E76\u53D1\u6267\u884C\u3002\u6B64\u5916\uFF0C\u52A0\u9501\u548C\u89E3\u9501\u9700\u8981\u6D88\u8017\u4E00\u5B9A\u7684\u65F6\u95F4\uFF0C\u6240\u4EE5\uFF0C",(0,i.jsx)(e.code,{children:"synchronized"}),"\u4F1A\u964D\u4F4E\u7A0B\u5E8F\u7684\u6267\u884C\u6548\u7387\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u6982\u62EC\u4E00\u4E0B\u5982\u4F55\u4F7F\u7528",(0,i.jsx)(e.code,{children:"synchronized"}),"\uFF1A"]}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u627E\u51FA\u4FEE\u6539\u5171\u4EAB\u53D8\u91CF\u7684\u7EBF\u7A0B\u4EE3\u7801\u5757\uFF1B"}),"\n",(0,i.jsx)(e.li,{children:"\u9009\u62E9\u4E00\u4E2A\u5171\u4EAB\u5B9E\u4F8B\u4F5C\u4E3A\u9501\uFF1B"}),"\n",(0,i.jsxs)(e.li,{children:["\u4F7F\u7528",(0,i.jsx)(e.code,{children:"synchronized(lockObject) { ... }"}),"\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u4E0D\u9700\u8981synchronized\u7684\u64CD\u4F5C"})}),"\n",(0,i.jsx)(e.p,{children:"JVM\u89C4\u8303\u5B9A\u4E49\u4E86\u51E0\u79CD\u539F\u5B50\u64CD\u4F5C\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u57FA\u672C\u7C7B\u578B\uFF08",(0,i.jsx)(e.code,{children:"long"}),"\u548C",(0,i.jsx)(e.code,{children:"double"}),"\u9664\u5916\uFF09\u8D4B\u503C\uFF0C\u4F8B\u5982\uFF1A",(0,i.jsx)(e.code,{children:"int n = m"}),"\uFF1B"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5F15\u7528\u7C7B\u578B\u8D4B\u503C\uFF0C\u4F8B\u5982\uFF1A",(0,i.jsx)(e.code,{children:"List<String> list = anotherList"}),"\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"long"}),"\u548C",(0,i.jsx)(e.code,{children:"double"}),"\u662F64\u4F4D\u6570\u636E\uFF0CJVM\u6CA1\u6709\u660E\u786E\u89C4\u5B9A64\u4F4D\u8D4B\u503C\u64CD\u4F5C\u662F\u4E0D\u662F\u4E00\u4E2A\u539F\u5B50\u64CD\u4F5C\uFF0C\u4E0D\u8FC7\u5728x64\u5E73\u53F0\u7684JVM\u662F\u628A",(0,i.jsx)(e.code,{children:"long"}),"\u548C",(0,i.jsx)(e.code,{children:"double"}),"\u7684\u8D4B\u503C\u4F5C\u4E3A\u539F\u5B50\u64CD\u4F5C\u5B9E\u73B0\u7684\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u4F46\u662F\uFF0C\u5982\u679C\u662F\u591A\u884C\u8D4B\u503C\u8BED\u53E5\uFF0C\u5C31\u5FC5\u987B\u4FDD\u8BC1\u662F\u540C\u6B65\u64CD\u4F5C\uFF0C\u4F8B\u5982\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"int x,y;\r\npublic void set(int x, int y) {\r\n    synchronized(this) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4E0D\u4F46\u5199\u9700\u8981\u540C\u6B65\uFF0C\u8BFB\u4E5F\u9700\u8981\u540C\u6B65\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"int x,y;\r\npublic void set(int x, int y) {\r\n    synchronized(this) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n}\r\npublic int[] get() {\r\n    int[] copy = new int[2];\r\n    copy[0] = x;\r\n    copy[1] = y;\r\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5047\u5B9A\u5F53\u524D\u5750\u6807\u662F",(0,i.jsx)(e.code,{children:"(100, 200)"}),"\uFF0C\u90A3\u4E48\u5F53\u8BBE\u7F6E\u65B0\u5750\u6807\u4E3A",(0,i.jsx)(e.code,{children:"(110, 220)"}),"\u65F6\uFF0C\u4E0A\u8FF0\u672A\u540C\u6B65\u7684\u591A\u7EBF\u7A0B\u8BFB\u5230\u7684\u503C\u53EF\u80FD\u6709\uFF1A"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"(100, 200)\uFF1Ax\uFF0Cy\u66F4\u65B0\u524D\uFF1B"}),"\n",(0,i.jsx)(e.li,{children:"(110, 200)\uFF1Ax\u66F4\u65B0\u540E\uFF0Cy\u66F4\u65B0\u524D\uFF1B"}),"\n",(0,i.jsx)(e.li,{children:"(110, 220)\uFF1Ax\uFF0Cy\u66F4\u65B0\u540E\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u679C\u8BFB\u53D6\u5230",(0,i.jsx)(e.code,{children:"(110, 200)"}),"\uFF0C\u5373\u8BFB\u5230\u4E86\u66F4\u65B0\u540E\u7684x\uFF0C\u66F4\u65B0\u524D\u7684y\uFF0C\u90A3\u4E48\u53EF\u80FD\u4F1A\u9020\u6210\u7A0B\u5E8F\u7684\u903B\u8F91\u9519\u8BEF\uFF0C\u65E0\u6CD5\u4FDD\u8BC1\u8BFB\u53D6\u7684\u591A\u4E2A\u53D8\u91CF\u72B6\u6001\u4FDD\u6301\u4E00\u81F4\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u6709\u4E9B\u65F6\u5019\uFF0C\u901A\u8FC7\u4E00\u4E9B\u5DE7\u5999\u7684\u8F6C\u6362\uFF0C\u53EF\u4EE5\u628A\u975E\u539F\u5B50\u64CD\u4F5C\u53D8\u4E3A\u539F\u5B50\u64CD\u4F5C\u3002\u4F8B\u5982\uFF0C\u4E0A\u8FF0\u4EE3\u7801\u5982\u679C\u6539\u9020\u6210\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"int[] ps;\r\npublic void set(int x, int y) {\r\n    int[] ps = new int[] { x, y };\r\n    this.ps = ps;\r\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5C31\u4E0D\u518D\u9700\u8981\u5199\u540C\u6B65\uFF0C\u56E0\u4E3A",(0,i.jsx)(e.code,{children:"this.ps = ps"}),"\u662F\u5F15\u7528\u8D4B\u503C\u7684\u539F\u5B50\u64CD\u4F5C\u3002\u800C\u8BED\u53E5\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"int[] ps = new int[] { x, y };\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8FD9\u91CC\u7684",(0,i.jsx)(e.code,{children:"ps"}),"\u662F\u65B9\u6CD5\u5185\u90E8\u5B9A\u4E49\u7684\u5C40\u90E8\u53D8\u91CF\uFF0C\u6BCF\u4E2A\u7EBF\u7A0B\u90FD\u4F1A\u6709\u5404\u81EA\u7684\u5C40\u90E8\u53D8\u91CF\uFF0C\u4E92\u4E0D\u5F71\u54CD\uFF0C\u5E76\u4E14\u4E92\u4E0D\u53EF\u89C1\uFF0C\u5E76\u4E0D\u9700\u8981\u540C\u6B65\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u4E0D\u8FC7\u8981\u6CE8\u610F\uFF0C\u8BFB\u65B9\u6CD5\u5728\u590D\u5236",(0,i.jsx)(e.code,{children:"int[]"}),"\u6570\u7EC4\u7684\u8FC7\u7A0B\u4E2D\u4ECD\u7136\u9700\u8981\u540C\u6B65\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u4E0D\u53EF\u53D8\u5BF9\u8C61\u65E0\u9700\u540C\u6B65"})}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679C\u591A\u7EBF\u7A0B\u8BFB\u5199\u7684\u662F\u4E00\u4E2A\u4E0D\u53EF\u53D8\u5BF9\u8C61\uFF0C\u90A3\u4E48\u65E0\u9700\u540C\u6B65\uFF0C\u56E0\u4E3A\u4E0D\u4F1A\u4FEE\u6539\u5BF9\u8C61\u7684\u72B6\u6001\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"class Data {\r\n    List<String> names;\r\n    void set(String[] names) {\r\n        this.names = List.of(names);\r\n    }\r\n    List<String> get() {\r\n        return this.names;\r\n    }\r\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u6CE8\u610F\u5230",(0,i.jsx)(e.code,{children:"set()"}),"\u65B9\u6CD5\u5185\u90E8\u521B\u5EFA\u4E86\u4E00\u4E2A\u4E0D\u53EF\u53D8",(0,i.jsx)(e.code,{children:"List"}),"\uFF0C\u8FD9\u4E2A",(0,i.jsx)(e.code,{children:"List"}),"\u5305\u542B\u7684\u5BF9\u8C61\u4E5F\u662F\u4E0D\u53EF\u53D8\u5BF9\u8C61",(0,i.jsx)(e.code,{children:"String"}),"\uFF0C\u56E0\u6B64\uFF0C\u6574\u4E2A",(0,i.jsx)(e.code,{children:"List<String>"}),"\u5BF9\u8C61\u90FD\u662F\u4E0D\u53EF\u53D8\u7684\uFF0C\u56E0\u6B64\u8BFB\u5199\u5747\u65E0\u9700\u540C\u6B65\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5206\u6790\u53D8\u91CF\u662F\u5426\u80FD\u88AB\u591A\u7EBF\u7A0B\u8BBF\u95EE\u65F6\uFF0C\u9996\u5148\u8981\u7406\u6E05\u6982\u5FF5\uFF0C",(0,i.jsx)(e.strong,{children:"\u591A\u7EBF\u7A0B\u540C\u65F6\u6267\u884C\u7684\u662F\u65B9\u6CD5"}),"\u3002\u5BF9\u4E8E\u4E0B\u9762\u8FD9\u4E2A\u4F8B\u5B50\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"class Status {\r\n    List<String> names;\r\n    int x,y;\r\n    void set(String[] names, int n) {\r\n        List<String> ns = List.of(names);\r\n        this.names = ns;\r\n        int step = n * 10;\r\n        this.x += step;\r\n        this.y += step;\r\n    }\r\n    StatusRecord get() {\r\n        return new StatusRecord(this.names, this.x, this.y);\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679C\u6709A\u3001B\u4E24\u4E2A\u7EBF\u7A0B\uFF0C\u540C\u65F6\u6267\u884C\u662F\u6307\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u53EF\u80FD\u540C\u65F6\u6267\u884Cset()\uFF1B"}),"\n",(0,i.jsx)(e.li,{children:"\u53EF\u80FD\u540C\u65F6\u6267\u884Cget()\uFF1B"}),"\n",(0,i.jsx)(e.li,{children:"\u53EF\u80FDA\u6267\u884Cset()\uFF0C\u540C\u65F6B\u6267\u884Cget()\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u7C7B\u7684\u6210\u5458\u53D8\u91CF",(0,i.jsx)(e.code,{children:"names"}),"\u3001",(0,i.jsx)(e.code,{children:"x"}),"\u3001",(0,i.jsx)(e.code,{children:"y"}),"\u663E\u7136\u80FD\u88AB\u591A\u7EBF\u7A0B\u540C\u65F6\u8BFB\u5199\uFF0C\u4F46\u5C40\u90E8\u53D8\u91CF\uFF08\u5305\u62EC\u65B9\u6CD5\u53C2\u6570\uFF09\u5982\u679C\u6CA1\u6709\u201C\u9003\u9038\u201D\uFF0C\u90A3\u4E48\u53EA\u6709\u5F53\u524D\u7EBF\u7A0B\u53EF\u89C1\u3002\u5C40\u90E8\u53D8\u91CF",(0,i.jsx)(e.code,{children:"step"}),"\u4EC5\u5728",(0,i.jsx)(e.code,{children:"set()"}),"\u65B9\u6CD5\u5185\u90E8\u4F7F\u7528\uFF0C\u56E0\u6B64\u6BCF\u4E2A\u7EBF\u7A0B\u540C\u65F6\u6267\u884Cset\u65F6\u90FD\u6709\u4E00\u4EFD\u72EC\u7ACB\u7684step\u5B58\u50A8\u5728\u7EBF\u7A0B\u7684\u6808\u4E0A\uFF0C\u4E92\u4E0D\u5F71\u54CD\uFF0C\u4F46\u662F\u5C40\u90E8\u53D8\u91CF",(0,i.jsx)(e.code,{children:"ns"}),"\u867D\u7136\u6BCF\u4E2A\u7EBF\u7A0B\u4E5F\u5404\u6709\u4E00\u4EFD\uFF0C\u4F46\u540E\u7EED\u8D4B\u503C\u540E\u5BF9\u5176\u4ED6\u7EBF\u7A0B\u5C31\u53D8\u6210\u53EF\u89C1\u4E86\u3002\u5BF9",(0,i.jsx)(e.code,{children:"set()"}),"\u65B9\u6CD5\u540C\u6B65\u65F6\uFF0C\u5982\u679C\u8981\u6700\u5C0F\u5316",(0,i.jsx)(e.code,{children:"synchronized"}),"\u4EE3\u7801\u5757\uFF0C\u53EF\u4EE5\u6539\u5199\u5982\u4E0B\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"void set(String[] names, int n) {\r\n    // \u5C40\u90E8\u53D8\u91CF\u5176\u4ED6\u7EBF\u7A0B\u4E0D\u53EF\u89C1:\r\n    List<String> ns = List.of(names);\r\n    int step = n * 10;\r\n    synchronized(this) {\r\n        this.names = ns;\r\n        this.x += step;\r\n        this.y += step;\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u56E0\u6B64\uFF0C\u6DF1\u5165\u7406\u89E3\u591A\u7EBF\u7A0B\u8FD8\u9700\u7406\u89E3\u53D8\u91CF\u5728\u6808\u4E0A\u7684\u5B58\u50A8\u65B9\u5F0F\uFF0C\u57FA\u672C\u7C7B\u578B\u548C\u5F15\u7528\u7C7B\u578B\u7684\u5B58\u50A8\u65B9\u5F0F\u4E5F\u4E0D\u540C\u3002"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"[!tip]"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"volatile\u53EA\u4FDD\u8BC1\u6BCF\u4E2A\u7EBF\u7A0B\u8BFB\u5230\u7684\u6570\u636E\u662F\u6700\u65B0\u503C\uFF0C\u4F46\u4E0D\u80FD\u4FDD\u8BC1\u591A\u4E2A\u7EBF\u7A0B\u5BF9\u540C\u4E00\u4E2A\u53D8\u91CF\u7684\u64CD\u4F5C\u7684\u539F\u5B50\u7684\u3002"}),"\n",(0,i.jsx)(e.li,{children:"synchronized\u5E76\u4E0D\u6D89\u53CA\u6570\u636E\u7684\u521D\u59CB\u503C\uFF0C\u5B83\u53EA\u4FDD\u8BC1\u540C\u6B65\u4EE3\u7801\u5757\u5185\u7684\u4EE3\u7801\u540C\u4E00\u65F6\u523B\u53EA\u80FD\u6709\u4E00\u4E2A\u7EBF\u7A0B\u8BBF\u95EE\u3002"}),"\n",(0,i.jsx)(e.li,{children:"synchronized\u80FD\u4FDD\u8BC1\u53EF\u89C1\u6027\u3001\u6709\u5E8F\u6027\u548C\u539F\u5B50\u6027\uFF0C\u6BCF\u6B21\u8FDB\u5165synchronized\u4FDD\u62A4\u7684\u4E34\u754C\u533A\u65F6\u90FD\u4F1A\u5237\u65B0\u5DE5\u4F5C\u5185\u5B58\u7684\u53D8\u91CF\uFF0C\u9000\u51FAsynchronized\u4F1A\u5C06\u53D8\u5316\u540C\u6B65\u5230\u4E3B\u5185\u5B58\u4E2D\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u591A\u7EBF\u7A0B\u540C\u65F6\u6267\u884C\u7684\u662F\u65B9\u6CD5\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u540C\u6B65\u65B9\u6CD5",children:"\u540C\u6B65\u65B9\u6CD5"}),"\n",(0,i.jsxs)(e.p,{children:["\u6211\u4EEC\u77E5\u9053Java\u7A0B\u5E8F\u4F9D\u9760",(0,i.jsx)(e.code,{children:"synchronized"}),"\u5BF9\u7EBF\u7A0B\u8FDB\u884C\u540C\u6B65\uFF0C\u4F7F\u7528",(0,i.jsx)(e.code,{children:"synchronized"}),"\u7684\u65F6\u5019\uFF0C\u9501\u4F4F\u7684\u662F\u54EA\u4E2A\u5BF9\u8C61\u975E\u5E38\u91CD\u8981\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u8BA9\u7EBF\u7A0B\u81EA\u5DF1\u9009\u62E9\u9501\u5BF9\u8C61\u5F80\u5F80\u4F1A\u4F7F\u5F97\u4EE3\u7801\u903B\u8F91\u6DF7\u4E71\uFF0C\u4E5F\u4E0D\u5229\u4E8E\u5C01\u88C5\u3002\u66F4\u597D\u7684\u65B9\u6CD5\u662F\u628A",(0,i.jsx)(e.code,{children:"synchronized"}),"\u903B\u8F91\u5C01\u88C5\u8D77\u6765\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Counter {\r\n    private int count = 0;\r\n    public void add(int n) {\r\n        synchronized(this) {\r\n            count += n;\r\n        }\r\n    }\r\n    public void dec(int n) {\r\n        synchronized(this) {\r\n            count -= n;\r\n        }\r\n    }\r\n    public int get() {\r\n        return count;\r\n    }\r\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8FD9\u6837\u4E00\u6765\uFF0C\u7EBF\u7A0B\u8C03\u7528",(0,i.jsx)(e.code,{children:"add()"}),"\u3001",(0,i.jsx)(e.code,{children:"dec()"}),"\u65B9\u6CD5\u65F6\uFF0C\u5B83\u4E0D\u5FC5\u5173\u5FC3\u540C\u6B65\u903B\u8F91\uFF0C\u56E0\u4E3A",(0,i.jsx)(e.code,{children:"synchronized"}),"\u4EE3\u7801\u5757\u5728",(0,i.jsx)(e.code,{children:"add()"}),"\u3001",(0,i.jsx)(e.code,{children:"dec()"}),"\u65B9\u6CD5\u5185\u90E8\u3002\u5E76\u4E14\uFF0C\u6211\u4EEC\u6CE8\u610F\u5230\uFF0C",(0,i.jsx)(e.code,{children:"synchronized"}),"\u9501\u4F4F\u7684\u5BF9\u8C61\u662F",(0,i.jsx)(e.code,{children:"this"}),"\uFF0C\u5373\u5F53\u524D\u5B9E\u4F8B\uFF0C\u8FD9\u53C8\u4F7F\u5F97\u521B\u5EFA\u591A\u4E2A",(0,i.jsx)(e.code,{children:"Counter"}),"\u5B9E\u4F8B\u7684\u65F6\u5019\uFF0C\u5B83\u4EEC\u4E4B\u95F4\u4E92\u4E0D\u5F71\u54CD\uFF0C\u53EF\u4EE5\u5E76\u53D1\u6267\u884C\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"var c1 = Counter();\r\nvar c2 = Counter();\r\n\r\n// \u5BF9c1\u8FDB\u884C\u64CD\u4F5C\u7684\u7EBF\u7A0B:\r\nnew Thread(() -> {\r\n    c1.add();\r\n}).start();\r\nnew Thread(() -> {\r\n    c1.dec();\r\n}).start();\r\n\r\n// \u5BF9c2\u8FDB\u884C\u64CD\u4F5C\u7684\u7EBF\u7A0B:\r\nnew Thread(() -> {\r\n    c2.add();\r\n}).start();\r\nnew Thread(() -> {\r\n    c2.dec();\r\n}).start();\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5982\u679C\u4E00\u4E2A\u7C7B\u88AB\u8BBE\u8BA1\u4E3A\u5141\u8BB8\u591A\u7EBF\u7A0B\u6B63\u786E\u8BBF\u95EE\uFF0C\u6211\u4EEC\u5C31\u8BF4\u8FD9\u4E2A\u7C7B\u5C31\u662F\u201C\u7EBF\u7A0B\u5B89\u5168\u201D\u7684\uFF08thread-safe\uFF09\uFF0C\u4E0A\u9762\u7684",(0,i.jsx)(e.code,{children:"Counter"}),"\u7C7B\u5C31\u662F\u7EBF\u7A0B\u5B89\u5168\u7684\u3002Java\u6807\u51C6\u5E93\u7684",(0,i.jsx)(e.code,{children:"java.lang.StringBuffer"}),"\u4E5F\u662F\u7EBF\u7A0B\u5B89\u5168\u7684\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u8FD8\u6709\u4E00\u4E9B\u4E0D\u53D8\u7C7B\uFF0C\u4F8B\u5982",(0,i.jsx)(e.code,{children:"String"}),"\uFF0C",(0,i.jsx)(e.code,{children:"Integer"}),"\uFF0C",(0,i.jsx)(e.code,{children:"LocalDate"}),"\uFF0C\u5B83\u4EEC\u7684\u6240\u6709\u6210\u5458\u53D8\u91CF\u90FD\u662F",(0,i.jsx)(e.code,{children:"final"}),"\uFF0C\u591A\u7EBF\u7A0B\u540C\u65F6\u8BBF\u95EE\u65F6\u53EA\u80FD\u8BFB\u4E0D\u80FD\u5199\uFF0C\u8FD9\u4E9B\u4E0D\u53D8\u7C7B\u4E5F\u662F\u7EBF\u7A0B\u5B89\u5168\u7684\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u6700\u540E\uFF0C\u7C7B\u4F3C",(0,i.jsx)(e.code,{children:"Math"}),"\u8FD9\u4E9B\u53EA\u63D0\u4F9B\u9759\u6001\u65B9\u6CD5\uFF0C\u6CA1\u6709\u6210\u5458\u53D8\u91CF\u7684\u7C7B\uFF0C\u4E5F\u662F\u7EBF\u7A0B\u5B89\u5168\u7684\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u9664\u4E86\u4E0A\u8FF0\u51E0\u79CD\u5C11\u6570\u60C5\u51B5\uFF0C\u5927\u90E8\u5206\u7C7B\uFF0C\u4F8B\u5982",(0,i.jsx)(e.code,{children:"ArrayList"}),"\uFF0C\u90FD\u662F\u975E\u7EBF\u7A0B\u5B89\u5168\u7684\u7C7B\uFF0C\u6211\u4EEC\u4E0D\u80FD\u5728\u591A\u7EBF\u7A0B\u4E2D\u4FEE\u6539\u5B83\u4EEC\u3002\u4F46\u662F\uFF0C\u5982\u679C\u6240\u6709\u7EBF\u7A0B\u90FD\u53EA\u8BFB\u53D6\uFF0C\u4E0D\u5199\u5165\uFF0C\u90A3\u4E48",(0,i.jsx)(e.code,{children:"ArrayList"}),"\u662F\u53EF\u4EE5\u5B89\u5168\u5730\u5728\u7EBF\u7A0B\u95F4\u5171\u4EAB\u7684\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5F53\u6211\u4EEC\u9501\u4F4F\u7684\u662F",(0,i.jsx)(e.code,{children:"this"}),"\u5B9E\u4F8B\u65F6\uFF0C\u5B9E\u9645\u4E0A\u53EF\u4EE5\u7528",(0,i.jsx)(e.code,{children:"synchronized"}),"\u4FEE\u9970\u8FD9\u4E2A\u65B9\u6CD5\u3002\u4E0B\u9762\u4E24\u79CD\u5199\u6CD5\u662F\u7B49\u4EF7\u7684\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"//\u5199\u6CD5\u4E00\uFF1A\r\npublic void add(int n) {\r\n    synchronized(this) { // \u9501\u4F4Fthis\r\n        count += n;\r\n    } // \u89E3\u9501\r\n}\r\n//\u5199\u6CD5\u4E8C\uFF1A\r\npublic synchronized void add(int n) { // \u9501\u4F4Fthis\r\n	count += n;\r\n} // \u89E3\u9501\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u56E0\u6B64\uFF0C\u7528",(0,i.jsx)(e.code,{children:"synchronized"}),"\u4FEE\u9970\u7684\u65B9\u6CD5\u5C31\u662F\u540C\u6B65\u65B9\u6CD5\uFF0C\u5B83\u8868\u793A\u6574\u4E2A\u65B9\u6CD5\u90FD\u5FC5\u987B\u7528",(0,i.jsx)(e.code,{children:"this"}),"\u5B9E\u4F8B\u52A0\u9501\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u6211\u4EEC\u518D\u601D\u8003\u4E00\u4E0B\uFF0C\u5982\u679C\u5BF9\u4E00\u4E2A\u9759\u6001\u65B9\u6CD5\u6DFB\u52A0",(0,i.jsx)(e.code,{children:"synchronized"}),"\u4FEE\u9970\u7B26\uFF0C\u5B83\u9501\u4F4F\u7684\u662F\u54EA\u4E2A\u5BF9\u8C61\uFF1F"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public synchronized static void test(int n) {\r\n    ...\r\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5BF9\u4E8E",(0,i.jsx)(e.code,{children:"static"}),"\u65B9\u6CD5\uFF0C\u662F\u6CA1\u6709",(0,i.jsx)(e.code,{children:"this"}),"\u5B9E\u4F8B\u7684\uFF0C\u56E0\u4E3A",(0,i.jsx)(e.code,{children:"static"}),"\u65B9\u6CD5\u662F\u9488\u5BF9\u7C7B\u800C\u4E0D\u662F\u5B9E\u4F8B\u3002\u4F46\u662F\u6211\u4EEC\u6CE8\u610F\u5230\u4EFB\u4F55\u4E00\u4E2A\u7C7B\u90FD\u6709\u4E00\u4E2A\u7531JVM\u81EA\u52A8\u521B\u5EFA\u7684",(0,i.jsx)(e.code,{children:"Class"}),"\u5B9E\u4F8B\uFF0C\u56E0\u6B64\uFF0C\u5BF9",(0,i.jsx)(e.code,{children:"static"}),"\u65B9\u6CD5\u6DFB\u52A0",(0,i.jsx)(e.code,{children:"synchronized"}),"\uFF0C\u9501\u4F4F\u7684\u662F\u8BE5\u7C7B\u7684",(0,i.jsx)(e.code,{children:"Class"}),"\u5B9E\u4F8B\u3002\u4E0A\u8FF0",(0,i.jsx)(e.code,{children:"synchronized static"}),"\u65B9\u6CD5\u5B9E\u9645\u4E0A\u76F8\u5F53\u4E8E\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Counter {\r\n    public static void test(int n) {\r\n        synchronized(Counter.class) {\r\n            ...\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u6B7B\u9501",children:"\u6B7B\u9501"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u53EF\u91CD\u5165\u9501"})}),"\n",(0,i.jsx)(e.p,{children:"Java\u7684\u7EBF\u7A0B\u9501\u662F\u53EF\u91CD\u5165\u7684\u9501\u3002\u4EC0\u4E48\u662F\u53EF\u91CD\u5165\u7684\u9501\uFF1F\u6211\u4EEC\u8FD8\u662F\u6765\u770B\u4F8B\u5B50\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class Counter {\r\n    private int count = 0;\r\n    public synchronized void add(int n) {\r\n        if (n < 0) {\r\n            dec(-n);\r\n        } else {\r\n            count += n;\r\n        }\r\n    }\r\n    public synchronized void dec(int n) {\r\n        count += n;\r\n    }\r\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u89C2\u5BDF",(0,i.jsx)(e.code,{children:"synchronized"}),"\u4FEE\u9970\u7684",(0,i.jsx)(e.code,{children:"add()"}),"\u65B9\u6CD5\uFF0C\u4E00\u65E6\u7EBF\u7A0B\u6267\u884C\u5230",(0,i.jsx)(e.code,{children:"add()"}),"\u65B9\u6CD5\u5185\u90E8\uFF0C\u8BF4\u660E\u5B83\u5DF2\u7ECF\u83B7\u53D6\u4E86\u5F53\u524D\u5B9E\u4F8B\u7684",(0,i.jsx)(e.code,{children:"this"}),"\u9501\u3002\u5982\u679C\u4F20\u5165\u7684",(0,i.jsx)(e.code,{children:"n < 0"}),"\uFF0C\u5C06\u5728",(0,i.jsx)(e.code,{children:"add()"}),"\u65B9\u6CD5\u5185\u90E8\u8C03\u7528",(0,i.jsx)(e.code,{children:"dec()"}),"\u65B9\u6CD5\u3002\u7531\u4E8E",(0,i.jsx)(e.code,{children:"dec()"}),"\u65B9\u6CD5\u4E5F\u9700\u8981\u83B7\u53D6",(0,i.jsx)(e.code,{children:"this"}),"\u9501\uFF0C\u73B0\u5728\u95EE\u9898\u6765\u4E86\uFF1A"]}),"\n",(0,i.jsx)(e.p,{children:"\u5BF9\u540C\u4E00\u4E2A\u7EBF\u7A0B\uFF0C\u80FD\u5426\u5728\u83B7\u53D6\u5230\u9501\u4EE5\u540E\u7EE7\u7EED\u83B7\u53D6\u540C\u4E00\u4E2A\u9501\uFF1F"}),"\n",(0,i.jsxs)(e.p,{children:["\u7B54\u6848\u662F\u80AF\u5B9A\u7684\u3002JVM\u5141\u8BB8\u540C\u4E00\u4E2A\u7EBF\u7A0B\u91CD\u590D\u83B7\u53D6\u540C\u4E00\u4E2A\u9501\uFF0C\u8FD9\u79CD\u80FD\u88AB\u540C\u4E00\u4E2A\u7EBF\u7A0B\u53CD\u590D\u83B7\u53D6\u7684\u9501\uFF0C\u5C31\u53EB\u505A",(0,i.jsx)(e.strong,{children:"\u53EF\u91CD\u5165\u9501"}),"\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u7531\u4E8EJava\u7684\u7EBF\u7A0B\u9501\u662F\u53EF\u91CD\u5165\u9501\uFF0C\u6240\u4EE5\uFF0C\u83B7\u53D6\u9501\u7684\u65F6\u5019\uFF0C\u4E0D\u4F46\u8981\u5224\u65AD\u662F\u5426\u662F\u7B2C\u4E00\u6B21\u83B7\u53D6\uFF0C\u8FD8\u8981\u8BB0\u5F55\u8FD9\u662F\u7B2C\u51E0\u6B21\u83B7\u53D6\u3002\u6BCF\u83B7\u53D6\u4E00\u6B21\u9501\uFF0C\u8BB0\u5F55+1\uFF0C\u6BCF\u9000\u51FA",(0,i.jsx)(e.code,{children:"synchronized"}),"\u5757\uFF0C\u8BB0\u5F55-1\uFF0C\u51CF\u52300\u7684\u65F6\u5019\uFF0C\u624D\u4F1A\u771F\u6B63\u91CA\u653E\u9501\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6B7B\u9501"})}),"\n",(0,i.jsx)(e.p,{children:"\u4E00\u4E2A\u7EBF\u7A0B\u53EF\u4EE5\u83B7\u53D6\u4E00\u4E2A\u9501\u540E\uFF0C\u518D\u7EE7\u7EED\u83B7\u53D6\u53E6\u4E00\u4E2A\u9501\u3002\u4F8B\u5982\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public void add(int m) {\r\n    synchronized(lockA) { // \u83B7\u5F97lockA\u7684\u9501\r\n        this.value += m;\r\n        synchronized(lockB) { // \u83B7\u5F97lockB\u7684\u9501\r\n            this.another += m;\r\n        } // \u91CA\u653ElockB\u7684\u9501\r\n    } // \u91CA\u653ElockA\u7684\u9501\r\n}\r\n\r\npublic void dec(int m) {\r\n    synchronized(lockB) { // \u83B7\u5F97lockB\u7684\u9501\r\n        this.another -= m;\r\n        synchronized(lockA) { // \u83B7\u5F97lockA\u7684\u9501\r\n            this.value -= m;\r\n        } // \u91CA\u653ElockA\u7684\u9501\r\n    } // \u91CA\u653ElockB\u7684\u9501\r\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5728\u83B7\u53D6\u591A\u4E2A\u9501\u7684\u65F6\u5019\uFF0C\u4E0D\u540C\u7EBF\u7A0B\u83B7\u53D6\u591A\u4E2A\u4E0D\u540C\u5BF9\u8C61\u7684\u9501\u53EF\u80FD\u5BFC\u81F4\u6B7B\u9501\u3002\u5BF9\u4E8E\u4E0A\u8FF0\u4EE3\u7801\uFF0C\u7EBF\u7A0B1\u548C\u7EBF\u7A0B2\u5982\u679C\u5206\u522B\u6267\u884C",(0,i.jsx)(e.code,{children:"add()"}),"\u548C",(0,i.jsx)(e.code,{children:"dec()"}),"\u65B9\u6CD5\u65F6\uFF1A"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u7EBF\u7A0B1\uFF1A\u8FDB\u5165",(0,i.jsx)(e.code,{children:"add()"}),"\uFF0C\u83B7\u5F97",(0,i.jsx)(e.code,{children:"lockA"}),"\uFF1B"]}),"\n",(0,i.jsxs)(e.li,{children:["\u7EBF\u7A0B2\uFF1A\u8FDB\u5165",(0,i.jsx)(e.code,{children:"dec()"}),"\uFF0C\u83B7\u5F97",(0,i.jsx)(e.code,{children:"lockB"}),"\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u968F\u540E\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u7EBF\u7A0B1\uFF1A\u51C6\u5907\u83B7\u5F97",(0,i.jsx)(e.code,{children:"lockB"}),"\uFF0C\u5931\u8D25\uFF0C\u7B49\u5F85\u4E2D\uFF1B"]}),"\n",(0,i.jsxs)(e.li,{children:["\u7EBF\u7A0B2\uFF1A\u51C6\u5907\u83B7\u5F97",(0,i.jsx)(e.code,{children:"lockA"}),"\uFF0C\u5931\u8D25\uFF0C\u7B49\u5F85\u4E2D\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6B64\u65F6\uFF0C\u4E24\u4E2A\u7EBF\u7A0B\u5404\u81EA\u6301\u6709\u4E0D\u540C\u7684\u9501\uFF0C\u7136\u540E\u5404\u81EA\u8BD5\u56FE\u83B7\u53D6\u5BF9\u65B9\u624B\u91CC\u7684\u9501\uFF0C\u9020\u6210\u4E86\u53CC\u65B9\u65E0\u9650\u7B49\u5F85\u4E0B\u53BB\uFF0C\u8FD9\u5C31\u662F\u6B7B\u9501\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u6B7B\u9501\u53D1\u751F\u540E\uFF0C\u6CA1\u6709\u4EFB\u4F55\u673A\u5236\u80FD\u89E3\u9664\u6B7B\u9501\uFF0C\u53EA\u80FD\u5F3A\u5236\u7ED3\u675FJVM\u8FDB\u7A0B\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u56E0\u6B64\uFF0C\u5728\u7F16\u5199\u591A\u7EBF\u7A0B\u5E94\u7528\u65F6\uFF0C\u8981\u7279\u522B\u6CE8\u610F\u9632\u6B62\u6B7B\u9501\u3002\u56E0\u4E3A\u6B7B\u9501\u4E00\u65E6\u5F62\u6210\uFF0C\u5C31\u53EA\u80FD\u5F3A\u5236\u7ED3\u675F\u8FDB\u7A0B\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u90A3\u4E48\u6211\u4EEC\u5E94\u8BE5\u5982\u4F55\u907F\u514D\u6B7B\u9501\u5462\uFF1F\u7B54\u6848\u662F\uFF1A\u7EBF\u7A0B\u83B7\u53D6\u9501\u7684\u987A\u5E8F\u8981\u4E00\u81F4\u3002\u5373\u4E25\u683C\u6309\u7167\u5148\u83B7\u53D6",(0,i.jsx)(e.code,{children:"lockA"}),"\uFF0C\u518D\u83B7\u53D6",(0,i.jsx)(e.code,{children:"lockB"}),"\u7684\u987A\u5E8F\uFF0C\u6539\u5199",(0,i.jsx)(e.code,{children:"dec()"}),"\u65B9\u6CD5\u5982\u4E0B\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public void dec(int m) {\r\n    synchronized(lockA) { // \u83B7\u5F97lockA\u7684\u9501\r\n        this.value -= m;\r\n        synchronized(lockB) { // \u83B7\u5F97lockB\u7684\u9501\r\n            this.another -= m;\r\n        } // \u91CA\u653ElockB\u7684\u9501\r\n    } // \u91CA\u653ElockA\u7684\u9501\r\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u4F7F\u7528wait\u548Cnotify",children:"\u4F7F\u7528wait\u548Cnotify"}),"\n",(0,i.jsxs)(e.p,{children:["\u5728Java\u7A0B\u5E8F\u4E2D\uFF0C",(0,i.jsx)(e.code,{children:"synchronized"}),"\u89E3\u51B3\u4E86\u591A\u7EBF\u7A0B\u7ADE\u4E89\u7684\u95EE\u9898\u3002\u4F8B\u5982\uFF0C\u5BF9\u4E8E\u4E00\u4E2A\u4EFB\u52A1\u7BA1\u7406\u5668\uFF0C\u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u5F80\u961F\u5217\u4E2D\u6DFB\u52A0\u4EFB\u52A1\uFF0C\u53EF\u4EE5\u7528",(0,i.jsx)(e.code,{children:"synchronized"}),"\u52A0\u9501\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"class TaskQueue {\r\n    Queue<String> queue = new LinkedList<>();\r\n\r\n    public synchronized void addTask(String s) {\r\n        this.queue.add(s);\r\n    }\r\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u4F46\u662F",(0,i.jsx)(e.code,{children:"synchronized"}),"\u5E76\u6CA1\u6709\u89E3\u51B3\u591A\u7EBF\u7A0B\u534F\u8C03\u7684\u95EE\u9898\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u4ECD\u7136\u4EE5\u4E0A\u9762\u7684",(0,i.jsx)(e.code,{children:"TaskQueue"}),"\u4E3A\u4F8B\uFF0C\u6211\u4EEC\u518D\u7F16\u5199\u4E00\u4E2A",(0,i.jsx)(e.code,{children:"getTask()"}),"\u65B9\u6CD5\u53D6\u51FA\u961F\u5217\u7684\u7B2C\u4E00\u4E2A\u4EFB\u52A1\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"class TaskQueue {\r\n    Queue<String> queue = new LinkedList<>();\r\n    public synchronized void addTask(String s) {\r\n        this.queue.add(s);\r\n    }\r\n    public synchronized String getTask() {\r\n        while (queue.isEmpty()) {\r\n        }\r\n        return queue.remove();\r\n    }\r\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u4E0A\u8FF0\u4EE3\u7801\u770B\u4E0A\u53BB\u6CA1\u6709\u95EE\u9898\uFF1A",(0,i.jsx)(e.code,{children:"getTask()"}),"\u5185\u90E8\u5148\u5224\u65AD\u961F\u5217\u662F\u5426\u4E3A\u7A7A\uFF0C\u5982\u679C\u4E3A\u7A7A\uFF0C\u5C31\u5FAA\u73AF\u7B49\u5F85\uFF0C\u76F4\u5230\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u5F80\u961F\u5217\u4E2D\u653E\u5165\u4E86\u4E00\u4E2A\u4EFB\u52A1\uFF0C",(0,i.jsx)(e.code,{children:"while()"}),"\u5FAA\u73AF\u9000\u51FA\uFF0C\u5C31\u53EF\u4EE5\u8FD4\u56DE\u961F\u5217\u7684\u5143\u7D20\u4E86\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u4F46\u5B9E\u9645\u4E0A",(0,i.jsx)(e.code,{children:"while()"}),"\u5FAA\u73AF\u6C38\u8FDC\u4E0D\u4F1A\u9000\u51FA\u3002\u56E0\u4E3A\u7EBF\u7A0B\u5728\u6267\u884C",(0,i.jsx)(e.code,{children:"while()"}),"\u5FAA\u73AF\u65F6\uFF0C\u5DF2\u7ECF\u5728",(0,i.jsx)(e.code,{children:"getTask()"}),"\u5165\u53E3\u83B7\u53D6\u4E86",(0,i.jsx)(e.code,{children:"this"}),"\u9501\uFF0C\u5176\u4ED6\u7EBF\u7A0B\u6839\u672C\u65E0\u6CD5\u8C03\u7528",(0,i.jsx)(e.code,{children:"addTask()"}),"\uFF0C\u56E0\u4E3A",(0,i.jsx)(e.code,{children:"addTask()"}),"\u6267\u884C\u6761\u4EF6\u4E5F\u662F\u83B7\u53D6",(0,i.jsx)(e.code,{children:"this"}),"\u9501\u3002\u56E0\u6B64\uFF0C\u6267\u884C\u4E0A\u8FF0\u4EE3\u7801\uFF0C\u7EBF\u7A0B\u4F1A\u5728",(0,i.jsx)(e.code,{children:"getTask()"}),"\u4E2D\u56E0\u4E3A\u6B7B\u5FAA\u73AF\u800C100%\u5360\u7528CPU\u8D44\u6E90\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679C\u6DF1\u5165\u601D\u8003\u4E00\u4E0B\uFF0C\u6211\u4EEC\u60F3\u8981\u7684\u6267\u884C\u6548\u679C\u662F\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u7EBF\u7A0B1\u53EF\u4EE5\u8C03\u7528",(0,i.jsx)(e.code,{children:"addTask()"}),"\u4E0D\u65AD\u5F80\u961F\u5217\u4E2D\u6DFB\u52A0\u4EFB\u52A1\uFF1B"]}),"\n",(0,i.jsxs)(e.li,{children:["\u7EBF\u7A0B2\u53EF\u4EE5\u8C03\u7528",(0,i.jsx)(e.code,{children:"getTask()"}),"\u4ECE\u961F\u5217\u4E2D\u83B7\u53D6\u4EFB\u52A1\u3002\u5982\u679C\u961F\u5217\u4E3A\u7A7A\uFF0C\u5219",(0,i.jsx)(e.code,{children:"getTask()"}),"\u5E94\u8BE5\u7B49\u5F85\uFF0C\u76F4\u5230\u961F\u5217\u4E2D\u81F3\u5C11\u6709\u4E00\u4E2A\u4EFB\u52A1\u65F6\u518D\u8FD4\u56DE\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u56E0\u6B64\uFF0C\u591A\u7EBF\u7A0B\u534F\u8C03\u8FD0\u884C\u7684\u539F\u5219\u5C31\u662F\uFF1A\u5F53\u6761\u4EF6\u4E0D\u6EE1\u8DB3\u65F6\uFF0C\u7EBF\u7A0B\u8FDB\u5165\u7B49\u5F85\u72B6\u6001\uFF1B\u5F53\u6761\u4EF6\u6EE1\u8DB3\u65F6\uFF0C\u7EBF\u7A0B\u88AB\u5524\u9192\uFF0C\u7EE7\u7EED\u6267\u884C\u4EFB\u52A1\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u5BF9\u4E8E\u4E0A\u8FF0",(0,i.jsx)(e.code,{children:"TaskQueue"}),"\uFF0C\u6211\u4EEC\u5148\u6539\u9020",(0,i.jsx)(e.code,{children:"getTask()"}),"\u65B9\u6CD5\uFF0C\u5728\u6761\u4EF6\u4E0D\u6EE1\u8DB3\u65F6\uFF0C\u7EBF\u7A0B\u8FDB\u5165\u7B49\u5F85\u72B6\u6001\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public synchronized String getTask() {\r\n    while (queue.isEmpty()) {\r\n        this.wait();\r\n    }\r\n    return queue.remove();\r\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5F53\u4E00\u4E2A\u7EBF\u7A0B\u6267\u884C\u5230",(0,i.jsx)(e.code,{children:"getTask()"}),"\u65B9\u6CD5\u5185\u90E8\u7684",(0,i.jsx)(e.code,{children:"while"}),"\u5FAA\u73AF\u65F6\uFF0C\u5B83\u5FC5\u5B9A\u5DF2\u7ECF\u83B7\u53D6\u5230\u4E86",(0,i.jsx)(e.code,{children:"this"}),"\u9501\uFF0C\u6B64\u65F6\uFF0C\u7EBF\u7A0B\u6267\u884C",(0,i.jsx)(e.code,{children:"while"}),"\u6761\u4EF6\u5224\u65AD\uFF0C\u5982\u679C\u6761\u4EF6\u6210\u7ACB\uFF08\u961F\u5217\u4E3A\u7A7A\uFF09\uFF0C\u7EBF\u7A0B\u5C06\u6267\u884C",(0,i.jsx)(e.code,{children:"this.wait()"}),"\uFF0C\u8FDB\u5165\u7B49\u5F85\u72B6\u6001\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u8FD9\u91CC\u7684\u5173\u952E\u662F\uFF1A",(0,i.jsx)(e.code,{children:"wait()"}),"\u65B9\u6CD5\u5FC5\u987B\u5728\u5F53\u524D\u83B7\u53D6\u7684\u9501\u5BF9\u8C61\u4E0A\u8C03\u7528\uFF0C\u8FD9\u91CC\u83B7\u53D6\u7684\u662F",(0,i.jsx)(e.code,{children:"this"}),"\u9501\uFF0C\u56E0\u6B64\u8C03\u7528",(0,i.jsx)(e.code,{children:"this.wait()"}),"\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u8C03\u7528",(0,i.jsx)(e.code,{children:"wait()"}),"\u65B9\u6CD5\u540E\uFF0C\u7EBF\u7A0B\u8FDB\u5165\u7B49\u5F85\u72B6\u6001\uFF0C",(0,i.jsx)(e.code,{children:"wait()"}),"\u65B9\u6CD5\u4E0D\u4F1A\u8FD4\u56DE\uFF0C\u76F4\u5230\u5C06\u6765\u67D0\u4E2A\u65F6\u523B\uFF0C\u7EBF\u7A0B\u4ECE\u7B49\u5F85\u72B6\u6001\u88AB\u5176\u4ED6\u7EBF\u7A0B\u5524\u9192\u540E\uFF0C",(0,i.jsx)(e.code,{children:"wait()"}),"\u65B9\u6CD5\u624D\u4F1A\u8FD4\u56DE\uFF0C",(0,i.jsx)(e.strong,{children:"\u7136\u540E\uFF0C\u7EE7\u7EED\u6267\u884C\u4E0B\u4E00\u6761\u8BED\u53E5"}),"\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u6709\u4E9B\u4ED4\u7EC6\u7684\u7AE5\u978B\u4F1A\u6307\u51FA\uFF1A\u5373\u4F7F\u7EBF\u7A0B\u5728",(0,i.jsx)(e.code,{children:"getTask()"}),"\u5185\u90E8\u7B49\u5F85\uFF0C\u5176\u4ED6\u7EBF\u7A0B\u5982\u679C\u62FF\u4E0D\u5230",(0,i.jsx)(e.code,{children:"this"}),"\u9501\uFF0C\u7167\u6837\u65E0\u6CD5\u6267\u884C",(0,i.jsx)(e.code,{children:"addTask()"}),"\uFF0C\u80BF\u4E48\u529E\uFF1F"]}),"\n",(0,i.jsxs)(e.p,{children:["\u8FD9\u4E2A\u95EE\u9898\u7684\u5173\u952E\u5C31\u5728\u4E8E",(0,i.jsx)(e.code,{children:"wait()"}),"\u65B9\u6CD5\u7684\u6267\u884C\u673A\u5236\u975E\u5E38\u590D\u6742\u3002\u9996\u5148\uFF0C\u5B83\u4E0D\u662F\u4E00\u4E2A\u666E\u901A\u7684Java\u65B9\u6CD5\uFF0C\u800C\u662F\u5B9A\u4E49\u5728",(0,i.jsx)(e.code,{children:"Object"}),"\u7C7B\u7684\u4E00\u4E2A",(0,i.jsx)(e.code,{children:"native"}),"\u65B9\u6CD5\uFF0C\u4E5F\u5C31\u662F\u7531JVM\u7684C\u4EE3\u7801\u5B9E\u73B0\u7684\u3002\u5176\u6B21\uFF0C\u5FC5\u987B\u5728",(0,i.jsx)(e.code,{children:"synchronized"}),"\u5757\u4E2D\u624D\u80FD\u8C03\u7528",(0,i.jsx)(e.code,{children:"wait()"}),"\u65B9\u6CD5\uFF0C\u56E0\u4E3A",(0,i.jsx)(e.code,{children:"wait()"}),"\u65B9\u6CD5\u8C03\u7528\u65F6\uFF0C\u4F1A",(0,i.jsx)(e.em,{children:"\u91CA\u653E"}),"\u7EBF\u7A0B\u83B7\u5F97\u7684\u9501\uFF0C",(0,i.jsx)(e.code,{children:"wait()"}),"\u65B9\u6CD5\u8FD4\u56DE\u65F6\uFF0C\u7EBF\u7A0B\u53C8\u4F1A\u91CD\u65B0\u8BD5\u56FE\u83B7\u5F97\u9501\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u56E0\u6B64\uFF0C\u53EA\u80FD\u5728\u9501\u5BF9\u8C61\u4E0A\u8C03\u7528",(0,i.jsx)(e.code,{children:"wait()"}),"\u65B9\u6CD5\u3002\u56E0\u4E3A\u5728",(0,i.jsx)(e.code,{children:"getTask()"}),"\u4E2D\uFF0C\u6211\u4EEC\u83B7\u5F97\u4E86",(0,i.jsx)(e.code,{children:"this"}),"\u9501\uFF0C\u56E0\u6B64\uFF0C\u53EA\u80FD\u5728",(0,i.jsx)(e.code,{children:"this"}),"\u5BF9\u8C61\u4E0A\u8C03\u7528",(0,i.jsx)(e.code,{children:"wait()"}),"\u65B9\u6CD5\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public synchronized String getTask() {\r\n    while (queue.isEmpty()) {\r\n        // \u91CA\u653Ethis\u9501:\r\n        this.wait();\r\n        // \u91CD\u65B0\u83B7\u53D6this\u9501\r\n    }\r\n    return queue.remove();\r\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5F53\u4E00\u4E2A\u7EBF\u7A0B\u5728",(0,i.jsx)(e.code,{children:"this.wait()"}),"\u7B49\u5F85\u65F6\uFF0C\u5B83\u5C31\u4F1A\u91CA\u653E",(0,i.jsx)(e.code,{children:"this"}),"\u9501\uFF0C\u4ECE\u800C\u4F7F\u5F97\u5176\u4ED6\u7EBF\u7A0B\u80FD\u591F\u5728",(0,i.jsx)(e.code,{children:"addTask()"}),"\u65B9\u6CD5\u83B7\u5F97",(0,i.jsx)(e.code,{children:"this"}),"\u9501\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u73B0\u5728\u6211\u4EEC\u9762\u4E34\u7B2C\u4E8C\u4E2A\u95EE\u9898\uFF1A\u5982\u4F55\u8BA9\u7B49\u5F85\u7684\u7EBF\u7A0B\u88AB\u91CD\u65B0\u5524\u9192\uFF0C\u7136\u540E\u4ECE",(0,i.jsx)(e.code,{children:"wait()"}),"\u65B9\u6CD5\u8FD4\u56DE\uFF1F\u7B54\u6848\u662F\u5728\u76F8\u540C\u7684\u9501\u5BF9\u8C61\u4E0A\u8C03\u7528",(0,i.jsx)(e.code,{children:"notify()"}),"\u65B9\u6CD5\u3002\u6211\u4EEC\u4FEE\u6539",(0,i.jsx)(e.code,{children:"addTask()"}),"\u5982\u4E0B\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public synchronized void addTask(String s) {\r\n    this.queue.add(s);\r\n    this.notify(); // \u5524\u9192\u5728this\u9501\u7B49\u5F85\u7684\u7EBF\u7A0B\r\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u6CE8\u610F\u5230\u5728\u5F80\u961F\u5217\u4E2D\u6DFB\u52A0\u4E86\u4EFB\u52A1\u540E\uFF0C\u7EBF\u7A0B\u7ACB\u523B\u5BF9",(0,i.jsx)(e.code,{children:"this"}),"\u9501\u5BF9\u8C61\u8C03\u7528",(0,i.jsx)(e.code,{children:"notify()"}),"\u65B9\u6CD5\uFF0C\u8FD9\u4E2A\u65B9\u6CD5\u4F1A\u5524\u9192\u4E00\u4E2A\u6B63\u5728",(0,i.jsx)(e.code,{children:"this"}),"\u9501\u7B49\u5F85\u7684\u7EBF\u7A0B\uFF08\u5C31\u662F\u5728",(0,i.jsx)(e.code,{children:"getTask()"}),"\u4E2D\u4F4D\u4E8E",(0,i.jsx)(e.code,{children:"this.wait()"}),"\u7684\u7EBF\u7A0B\uFF09\uFF0C\u4ECE\u800C\u4F7F\u5F97\u7B49\u5F85\u7EBF\u7A0B\u4ECE",(0,i.jsx)(e.code,{children:"this.wait()"}),"\u65B9\u6CD5\u8FD4\u56DE\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4EEC\u6765\u770B\u4E00\u4E2A\u5B8C\u6574\u7684\u4F8B\u5B50\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class WaitNotifyTest {\r\n    public static void main(String[] args) throws InterruptedException {\r\n        TaskQueue q = new TaskQueue();\r\n        List<Thread> ts = new ArrayList<>();\r\n        for (int i = 0; i < 5; i++) {\r\n            Thread t = new Thread(() -> {\r\n                // \u6267\u884Ctask:\r\n                while (true) {\r\n                    try {\r\n                        String s = q.getTask();\r\n                        System.out.println("execute task: " + s);\r\n                    } catch (InterruptedException e) {\r\n                        System.out.println("interrupt thread!");\r\n                        return;\r\n                    }\r\n                }\r\n            });\r\n            t.start();\r\n            ts.add(t);\r\n        }\r\n        Thread add = new Thread(() -> {\r\n            for (int i = 0; i < 10; i++) {\r\n                // \u653E\u5165task:\r\n                String s = "t-i" + i + "-" + new Random().nextInt(100);\r\n                System.out.println("add task: " + s);\r\n                q.addTask(s);\r\n                try {\r\n                    Thread.sleep(100);\r\n                } catch (InterruptedException e) {\r\n                    System.out.println("e = " + e);\r\n                }\r\n            }\r\n        });\r\n        add.start();\r\n        add.join();\r\n        Thread.sleep(100);\r\n        for (Thread t : ts) {\r\n            t.interrupt(); //\u4E2D\u65AD\u6B63\u5728wait\u7684\u7EBF\u7A0B\r\n        }\r\n    }\r\n}\r\nclass TaskQueue {\r\n    Queue<String> queue = new LinkedList<>();\r\n    public synchronized void addTask(String s) {\r\n        this.queue.add(s);\r\n        this.notifyAll();\r\n    }\r\n    public synchronized String getTask() throws InterruptedException {\r\n        while (queue.isEmpty()) {\r\n            System.out.println(Thread.currentThread().getName() + " queue continue wait!");\r\n            this.wait();\r\n        }\r\n        System.out.println(Thread.currentThread().getName() + " queue is notify!");\r\n        return queue.remove();\r\n    }\r\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u8FD9\u4E2A\u4F8B\u5B50\u4E2D\uFF0C\u6211\u4EEC\u91CD\u70B9\u5173\u6CE8",(0,i.jsx)(e.code,{children:"addTask()"}),"\u65B9\u6CD5\uFF0C\u5185\u90E8\u8C03\u7528\u4E86",(0,i.jsx)(e.code,{children:"this.notifyAll()"}),"\u800C\u4E0D\u662F",(0,i.jsx)(e.code,{children:"this.notify()"}),"\uFF0C\u4F7F\u7528",(0,i.jsx)(e.code,{children:"notifyAll()"}),"\u5C06\u5524\u9192\u6240\u6709\u5F53\u524D\u6B63\u5728",(0,i.jsx)(e.code,{children:"this"}),"\u9501\u7B49\u5F85\u7684\u7EBF\u7A0B\uFF0C\u800C",(0,i.jsx)(e.code,{children:"notify()"}),"\u53EA\u4F1A\u5524\u9192\u5176\u4E2D\u4E00\u4E2A\uFF08\u5177\u4F53\u54EA\u4E2A\u4F9D\u8D56\u64CD\u4F5C\u7CFB\u7EDF\uFF0C\u6709\u4E00\u5B9A\u7684\u968F\u673A\u6027\uFF09\u3002\u8FD9\u662F\u56E0\u4E3A\u53EF\u80FD\u6709\u591A\u4E2A\u7EBF\u7A0B\u6B63\u5728",(0,i.jsx)(e.code,{children:"getTask()"}),"\u65B9\u6CD5\u5185\u90E8\u7684",(0,i.jsx)(e.code,{children:"wait()"}),"\u4E2D\u7B49\u5F85\uFF0C\u4F7F\u7528",(0,i.jsx)(e.code,{children:"notifyAll()"}),"\u5C06\u4E00\u6B21\u6027\u5168\u90E8\u5524\u9192\u3002\u901A\u5E38\u6765\u8BF4\uFF0C",(0,i.jsx)(e.code,{children:"notifyAll()"}),"\u66F4\u5B89\u5168\u3002\u6709\u4E9B\u65F6\u5019\uFF0C\u5982\u679C\u6211\u4EEC\u7684\u4EE3\u7801\u903B\u8F91\u8003\u8651\u4E0D\u5468\uFF0C\u7528",(0,i.jsx)(e.code,{children:"notify()"}),"\u4F1A\u5BFC\u81F4\u53EA\u5524\u9192\u4E86\u4E00\u4E2A\u7EBF\u7A0B\uFF0C\u800C\u5176\u4ED6\u7EBF\u7A0B\u53EF\u80FD\u6C38\u8FDC\u7B49\u5F85\u4E0B\u53BB\u9192\u4E0D\u8FC7\u6765\u4E86\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u4F46\u662F\uFF0C\u6CE8\u610F\u5230",(0,i.jsx)(e.code,{children:"wait()"}),"\u65B9\u6CD5\u8FD4\u56DE\u65F6\u9700\u8981",(0,i.jsx)(e.em,{children:"\u91CD\u65B0"}),"\u83B7\u5F97",(0,i.jsx)(e.code,{children:"this"}),"\u9501\u3002\u5047\u8BBE\u5F53\u524D\u67093\u4E2A\u7EBF\u7A0B\u88AB\u5524\u9192\uFF0C\u5524\u9192\u540E\uFF0C\u9996\u5148\u8981\u7B49\u5F85\u6267\u884C",(0,i.jsx)(e.code,{children:"addTask()"}),"\u7684\u7EBF\u7A0B\u7ED3\u675F\u6B64\u65B9\u6CD5\u540E\uFF0C\u624D\u80FD\u91CA\u653E",(0,i.jsx)(e.code,{children:"this"}),"\u9501\uFF0C\u968F\u540E\uFF0C\u8FD93\u4E2A\u7EBF\u7A0B\u4E2D\u53EA\u80FD\u6709\u4E00\u4E2A\u83B7\u53D6\u5230",(0,i.jsx)(e.code,{children:"this"}),"\u9501\uFF0C\u5269\u4E0B\u4E24\u4E2A\u5C06\u7EE7\u7EED\u7B49\u5F85\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u518D\u6CE8\u610F\u5230\u6211\u4EEC\u5728",(0,i.jsx)(e.code,{children:"while()"}),"\u5FAA\u73AF\u4E2D\u8C03\u7528",(0,i.jsx)(e.code,{children:"wait()"}),"\uFF0C\u800C\u4E0D\u662F",(0,i.jsx)(e.code,{children:"if"}),"\u8BED\u53E5\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public synchronized String getTask() throws InterruptedException {\r\n    if (queue.isEmpty()) {\r\n        this.wait();\r\n    }\r\n    return queue.remove();\r\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5982\u679C\u662F\u7528while\u4F5C\u5224\u65AD\uFF0C\u6BCF\u6B21wait\u88ABnotify\u5524\u9192\u540E\uFF0C\u4F1A\u7EE7\u7EED\u5FAA\u73AF\uFF0C\u5224\u65AD\u5F53\u524D\u961F\u5217\u662F\u5426\u4E3A\u7A7A\uFF0C\u800Cif\u505A\u5224\u65AD\u65F6\uFF0C\u5982\u679Cwait\u88AB\u5524\u9192\uFF0C\u6B64\u65F6if\u5DF2\u7ECF\u88AB\u5224\u65AD\u8FC7\u4E86\uFF0C\u5C31\u4F1A\u76F4\u63A5\u7EE7\u7EED\u6267\u884C\u540E\u9762\u7684\u4EE3\u7801\uFF0C\u83B7\u53D6\u961F\u5217\u5143\u7D20\uFF0C\u6B64\u65F6\u5982\u679C\u961F\u5217\u5143\u7D20\u4E3A\u7A7A\uFF08\u56E0\u4E3A\u662F\u4E00\u53E3\u6C14\u5524\u9192\u6240\u6709\u8FDB\u7A0B\uFF0C\u4F60\u65E0\u6CD5\u4FDD\u8BC1\u73B0\u5728\u8FD9\u4E2A\u8FDB\u7A0B\u6267\u884C\u7684\u65F6\u5019\uFF0C\u961F\u5217\u8FD8\u6709\u6CA1\u6709\u4E1C\u897F\uFF09\uFF0C\u90A3\u4E48\u8BE5\u7EBF\u7A0B\u5C31\u62A5nosuchelement exception\u3002"}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"[!tip]"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5DF2\u5524\u9192\u7684\u7EBF\u7A0B\u8FD8\u9700\u8981\u91CD\u65B0\u83B7\u5F97\u9501\u540E\u624D\u80FD\u7EE7\u7EED\u6267\u884C"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u4F7F\u7528reentrantlock",children:"\u4F7F\u7528ReentrantLock"})]})}function o(n={}){let{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(a,{...n})}):a(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>c,x:()=>l});var d=r(6540);let i={},s=d.createContext(i);function c(n){let e=d.useContext(s);return d.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:c(n.components),d.createElement(s.Provider,{value:e},n.children)}}}]);
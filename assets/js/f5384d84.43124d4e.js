"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3793],{4524:(n,r,e)=>{e.r(r),e.d(r,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>i});let a=JSON.parse('{"id":"java/JAVA-Elaticsearch","title":"JAVA-ES","description":"\u90E8\u7F72","source":"@site/docs/java/JAVA-Elaticsearch.md","sourceDirName":"java","slug":"/java/JAVA-Elaticsearch","permalink":"/mhuahe.com/docs/java/JAVA-Elaticsearch","draft":false,"unlisted":false,"editUrl":"https://github.dev/mhuahe/mhuahe.com/blob/master-ts/docs/java/JAVA-Elaticsearch.md","tags":[],"version":"current","lastUpdatedBy":"heminhua","lastUpdatedAt":1725382806000,"frontMatter":{},"sidebar":"java","previous":{"title":"JAVA-\u8BBE\u8BA1\u6A21\u5F0F","permalink":"/mhuahe.com/docs/java/JAVA-Design-Pattern"},"next":{"title":"JAVA-\u52A0\u5BC6\u65B9\u5F0F","permalink":"/mhuahe.com/docs/java/JAVA-Encryption"}}');var l=e(4848),s=e(8453);let t={},c="JAVA-ES",o={},i=[{value:"\u90E8\u7F72",id:"\u90E8\u7F72",level:3},{value:"\u7D22\u5F15\u64CD\u4F5C",id:"\u7D22\u5F15\u64CD\u4F5C",level:3},{value:"\u7C7B\u578B\u64CD\u4F5C",id:"\u7C7B\u578B\u64CD\u4F5C",level:3},{value:"\u6587\u6863\u64CD\u4F5C",id:"\u6587\u6863\u64CD\u4F5C",level:3},{value:"\u6570\u636E\u641C\u7D22",id:"\u6570\u636E\u641C\u7D22",level:3},{value:"\u7B80\u5355\u641C\u7D22",id:"\u7B80\u5355\u641C\u7D22",level:3},{value:"\u6761\u4EF6\u641C\u7D22",id:"\u6761\u4EF6\u641C\u7D22",level:3},{value:"\u7EC4\u5408\u641C\u7D22",id:"\u7EC4\u5408\u641C\u7D22",level:3},{value:"\u8FC7\u6EE4\u641C\u7D22",id:"\u8FC7\u6EE4\u641C\u7D22",level:3},{value:"\u641C\u7D22\u805A\u5408",id:"\u641C\u7D22\u805A\u5408",level:3},{value:"SpringBoot\u96C6\u6210",id:"springboot\u96C6\u6210",level:3},{value:"IK\u5206\u8BCD\u5668",id:"ik\u5206\u8BCD\u5668",level:4},{value:"Kibana",id:"kibana",level:4},{value:"filebeat",id:"filebeat",level:4},{value:"Logstash",id:"logstash",level:4},{value:"canal\u6570\u636E\u540C\u6B65",id:"canal\u6570\u636E\u540C\u6B65",level:4},{value:"\u914D\u7F6Emysql",id:"\u914D\u7F6Emysql",level:3},{value:"Lucene",id:"lucene",level:3},{value:"\u5E38\u7528\u6CE8\u89E3",id:"\u5E38\u7528\u6CE8\u89E3",level:3},{value:"\u7248\u672C\u517C\u5BB9",id:"\u7248\u672C\u517C\u5BB9",level:3}];function d(n){let r={a:"a",code:"code",h1:"h1",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",...(0,s.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.header,{children:(0,l.jsx)(r.h1,{id:"java-es",children:"JAVA-ES"})}),"\n",(0,l.jsx)(r.h3,{id:"\u90E8\u7F72",children:"\u90E8\u7F72"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"https://www.elastic.co/cn/downloads/past-releases/elasticsearch-7-17-3\r\n1\u3001\u542F\u52A8\r\n	./bin/elasticsearch.bat\r\n2\u3001\u8BBF\u95EE\r\n	localhost:9200\r\n3\u3001\u5B89\u88C5\u6210windows\u670D\u52A1\r\n	elasticsearch-service.bat install\r\n    /*\r\n        install: \u5B89\u88C5Elasticsearch\u670D\u52A1\r\n        remove: \u5220\u9664\u5DF2\u5B89\u88C5\u7684Elasticsearch\u670D\u52A1\uFF08\u5982\u679C\u542F\u52A8\u5219\u505C\u6B62\u670D\u52A1\uFF09\r\n        start: \u542F\u52A8Elasticsearch\u670D\u52A1\uFF08\u5982\u679C\u5DF2\u5B89\u88C5\uFF09\r\n        stop: \u505C\u6B62\u670D\u52A1\uFF08\u5982\u679C\u542F\u52A8\uFF09\r\n        manager:\u542F\u52A8GUI\u6765\u7BA1\u7406\u5DF2\u5B89\u88C5\u7684\u670D\u52A1\r\n    */\r\n4\u3001\u5173\u95ED\u670D\u52A1\r\n    netstat -ano | findstr 9200\r\n    taskkill -pid 25776 -f\r\n4\u3001\u5B89\u88C5Elasticsearch-head\r\n	\u5B89\u88C5grunt\u73AF\u5883 npm install -g grunt-cli\r\n5\u3001\u542F\u52A8\r\n	npm install\r\n6\u3001\u5B89\u88C5kibana\r\n7\u3001\u91CD\u7F6E\u5BC6\u7801\r\nelasticsearch-reset-password -i -u elastic\r\n\r\n8\u3001\r\n\u7D22\u5F15\uFF1Aindex\uFF0C\u76F8\u5F53\u4E8E\u6570\u636E\u5E93\u4E2D\u7684database\r\n\u7C7B\u578B\uFF1Atype\u76F8\u5F53\u4E8E\u6570\u636E\u5E93\u4E2D\u7684table\r\n\u4E3B\u952E\uFF1Aid\u76F8\u5F53\u4E8E\u6570\u636E\u5E93\u4E2D\u8BB0\u5F55\u7684\u4E3B\u952E\uFF0C\u662F\u552F\u4E00\u7684\r\n\u6587\u6863\uFF1Adocument \u76F8\u5F53\u4E8E\u4E00\u6761\u6570\u636E\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"v\u662F\u7528\u6765\u8981\u6C42\u5728\u7ED3\u679C\u4E2D\u8FD4\u56DE\u8868\u5934\r\n-- \u67E5\u770B\u96C6\u7FA4\u7684\u5065\u5EB7\u72B6\u51B5\r\nhttp://localhost:9200/_cat\r\n-- \u67E5\u770BES\u96C6\u7FA4\u7684master\u4E3B\u8282\u70B9\u72B6\u6001\r\nhttp://10.0.8.47:9200/_cat/nodes?v\r\n-- \u67E5\u770BElasticsearch\u5065\u5EB7\u72B6\u6001\r\nhttp://localhost:9200/_cat/health?v\n"})}),"\n",(0,l.jsx)(r.h3,{id:"\u7D22\u5F15\u64CD\u4F5C",children:"\u7D22\u5F15\u64CD\u4F5C"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"-- \u67E5\u770B\u6240\u6709\u7D22\u5F15\r\nGET /_cat/indices?v\r\n\r\n-- \u521B\u5EFA\u4E00\u4E2A\u540D\u4E3A customer \u7684\u7D22\u5F15\u3002pretty\u8981\u6C42\u8FD4\u56DE\u4E00\u4E2A\u6F02\u4EAE\u7684json \u7ED3\u679C\r\nPUT /customer?pretty\r\n\r\n-- \u67E5\u770B\u7D22\u5F15customer\r\nGET /customer\r\n\r\n-- \u5220\u9664\u7D22\u5F15customer\r\nDELETE /customer\n"})}),"\n",(0,l.jsx)(r.h3,{id:"\u7C7B\u578B\u64CD\u4F5C",children:"\u7C7B\u578B\u64CD\u4F5C"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"-- \u67E5\u770B\u6587\u6863\u7684\u7C7B\u578B\r\nGET /customer/_mapping\n"})}),"\n",(0,l.jsx)(r.h3,{id:"\u6587\u6863\u64CD\u4F5C",children:"\u6587\u6863\u64CD\u4F5C"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:'-- \u6DFB\u52A0\u6587\u6863\r\nPUT /customer/_doc/1\r\n{\r\n  "name": "John Doe"\r\n}\r\n\r\n-- \u67E5\u770Bcustomer\u4E3B\u952E\u4E3A1\u7684\u6587\u6863\r\nGET /customer/_doc/1\r\n\r\n-- \u4FEE\u6539\u6587\u6863\r\nPOST /customer/_doc/1/_update\r\n{\r\n  "doc": { "name": "Jane Doe" }\r\n}\r\n\r\n-- \u5220\u9664\u6587\u6863\r\nDELETE /customer/_doc/1\r\n\r\n-- \u6587\u6863\u505A\u6279\u91CF\u64CD\u4F5C\r\nPOST /customer/_doc/_bulk\r\n{"index":{"_id":"1"}}\r\n{"name": "John Doe" }\r\n{"index":{"_id":"2"}}\r\n{"name": "Jane Doe" }\n'})}),"\n",(0,l.jsx)(r.h3,{id:"\u6570\u636E\u641C\u7D22",children:"\u6570\u636E\u641C\u7D22"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"-- \u6D4B\u8BD5\u6570\u636E\u5730\u5740:\r\nhttps://github.com/macrozheng/mall-learning/blob/master/document/json/accounts.json\n"})}),"\n",(0,l.jsx)(r.h3,{id:"\u7B80\u5355\u641C\u7D22",children:"\u7B80\u5355\u641C\u7D22"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:'-- \u641C\u7D22\u5168\u90E8(\u9ED8\u8BA4\u5206\u987510)\r\nGET /bank/_search\r\n{\r\n  "query": { "match_all": {} }\r\n}\r\n\r\n-- \u5206\u9875\u641C\u7D22\uFF1Afrom\u8868\u793A\u504F\u79FB\u91CF\uFF0C\u4ECE0\u5F00\u59CB\uFF0Csize\u8868\u793A\u6BCF\u9875\u663E\u793A\u7684\u6570\u91CF\r\nGET /customer/_search\r\n{\r\n  "query": { "match_all": {} },\r\n  "from": 0,\r\n  "size": 10\r\n}\r\n\r\n-- \u641C\u7D22\u6392\u5E8F\uFF1A\u4F7F\u7528sort\u8868\u793A\uFF0C\u4F8B\u5982\u6309balance\u5B57\u6BB5\u964D\u5E8F\u6392\u5217\r\nGET /customer/_search\r\n{\r\n  "query": { "match_all": {} },\r\n  "sort": { "balance": { "order": "desc" } }\r\n}\r\n\r\n-- \u641C\u7D22\u5E76\u8FD4\u56DE\u6307\u5B9A\u5B57\u6BB5\u5185\u5BB9\uFF0C\u4F7F\u7528_source\u8868\u793A\uFF0C\u4F8B\u5982\u53EA\u8FD4\u56DEaccount_number\u548Cbalance\u4E24\u4E2A\u5B57\u6BB5\u5185\u5BB9\r\nGET /customer/_search\r\n{\r\n  "query": { "match_all": {} },\r\n  "_source": ["account_number", "balance"]\r\n}\n'})}),"\n",(0,l.jsx)(r.h3,{id:"\u6761\u4EF6\u641C\u7D22",children:"\u6761\u4EF6\u641C\u7D22"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:'-- \u6761\u4EF6\u641C\u7D22\uFF1A\u4F7F\u7528match\u8868\u793A\u5339\u914D\u6761\u4EF6\uFF0C\u4F8B\u5982\u641C\u7D22\u51FAaccount_number\u4E3A20\u7684\u6587\u6863\r\nGET /customer/_search\r\n{\r\n  "query": {\r\n    "match": {\r\n      "account_number": 20\r\n    }\r\n  }\r\n}\r\n\r\n-- \u6587\u672C\u7C7B\u578B\u5B57\u6BB5\u7684\u6761\u4EF6\u641C\u7D22\uFF0C\u4F8B\u5982\u641C\u7D22address\u5B57\u6BB5\u4E2D\u5305\u542Bmill\u7684\u6587\u6863\uFF0C\u5BF9\u4E8E\u6570\u503C\u7C7B\u578Bmatch\u64CD\u4F5C\u4F7F\u7528\u7684\u662F\u7CBE\u786E\u5339\u914D\uFF0C\u5BF9\u4E8E\u6587\u672C\u7C7B\u578B\u4F7F\u7528\u7684\u662F\u6A21\u7CCA\u5339\u914D\r\nGET /customer/_search\r\n{\r\n  "query": {\r\n    "match": {\r\n      "address": "mill"\r\n    }\r\n  },\r\n  "_source": [\r\n    "address",\r\n    "account_number"\r\n  ]\r\n}\r\n\r\n-- \u77ED\u8BED\u5339\u914D\u641C\u7D22\uFF0C\u4F7F\u7528match_phrase\u8868\u793A\uFF0C\u4F8B\u5982\u641C\u7D22address\u5B57\u6BB5\u4E2D\u540C\u65F6\u5305\u542Bmill\u548Clane\u7684\u6587\u6863\r\nGET /customer/_search\r\n{\r\n  "query": {\r\n    "match_phrase": {\r\n      "address": "mill lane"\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,l.jsx)(r.h3,{id:"\u7EC4\u5408\u641C\u7D22",children:"\u7EC4\u5408\u641C\u7D22"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:'-- \u7EC4\u5408\u641C\u7D22\uFF0C\u4F7F\u7528bool\u6765\u8FDB\u884C\u7EC4\u5408\uFF0Cmust\u8868\u793A\u540C\u65F6\u6EE1\u8DB3\uFF0C\u4F8B\u5982\u641C\u7D22address\u5B57\u6BB5\u4E2D\u540C\u65F6\u5305\u542Bmill\u548Clane\u7684\u6587\u6863\r\nGET /customer/_search\r\n{\r\n  "query": {\r\n    "bool": {\r\n      "must": [\r\n        { "match": { "address": "mill" } },\r\n        { "match": { "address": "lane" } }\r\n      ]\r\n    }\r\n  }\r\n}\r\n\r\n-- \u7EC4\u5408\u641C\u7D22\uFF0Cshould\u8868\u793A\u6EE1\u8DB3\u5176\u4E2D\u4EFB\u610F\u4E00\u4E2A\uFF0C\u641C\u7D22address\u5B57\u6BB5\u4E2D\u5305\u542Bmill\u6216\u8005lane\u7684\u6587\u6863\r\nGET /customer/_search\r\n{\r\n  "query": {\r\n    "bool": {\r\n      "should": [\r\n        { "match": { "address": "mill" } },\r\n        { "match": { "address": "lane" } }\r\n      ]\r\n    }\r\n  }\r\n}\r\n\r\n-- \u7EC4\u5408\u641C\u7D22\uFF0Cmust_not\u8868\u793A\u540C\u65F6\u4E0D\u6EE1\u8DB3\uFF0C\u4F8B\u5982\u641C\u7D22address\u5B57\u6BB5\u4E2D\u4E0D\u5305\u542Bmill\u4E14\u4E0D\u5305\u542Blane\u7684\u6587\u6863\r\nGET /customer/_search\r\n{\r\n  "query": {\r\n    "bool": {\r\n      "must_not": [\r\n        { "match": { "address": "mill" } },\r\n        { "match": { "address": "lane" } }\r\n      ]\r\n    }\r\n  }\r\n}\r\n\r\n-- \u7EC4\u5408\u641C\u7D22\uFF0C\u7EC4\u5408must\u548Cmust_not\uFF0C\u4F8B\u5982\u641C\u7D22age\u5B57\u6BB5\u7B49\u4E8E40\u4E14state\u5B57\u6BB5\u4E0D\u5305\u542BID\u7684\u6587\u6863\r\nGET /customer/_search\r\n{\r\n  "query": {\r\n    "bool": {\r\n      "must": [\r\n        { "match": { "age": "40" } }\r\n      ],\r\n      "must_not": [\r\n        { "match": { "state": "ID" } }\r\n      ]\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,l.jsx)(r.h3,{id:"\u8FC7\u6EE4\u641C\u7D22",children:"\u8FC7\u6EE4\u641C\u7D22"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:'-- \u641C\u7D22\u8FC7\u6EE4\uFF0C\u4F7F\u7528filter\u6765\u8868\u793A\uFF0C\u4F8B\u5982\u8FC7\u6EE4\u51FAbalance\u5B57\u6BB5\u572820000~30000\u7684\u6587\u6863\r\nGET /customer/_search\r\n{\r\n  "query": {\r\n    "bool": {\r\n      "must": { "match_all": {} },\r\n      "filter": {\r\n        "range": {\r\n          "balance": {\r\n            "gte": 20000,\r\n            "lte": 30000\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,l.jsx)(r.h3,{id:"\u641C\u7D22\u805A\u5408",children:"\u641C\u7D22\u805A\u5408"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:'-- \u5BF9\u641C\u7D22\u7ED3\u679C\u8FDB\u884C\u805A\u5408\uFF0C\u4F7F\u7528aggs\u6765\u8868\u793A\uFF0C\u7C7B\u4F3C\u4E8EMySql\u4E2D\u7684group by\uFF0C\u4F8B\u5982\u5BF9state\u5B57\u6BB5\u8FDB\u884C\u805A\u5408\uFF0C\u7EDF\u8BA1\u51FA\u76F8\u540Cstate\u7684\u6587\u6863\u6570\u91CF\r\nGET /customer/_search\r\n{\r\n  "size": 0,\r\n  "aggs": {\r\n    "group_by_state": {\r\n      "terms": {\r\n        "field": "state.keyword"\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n-- \u5D4C\u5957\u805A\u5408\uFF0C\u4F8B\u5982\u5BF9state\u5B57\u6BB5\u8FDB\u884C\u805A\u5408\uFF0C\u7EDF\u8BA1\u51FA\u76F8\u540Cstate\u7684\u6587\u6863\u6570\u91CF\uFF0C\u518D\u7EDF\u8BA1\u51FAbalance\u7684\u5E73\u5747\u503C\r\nGET /customer/_search\r\n{\r\n  "size": 0,\r\n  "aggs": {\r\n    "group_by_state": {\r\n      "terms": {\r\n        "field": "state.keyword"\r\n      },\r\n      "aggs": {\r\n        "average_balance": {\r\n          "avg": {\r\n            "field": "balance"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n-- \u5BF9\u805A\u5408\u641C\u7D22\u7684\u7ED3\u679C\u8FDB\u884C\u6392\u5E8F\uFF0C\u4F8B\u5982\u6309balance\u7684\u5E73\u5747\u503C\u964D\u5E8F\u6392\u5217\r\nGET /customer/_search\r\n{\r\n  "size": 0,\r\n  "aggs": {\r\n    "group_by_state": {\r\n      "terms": {\r\n        "field": "state.keyword",\r\n        "order": {\r\n          "average_balance": "desc"\r\n        }\r\n      },\r\n      "aggs": {\r\n        "average_balance": {\r\n          "avg": {\r\n            "field": "balance"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n-- \u6309\u5B57\u6BB5\u503C\u7684\u8303\u56F4\u8FDB\u884C\u5206\u6BB5\u805A\u5408\uFF0C\u4F8B\u5982\u5206\u6BB5\u8303\u56F4\u4E3Aage\u5B57\u6BB5\u7684[20,30] [30,40] [40,50]\uFF0C\u4E4B\u540E\u6309gender\u7EDF\u8BA1\u6587\u6863\u4E2A\u6570\u548Cbalance\u7684\u5E73\u5747\u503C\r\nGET /customer/_search\r\n{\r\n  "size": 0,\r\n  "aggs": {\r\n    "group_by_age": {\r\n      "range": {\r\n        "field": "age",\r\n        "ranges": [\r\n          {\r\n            "from": 20,\r\n            "to": 30\r\n          },\r\n          {\r\n            "from": 30,\r\n            "to": 40\r\n          },\r\n          {\r\n            "from": 40,\r\n            "to": 50\r\n          }\r\n        ]\r\n      },\r\n      "aggs": {\r\n        "group_by_gender": {\r\n          "terms": {\r\n            "field": "gender.keyword"\r\n          },\r\n          "aggs": {\r\n            "average_balance": {\r\n              "avg": {\r\n                "field": "balance"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,l.jsx)(r.h3,{id:"springboot\u96C6\u6210",children:"SpringBoot\u96C6\u6210"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"-- \u5E38\u7528\u6CE8\u89E3\r\n-- @Document\r\n\u6CE8\u89E3\u4F5C\u7528\u5728\u7C7B\u4E0A\uFF0C\u6807\u8BB0\u5B9E\u4F53\u7C7B\u4E3A\u6587\u6863\u5BF9\u8C61\uFF0C\u6307\u5B9A\u5B9E\u4F53\u7C7B\u4E0E\u7D22\u5F15\u5BF9\u5E94\u5173\u7CFB\u3002\u5E38\u7528\u914D\u7F6E\u9879\u6709\uFF1A\r\nindexName\uFF1A\u7D22\u5F15\u540D\u79F0\r\ntype: \u7D22\u5F15\u7C7B\u578B\uFF0C\u9ED8\u8BA4\u4E3A\u7A7A\r\nshards: \u4E3B\u5206\u7247\u6570\u91CF\uFF0C\u9ED8\u8BA45\r\nreplicas\uFF1A\u590D\u5236\u5206\u7247\u6570\u91CF\uFF0C\u9ED8\u8BA41\r\ncreateIndex\uFF1A\u521B\u5EFA\u7D22\u5F15\uFF0C\u9ED8\u8BA4\u4E3Atrue\r\n-- @Id\r\n\u6307\u5B9A\u6587\u6863ID\uFF0C\u52A0\u4E0A\u8FD9\u4E2A\u6CE8\u89E3\uFF0C\u6587\u6863\u7684_id\u4F1A\u4E0E\u6211\u4EEC\u7684\u6570\u636EID\u662F\u4E00\u81F4\u7684\uFF0C\u5426\u5219\u5728\u4E0D\u7ED9\u5B9A\u9ED8\u8BA4\u503C\u7684\u60C5\u51B5\u4E0B\uFF0Ces\u4F1A\u81EA\u52A8\u521B\u5EFA\r\n-- @Field\r\n\u6307\u5B9A\u666E\u901A\u5C5E\u6027\uFF0C\u6807\u660E\u8FD9\u4E2A\u662F\u6587\u6863\u4E2D\u7684\u4E00\u4E2A\u5B57\u6BB5\r\n\u5E38\u7528\u7684\u914D\u7F6E\u9879\u6709\uFF1A\r\ntype\uFF1A \u5BF9\u5E94Elasticsearch\u4E2D\u5C5E\u6027\u7C7B\u578B\u3002\u9ED8\u8BA4\u81EA\u52A8\u68C0\u6D4B\u3002\u4F7F\u7528FiledType\u679A\u4E3E\u53EF\u4EE5\u5FEB\u901F\u83B7\u53D6\r\nindex\uFF1A\u662F\u5426\u521B\u5EFA\u5012\u6392\u7D22\u5F15\uFF0C\u4E00\u822C\u4E0D\u9700\u8981\u5206\u8BCD\u7684\u5C5E\u6027\u4E0D\u9700\u8981\u521B\u5EFA\u7D22\u5F15\r\nanalyzer\uFF1A\u6307\u5B9A\u7D22\u5F15\u7C7B\u578B\r\nstore\uFF1A\u662F\u5426\u8FDB\u884C\u5B58\u50A8\uFF0C\u9ED8\u8BA4\u4E0D\u8FDB\u884C\u5B58\u50A8\n"})}),"\n",(0,l.jsx)(r.h4,{id:"ik\u5206\u8BCD\u5668",children:"IK\u5206\u8BCD\u5668"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"https://github.com/medcl/elasticsearch-analysis-ik/release\r\n\r\n-- \u4E0B\u8F7D\u540E\u89E3\u538B\u5230Elasticsearch\u7684plugins\u76EE\u5F55\u4E0B\r\n\r\nelasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.2.2/elasticsearch-analysis-ik-6.2.2.zip\n"})}),"\n",(0,l.jsx)(r.h4,{id:"kibana",children:"Kibana"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"https://www.elastic.co/cn/downloads/past-releases/kibana-7-17-3\r\n\r\nhttp://127.0.0.1:5601\n"})}),"\n",(0,l.jsx)(r.h4,{id:"filebeat",children:"filebeat"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-yaml",children:'https://www.elastic.co/cn/downloads/past-releases/filebeat-7-17-3\r\n\r\n# \u4FEE\u6539\u914D\u7F6Efilebeat.yml\r\nfilebeat.inputs:\r\n- type: log\r\n  enabled: true\r\n  paths:\r\n    - /home/elastic/test_logs/*.log  \r\n  #\u4E0D\u4EE5[\u5F00\u5934\u7684\u884C\u90FD\u5408\u5E76\u5230\u4E0A\u4E00\u884C\u7684\u672B\u5C3E\r\n  multiline.pattern: ^\\[\r\n  multiline.negate: true\r\n  multiline.match: after\r\n  \r\noutput.logstash:\r\n  hosts: ["localhost:5044"]\r\n\r\n# \u542F\u52A8\r\n./filebeat -e -c filebeat.yml\n'})}),"\n",(0,l.jsx)(r.h4,{id:"logstash",children:"Logstash"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"-- \u64CD\u4F5C\u6587\u6863\r\nhttps://www.macrozheng.com/mall/reference/mall_elk_advance.html\r\n-- \u4E0B\u8F7D\u5730\u5740\r\nhttps://www.elastic.co/cn/downloads/past-releases/logstash-7-17-3\r\n\r\n\u5C06Logstash\u7684\u914D\u7F6E\u6587\u4EF6logstash.conf\u62F7\u8D1D\u5230\u5B89\u88C5\u76EE\u5F55\u7684bin\u76EE\u5F55\u4E0B\uFF0C\u914D\u7F6E\u6587\u4EF6\u5730\u5740\uFF1Ahttps://github.com/macrozheng/mall/blob/master/document/elk/logstash.conf\r\n\r\nLogstash\u9700\u8981\u5B89\u88C5json_lines\u63D2\u4EF6\r\nlogstash-plugin install logstash-codec-json_lines\r\n\r\n\u8FD0\u884Cbin\u76EE\u5F55\u4E0B\u7684logstash.bat\uFF0C\u542F\u52A8Logstash\u670D\u52A1\uFF0C\u542F\u52A8\u547D\u4EE4\u5982\u4E0B\r\nlogstash -f logstash.conf\r\n\r\nkibana\u4E2D\u67E5\u770B\u6536\u96C6\u7684\u65E5\u5FD7\r\n1\u3001Management --> kibana - index Patterns\r\n2\u3001\u8F93\u5165mall-* --> Next step\r\n3\u3001\u9009\u62E9@timestamp --> Create index pattern\r\n4\u3001\u5728Discover\u4E2D\u67E5\u770B\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:'-- filter\uFF1A\u5728Logback\u4E2D\u6709\u4E24\u79CD\u4E0D\u540C\u7684\u8FC7\u6EE4\u5668\uFF0C\u7528\u6765\u8FC7\u6EE4\u65E5\u5FD7\u8F93\u51FA\r\n1\u3001ThresholdFilter\uFF1A\u4E34\u754C\u503C\u8FC7\u6EE4\u5668\uFF0C\u8FC7\u6EE4\u6389\u4F4E\u4E8E\u6307\u5B9A\u4E34\u754C\u503C\u7684\u65E5\u5FD7\uFF0C\u6BD4\u5982\u4E0B\u9762\u7684\u914D\u7F6E\u5C06\u8FC7\u6EE4\u6389\u6240\u6709\u4F4E\u4E8EINFO\u7EA7\u522B\u7684\u65E5\u5FD7\u3002\r\n<filter class="ch.qos.logback.classic.filter.ThresholdFilter">\r\n    <level>INFO</level>\r\n</filter>\r\n\r\n2\u3001LevelFilter\uFF1A\u7EA7\u522B\u8FC7\u6EE4\u5668\uFF0C\u6839\u636E\u65E5\u5FD7\u7EA7\u522B\u8FDB\u884C\u8FC7\u6EE4\uFF0C\u6BD4\u5982\u4E0B\u9762\u7684\u914D\u7F6E\u5C06\u8FC7\u6EE4\u6389\u6240\u6709\u975EERROR\u7EA7\u522B\u7684\u65E5\u5FD7\u3002\r\n<filter class="ch.qos.logback.classic.filter.LevelFilter">\r\n    <level>ERROR</level>\r\n    <onMatch>ACCEPT</onMatch>\r\n    <onMismatch>DENY</onMismatch>\r\n</filter>\n'})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:'-- appender: \u7528\u6765\u63A7\u5236\u65E5\u5FD7\u7684\u8F93\u51FA\u5F62\u5F0F\uFF0C\u4E3B\u8981\u6709\u4E09\u79CD\r\n1\u3001ConsoleAppender\uFF1A\u63A7\u5236\u65E5\u5FD7\u8F93\u51FA\u5230\u63A7\u5236\u53F0\u7684\u5F62\u5F0F\uFF0C\u6BD4\u5982\u5728console-appender.xml\u4E2D\u5B9A\u4E49\u7684\u9ED8\u8BA4\u63A7\u5236\u53F0\u8F93\u51FA\u3002\r\n<appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">\r\n	<encoder>\r\n		<pattern>${CONSOLE_LOG_PATTERN}</pattern>\r\n	</encoder>\r\n</appender>\r\n2\u3001RollingFileAppender\uFF1A\u63A7\u5236\u65E5\u5FD7\u8F93\u51FA\u5230\u6587\u4EF6\u7684\u5F62\u5F0F\uFF0C\u53EF\u4EE5\u63A7\u5236\u65E5\u5FD7\u6587\u4EF6\u751F\u6210\u7B56\u7565\uFF0C\u6BD4\u5982\u6587\u4EF6\u540D\u79F0\u683C\u5F0F\u3001\u8D85\u8FC7\u591A\u5927\u91CD\u65B0\u751F\u6210\u6587\u4EF6\u4EE5\u53CA\u5220\u9664\u8D85\u8FC7\u591A\u5C11\u5929\u7684\u6587\u4EF6\u3002\r\n<!--ERROR\u65E5\u5FD7\u8F93\u51FA\u5230\u6587\u4EF6-->\r\n<appender name="FILE_ERROR"\r\n          class="ch.qos.logback.core.rolling.RollingFileAppender">\r\n    <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">\r\n        <!--\u8BBE\u7F6E\u6587\u4EF6\u547D\u540D\u683C\u5F0F-->\r\n        <fileNamePattern>${LOG_FILE_PATH}/error/${APP_NAME}-%d{yyyy-MM-dd}-%i.log</fileNamePattern>\r\n        <!--\u8BBE\u7F6E\u65E5\u5FD7\u6587\u4EF6\u5927\u5C0F\uFF0C\u8D85\u8FC7\u5C31\u91CD\u65B0\u751F\u6210\u6587\u4EF6\uFF0C\u9ED8\u8BA410M-->\r\n        <maxFileSize>${LOG_FILE_MAX_SIZE:-10MB}</maxFileSize>\r\n        <!--\u65E5\u5FD7\u6587\u4EF6\u4FDD\u7559\u5929\u6570\uFF0C\u9ED8\u8BA430\u5929-->\r\n        <maxHistory>${LOG_FILE_MAX_HISTORY:-30}</maxHistory>\r\n    </rollingPolicy>\r\n</appender>\r\n3\u3001LogstashTcpSocketAppender\uFF1A\u63A7\u5236\u65E5\u5FD7\u8F93\u51FA\u5230Logstash\u7684\u5F62\u5F0F\uFF0C\u53EF\u4EE5\u7528\u6765\u914D\u7F6ELogstash\u7684\u5730\u5740\u3001\u8BBF\u95EE\u7B56\u7565\u4EE5\u53CA\u65E5\u5FD7\u7684\u683C\u5F0F\u3002\r\n<!--ERROR\u65E5\u5FD7\u8F93\u51FA\u5230LogStash-->\r\n<appender name="LOG_STASH_ERROR" class="net.logstash.logback.appender.LogstashTcpSocketAppender">\r\n    <destination>${LOG_STASH_HOST}:4561</destination>\r\n    <encoder charset="UTF-8" class="net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder">\r\n        <providers>\r\n            <timestamp>\r\n                <timeZone>Asia/Shanghai</timeZone>\r\n            </timestamp>\r\n            <!--\u81EA\u5B9A\u4E49\u65E5\u5FD7\u8F93\u51FA\u683C\u5F0F-->\r\n            <pattern>\r\n                <pattern>\r\n                    {\r\n                    "project": "mall-tiny",\r\n                    "level": "%level",\r\n                    "service": "${APP_NAME:-}",\r\n                    "pid": "${PID:-}",\r\n                    "thread": "%thread",\r\n                    "class": "%logger",\r\n                    "message": "%message",\r\n                    "stack_trace": "%exception{20}"\r\n                    }\r\n                </pattern>\r\n            </pattern>\r\n        </providers>\r\n    </encoder>\r\n    <!--\u5F53\u6709\u591A\u4E2ALogStash\u670D\u52A1\u65F6\uFF0C\u8BBE\u7F6E\u8BBF\u95EE\u7B56\u7565\u4E3A\u8F6E\u8BE2-->\r\n    <connectionStrategy>\r\n        <roundRobin>\r\n            <connectionTTL>5 minutes</connectionTTL>\r\n        </roundRobin>\r\n    </connectionStrategy>\r\n</appender>\n'})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"-- logger: \u53EA\u6709\u914D\u7F6E\u5230logger\u8282\u70B9\u4E0A\u7684appender\u624D\u4F1A\u88AB\u4F7F\u7528\uFF0Clogger\u7528\u4E8E\u914D\u7F6E\u54EA\u79CD\u6761\u4EF6\u4E0B\u7684\u65E5\u5FD7\u88AB\u6253\u5370\uFF0Croot\u662F\u4E00\u79CD\u7279\u6B8A\u7684appender\uFF0C\u4E0B\u9762\u4ECB\u7ECD\u4E0B\u65E5\u5FD7\u5212\u5206\u7684\u6761\u4EF6\u3002\r\n\u8C03\u8BD5\u65E5\u5FD7\uFF1A\u6240\u6709\u7684DEBUG\u7EA7\u522B\u4EE5\u4E0A\u65E5\u5FD7\uFF1B\r\n\u9519\u8BEF\u65E5\u5FD7\uFF1A\u6240\u6709\u7684ERROR\u7EA7\u522B\u65E5\u5FD7\uFF1B\r\n\u4E1A\u52A1\u65E5\u5FD7\uFF1Acom.macro.mall\u5305\u4E0B\u7684\u6240\u6709DEBUG\u7EA7\u522B\u4EE5\u4E0A\u65E5\u5FD7\uFF1B\r\n\u8BB0\u5F55\u65E5\u5FD7\uFF1Acom.macro.mall.tiny.component.WebLogAspect\u7C7B\u4E0B\u6240\u6709DEBUG\u7EA7\u522B\u4EE5\u4E0A\u65E5\u5FD7\uFF0C\u8BE5\u7C7B\u662F\u7EDF\u8BA1\u63A5\u53E3\u8BBF\u95EE\u4FE1\u606F\u7684AOP\u5207\u9762\u7C7B\u3002\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:'-- \u63A7\u5236\u6846\u67B6\u8F93\u51FA\u65E5\u5FD7: \u8FD8\u6709\u4E00\u4E9B\u4F7F\u7528\u6846\u67B6\u5185\u90E8\u7684\u65E5\u5FD7\uFF0CDEBUG\u7EA7\u522B\u7684\u65E5\u5FD7\u5BF9\u6211\u4EEC\u5E76\u6CA1\u6709\u5565\u7528\u5904\uFF0C\u90FD\u53EF\u4EE5\u8BBE\u7F6E\u4E3A\u4E86INFO\u4EE5\u4E0A\u7EA7\u522B\u3002\r\n<!--\u63A7\u5236\u6846\u67B6\u8F93\u51FA\u65E5\u5FD7-->\r\n<logger name="org.slf4j" level="INFO"/>\r\n<logger name="springfox" level="INFO"/>\r\n<logger name="io.swagger" level="INFO"/>\r\n<logger name="org.springframework" level="INFO"/>\r\n<logger name="org.hibernate.validator" level="INFO"/>\n'})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-json",children:'# logstash.conf\r\n# input\uFF1A\u4F7F\u7528\u4E0D\u540C\u7AEF\u53E3\u6536\u96C6\u4E0D\u540C\u7C7B\u578B\u7684\u65E5\u5FD7\uFF0C\u4ECE4560~4563\u5F00\u542F\u56DB\u4E2A\u7AEF\u53E3\uFF1B\r\n# filter\uFF1A\u5BF9\u4E8E\u8BB0\u5F55\u7C7B\u578B\u7684\u65E5\u5FD7\uFF0C\u76F4\u63A5\u5C06JSON\u683C\u5F0F\u7684message\u8F6C\u5316\u5230source\u4E2D\u53BB\uFF0C\u4FBF\u4E8E\u641C\u7D22\u67E5\u770B\uFF1B\r\n# output\uFF1A\u6309\u7C7B\u578B\u3001\u65F6\u95F4\u81EA\u5B9A\u4E49\u7D22\u5F15\u683C\u5F0F\u3002\r\ninput {\r\n  tcp {\r\n    mode => "server"\r\n    host => "0.0.0.0"\r\n    port => 4560\r\n    codec => json_lines\r\n    type => "debug"\r\n  }\r\n  tcp {\r\n    mode => "server"\r\n    host => "0.0.0.0"\r\n    port => 4561\r\n    codec => json_lines\r\n    type => "error"\r\n  }\r\n  tcp {\r\n    mode => "server"\r\n    host => "0.0.0.0"\r\n    port => 4562\r\n    codec => json_lines\r\n    type => "business"\r\n  }\r\n  tcp {\r\n    mode => "server"\r\n    host => "0.0.0.0"\r\n    port => 4563\r\n    codec => json_lines\r\n    type => "record"\r\n  }\r\n}\r\nfilter{\r\n  if [type] == "record" {\r\n    mutate {\r\n      remove_field => "port"\r\n      remove_field => "host"\r\n      remove_field => "@version"\r\n    }\r\n    json {\r\n      source => "message"\r\n      remove_field => ["message"]\r\n    }\r\n  }\r\n}\r\noutput {\r\n  elasticsearch {\r\n    hosts => "localhost:9200"\r\n    index => "mall-%{type}-%{+YYYY.MM.dd}"\r\n  }\r\n}\n'})}),"\n",(0,l.jsx)(r.h4,{id:"canal\u6570\u636E\u540C\u6B65",children:"canal\u6570\u636E\u540C\u6B65"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"-- canal\u4E3B\u8981\u7528\u9014\u662F\u5BF9MySQL\u6570\u636E\u5E93\u589E\u91CF\u65E5\u5FD7\u8FDB\u884C\u89E3\u6790\uFF0C\u63D0\u4F9B\u589E\u91CF\u6570\u636E\u7684\u8BA2\u9605\u548C\u6D88\u8D39\uFF0C\u7B80\u5355\u8BF4\u5C31\u662F\u53EF\u4EE5\u5BF9MySQL\u7684\u589E\u91CF\u6570\u636E\u8FDB\u884C\u5B9E\u65F6\u540C\u6B65\uFF0C\u652F\u6301\u540C\u6B65\u5230MySQL\u3001Elasticsearch\u3001HBase\u7B49\u6570\u636E\u5B58\u50A8\u4E2D\u53BB\u3002\r\n\r\n-- canal\u4F1A\u6A21\u62DFMySQL\u4E3B\u5E93\u548C\u4ECE\u5E93\u7684\u4EA4\u4E92\u534F\u8BAE\uFF0C\u4ECE\u800C\u4F2A\u88C5\u6210MySQL\u7684\u4ECE\u5E93\uFF0C\u7136\u540E\u5411MySQL\u4E3B\u5E93\u53D1\u9001dump\u534F\u8BAE\uFF0CMySQL\u4E3B\u5E93\u6536\u5230dump\u8BF7\u6C42\u4F1A\u5411canal\u63A8\u9001binlog\uFF0Ccanal\u901A\u8FC7\u89E3\u6790binlog\u5C06\u6570\u636E\u540C\u6B65\u5230\u5176\u4ED6\u5B58\u50A8\u4E2D\u53BB\u3002\n"})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"https://github.com/alibaba/canal/releases\r\n-- \u4E09\u4E2A\u7EC4\u4EF6\r\ncanal-server\uFF08canal-deploy\uFF09\uFF1A\u53EF\u4EE5\u76F4\u63A5\u76D1\u542CMySQL\u7684binlog\uFF0C\u628A\u81EA\u5DF1\u4F2A\u88C5\u6210MySQL\u7684\u4ECE\u5E93\uFF0C\u53EA\u8D1F\u8D23\u63A5\u6536\u6570\u636E\uFF0C\u5E76\u4E0D\u505A\u5904\u7406\u3002\r\ncanal-adapter\uFF1A\u76F8\u5F53\u4E8Ecanal\u7684\u5BA2\u6237\u7AEF\uFF0C\u4F1A\u4ECEcanal-server\u4E2D\u83B7\u53D6\u6570\u636E\uFF0C\u7136\u540E\u5BF9\u6570\u636E\u8FDB\u884C\u540C\u6B65\uFF0C\u53EF\u4EE5\u540C\u6B65\u5230MySQL\u3001Elasticsearch\u548CHBase\u7B49\u5B58\u50A8\u4E2D\u53BB\u3002\r\ncanal-admin\uFF1A\u4E3Acanal\u63D0\u4F9B\u6574\u4F53\u914D\u7F6E\u7BA1\u7406\u3001\u8282\u70B9\u8FD0\u7EF4\u7B49\u9762\u5411\u8FD0\u7EF4\u7684\u529F\u80FD\uFF0C\u63D0\u4F9B\u76F8\u5BF9\u53CB\u597D\u7684WebUI\u64CD\u4F5C\u754C\u9762\uFF0C\u65B9\u4FBF\u66F4\u591A\u7528\u6237\u5FEB\u901F\u548C\u5B89\u5168\u7684\u64CD\u4F5C\u3002\n"})}),"\n",(0,l.jsx)(r.h3,{id:"\u914D\u7F6Emysql",children:"\u914D\u7F6Emysql"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"-- \u7531\u4E8Ecanal\u662F\u901A\u8FC7\u8BA2\u9605MySQL\u7684binlog\u6765\u5B9E\u73B0\u6570\u636E\u540C\u6B65\u7684\uFF0C\u6240\u4EE5\u6211\u4EEC\u9700\u8981\u5F00\u542FMySQL\u7684binlog\u5199\u5165\u529F\u80FD\uFF0C\u5E76\u8BBE\u7F6Ebinlog-format\u4E3AROW\u6A21\u5F0F\uFF0C\u914D\u7F6E\u6587\u4EF6\u4E3A/mydata/mysql/conf/my.cnf\n"})}),"\n",(0,l.jsx)(r.h3,{id:"lucene",children:"Lucene"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:"-- Lucene\u662F\u4E00\u5957\u7528\u4E8E\u5168\u6587\u68C0\u7D22\u548C\u641C\u7D22\u7684\u5F00\u653E\u539F\u59CB\u7801\u7A0B\u5E8F\u5E93\uFF0C\u7531Apache\u8F6F\u4EF6\u57FA\u91D1\u4F1A\u652F\u6301\u548C\u63D0\u4F9B\u3002Lucene\u63D0\u4F9B\u4E86\u4E00\u4E2A\u7B80\u5355\u5374\u5F3A\u5927\u7684\u5E94\u7528\u7A0B\u5E8F\u63A5\u53E3\uFF0C\u80FD\u591F\u505A\u5168\u6587\u7D22\u5F15\u548C\u641C\u7D22\u3002Lucene\u88AB\u5E7F\u6CDB\u5E94\u7528\u4F5C\u641C\u7D22\u5E94\u7528\u7684\u6807\u51C6\u57FA\u7840\u5E93\n"})}),"\n",(0,l.jsx)(r.h3,{id:"\u5E38\u7528\u6CE8\u89E3",children:"\u5E38\u7528\u6CE8\u89E3"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-java",children:'//\u6807\u793A\u6620\u5C04\u5230Elasticsearch\u6587\u6863\u4E0A\u7684\u9886\u57DF\u5BF9\u8C61\r\npublic @interface Document {\r\n  //\u7D22\u5F15\u5E93\u540D\u6B21\uFF0Cmysql\u4E2D\u6570\u636E\u5E93\u7684\u6982\u5FF5\r\n	String indexName();\r\n  //\u6587\u6863\u7C7B\u578B\uFF0Cmysql\u4E2D\u8868\u7684\u6982\u5FF5\r\n	String type() default "";\r\n  //\u9ED8\u8BA4\u5206\u7247\u6570\r\n	short shards() default 5;\r\n  //\u9ED8\u8BA4\u526F\u672C\u6570\u91CF\r\n	short replicas() default 1;\r\n}\r\n\r\n//\u8868\u793A\u662F\u6587\u6863\u7684id\uFF0C\u6587\u6863\u53EF\u4EE5\u8BA4\u4E3A\u662Fmysql\u4E2D\u8868\u884C\u7684\u6982\u5FF5\r\npublic @interface Id {\r\n}\r\n\r\npublic @interface Field {\r\n  //\u6587\u6863\u4E2D\u5B57\u6BB5\u7684\u7C7B\u578B\r\n	FieldType type() default FieldType.Auto;\r\n  //\u662F\u5426\u5EFA\u7ACB\u5012\u6392\u7D22\u5F15\r\n	boolean index() default true;\r\n  //\u662F\u5426\u8FDB\u884C\u5B58\u50A8\r\n	boolean store() default false;\r\n  //\u5206\u8BCD\u5668\u540D\u6B21\r\n	String analyzer() default "";\r\n}\r\n\r\n//\u4E3A\u6587\u6863\u81EA\u52A8\u6307\u5B9A\u5143\u6570\u636E\u7C7B\u578B\r\npublic enum FieldType {\r\n	Text,//\u4F1A\u8FDB\u884C\u5206\u8BCD\u5E76\u5EFA\u4E86\u7D22\u5F15\u7684\u5B57\u7B26\u7C7B\u578B\r\n	Integer,\r\n	Long,\r\n	Date,\r\n	Float,\r\n	Double,\r\n	Boolean,\r\n	Object,\r\n	Auto,//\u81EA\u52A8\u5224\u65AD\u5B57\u6BB5\u7C7B\u578B\r\n	Nested,//\u5D4C\u5957\u5BF9\u8C61\u7C7B\u578B\r\n	Ip,\r\n	Attachment,\r\n	Keyword//\u4E0D\u4F1A\u8FDB\u884C\u5206\u8BCD\u5EFA\u7ACB\u7D22\u5F15\u7684\u7C7B\u578B\r\n}\n'})}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-sql",children:'-- \u7EE7\u627FElasticsearchRepository\u63A5\u53E3\u53EF\u4EE5\u83B7\u5F97\u5E38\u7528\u7684\u6570\u636E\u64CD\u4F5C\u65B9\u6CD5\r\n\r\n-- \u884D\u751F\u67E5\u8BE2\r\n\u5728\u63A5\u53E3\u4E2D\u76F4\u63A5\u6307\u5B9A\u67E5\u8BE2\u65B9\u6CD5\u540D\u79F0\u4FBF\u53EF\u67E5\u8BE2\uFF0C\u65E0\u9700\u8FDB\u884C\u5B9E\u73B0\uFF0C\u5982\u5546\u54C1\u8868\u4E2D\u6709\u5546\u54C1\u540D\u79F0\u3001\u6807\u9898\u548C\u5173\u952E\u5B57\uFF0C\u76F4\u63A5\u5B9A\u4E49\u4EE5\u4E0B\u67E5\u8BE2\uFF0C\u5C31\u53EF\u4EE5\u5BF9\u8FD9\u4E09\u4E2A\u5B57\u6BB5\u8FDB\u884C\u5168\u6587\u641C\u7D22\u3002\r\nPage<EsProduct> findByNameOrSubTitleOrKeywords(String name, String subTitle, String keywords, Pageable page);\r\n\r\n-- \u4F7F\u7528@Query\u6CE8\u89E3\u53EF\u4EE5\u7528Elasticsearch\u7684DSL\u8BED\u53E5\u8FDB\u884C\u67E5\u8BE2\r\n@Query("{"bool" : {"must" : {"field" : {"name" : "?0"}}}}")\r\nPage<EsProduct> findByName(String name,Pageable pageable);\r\n\r\n-- @Field\r\n\u4E0D\u9700\u8981\u4E2D\u6587\u5206\u8BCD\u7684\u5B57\u6BB5\u8BBE\u7F6E\u6210@Field(type = FieldType.Keyword)\u7C7B\u578B\r\n\u9700\u8981\u4E2D\u6587\u5206\u8BCD\u7684\u8BBE\u7F6E\u6210@Field(analyzer = "ik_max_word",type = FieldType.Text)\u7C7B\u578B\u3002\n'})}),"\n",(0,l.jsx)(r.h3,{id:"\u7248\u672C\u517C\u5BB9",children:"\u7248\u672C\u517C\u5BB9"}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.a,{href:"https://www.elastic.co/cn/support/matrix?spm=a2c4g.11186623.0.0.312237875y8kxE#matrix_compatibility",children:"https://www.elastic.co/cn/support/matrix?spm=a2c4g.11186623.0.0.312237875y8kxE#matrix_compatibility"})})]})}function h(n={}){let{wrapper:r}={...(0,s.R)(),...n.components};return r?(0,l.jsx)(r,{...n,children:(0,l.jsx)(d,{...n})}):d(n)}},8453:(n,r,e)=>{e.d(r,{R:()=>t,x:()=>c});var a=e(6540);let l={},s=a.createContext(l);function t(n){let r=a.useContext(s);return a.useMemo(function(){return"function"==typeof n?n(r):{...r,...n}},[r,n])}function c(n){let r;return r=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:t(n.components),a.createElement(s.Provider,{value:r},n.children)}}}]);